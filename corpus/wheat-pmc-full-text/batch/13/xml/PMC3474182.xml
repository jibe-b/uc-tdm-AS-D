<?xml version="1.0"?>
<article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article" xml:lang="en">
  <?DTDIdentifier.IdentifierValue article.dtd?>
  <?DTDIdentifier.IdentifierType system?>
  <?SourceDTD.DTDName article.dtd?>
  <?SourceDTD.Version 1.0?>
  <?ConverterInfo.XSLTName bmc2nlmx2.xsl?>
  <?ConverterInfo.Version 2?>
  <front>
    <journal-meta>
      <journal-id journal-id-type="nlm-ta">BMC Genet</journal-id>
      <journal-id journal-id-type="iso-abbrev">BMC Genet</journal-id>
      <journal-title-group>
        <journal-title>BMC Genetics</journal-title>
      </journal-title-group>
      <issn pub-type="epub">1471-2156</issn>
      <publisher>
        <publisher-name>BioMed Central</publisher-name>
      </publisher>
    </journal-meta>
    <article-meta>
      <article-id pub-id-type="pmcid">3474182</article-id>
      <article-id pub-id-type="publisher-id">1471-2156-12-87</article-id>
      <article-id pub-id-type="pmid">21981731</article-id>
      <article-id pub-id-type="doi">10.1186/1471-2156-12-87</article-id>
      <article-categories>
        <subj-group subj-group-type="heading">
          <subject>Methodology Article</subject>
        </subj-group>
      </article-categories>
      <title-group>
        <article-title>Predicting complex quantitative traits with Bayesian neural networks: a case study with Jersey cows and wheat</article-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="author" id="A1">
          <name>
            <surname>Gianola</surname>
            <given-names>Daniel</given-names>
          </name>
          <xref ref-type="aff" rid="I1">1</xref>
          <xref ref-type="aff" rid="I2">2</xref>
          <xref ref-type="aff" rid="I3">3</xref>
          <email>gianola@ansci.wisc.edu</email>
        </contrib>
        <contrib contrib-type="author" corresp="yes" id="A2">
          <name>
            <surname>Okut</surname>
            <given-names>Hayrettin</given-names>
          </name>
          <xref ref-type="aff" rid="I1">1</xref>
          <xref ref-type="aff" rid="I4">4</xref>
          <email>okut@wisc.edu</email>
        </contrib>
        <contrib contrib-type="author" id="A3">
          <name>
            <surname>Weigel</surname>
            <given-names>Kent A</given-names>
          </name>
          <xref ref-type="aff" rid="I2">2</xref>
          <email>kweigel@facstaff.wisc.edu</email>
        </contrib>
        <contrib contrib-type="author" id="A4">
          <name>
            <surname>Rosa</surname>
            <given-names>Guilherme JM</given-names>
          </name>
          <xref ref-type="aff" rid="I1">1</xref>
          <xref ref-type="aff" rid="I3">3</xref>
          <email>grosa@wisc.edu</email>
        </contrib>
      </contrib-group>
      <aff id="I1"><label>1</label>Dept. of Animal Sciences, University of Wisconsin, Madison, 53706, USA</aff>
      <aff id="I2"><label>2</label>Dept. of Dairy Science, University of Wisconsin, Madison, 53706, USA</aff>
      <aff id="I3"><label>3</label>Dept. of Biostatistics and Medical Informatics, University of Wisconsin, Madison, 53706, USA</aff>
      <aff id="I4"><label>4</label>Dept. of Animal Sciences, Biometry and Genetics Branch, University of Yuzuncu Yil, Van, 65080, Turkey</aff>
      <pub-date pub-type="collection">
        <year>2011</year>
      </pub-date>
      <pub-date pub-type="epub">
        <day>7</day>
        <month>10</month>
        <year>2011</year>
      </pub-date>
      <volume>12</volume>
      <fpage>87</fpage>
      <lpage>87</lpage>
      <history>
        <date date-type="received">
          <day>22</day>
          <month>7</month>
          <year>2011</year>
        </date>
        <date date-type="accepted">
          <day>7</day>
          <month>10</month>
          <year>2011</year>
        </date>
      </history>
      <permissions>
        <copyright-statement>Copyright &#xA9;2011 Gianola et al; licensee BioMed Central Ltd.</copyright-statement>
        <copyright-year>2011</copyright-year>
        <copyright-holder>Gianola et al; licensee BioMed Central Ltd.</copyright-holder>
        <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0">
          <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0">http://creativecommons.org/licenses/by/2.0</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
        </license>
      </permissions>
      <self-uri xlink:href="http://www.biomedcentral.com/1471-2156/12/87"/>
      <abstract>
        <sec>
          <title>Background</title>
          <p>In the study of associations between genomic data and complex phenotypes there may be relationships that are not amenable to parametric statistical modeling. Such associations have been investigated mainly using single-marker and Bayesian linear regression models that differ in their distributions, but that assume additive inheritance while ignoring interactions and non-linearity. When interactions have been included in the model, their effects have entered linearly. There is a growing interest in non-parametric methods for predicting quantitative traits based on reproducing kernel Hilbert spaces regressions on markers and radial basis functions. Artificial neural networks (ANN) provide an alternative, because these act as universal approximators of complex functions and can capture non-linear relationships between predictors and responses, with the interplay among variables learned adaptively. ANNs are interesting candidates for analysis of traits affected by cryptic forms of gene action.</p>
        </sec>
        <sec>
          <title>Results</title>
          <p>We investigated various Bayesian ANN architectures using for predicting phenotypes in two data sets consisting of milk production in Jersey cows and yield of inbred lines of wheat. For the Jerseys, predictor variables were derived from pedigree and molecular marker (35,798 single nucleotide polymorphisms, SNPS) information on 297 individually cows. The wheat data represented 599 lines, each genotyped with 1,279 markers. The ability of predicting fat, milk and protein yield was low when using pedigrees, but it was better when SNPs were employed, irrespective of the ANN trained. Predictive ability was even better in wheat because the trait was a mean, as opposed to an individual phenotype in cows. Non-linear neural networks outperformed a linear model in predictive ability in both data sets, but more clearly in wheat.</p>
        </sec>
        <sec>
          <title>Conclusion</title>
          <p>Results suggest that neural networks may be useful for predicting complex traits using high-dimensional genomic information, a situation where the number of unknowns exceeds sample size. ANNs can capture nonlinearities, adaptively. This may be useful when prediction of phenotypes is crucial.</p>
        </sec>
      </abstract>
    </article-meta>
  </front>
  <body>
    <sec>
      <title>Background</title>
      <p>Challenges in the study of associations between genomic variables (e.g., molecular markers) and complex phenotypes include the possible existence of cryptic relationships that may not be amenable to parametric statistical modeling, as well as the high dimensionality of the data, illustrated by the growing number of single nucleotide polymorphisms, now close to 10 million in humans <ext-link ext-link-type="uri" xlink:href="http://www.genome.gov/11511175">http://www.genome.gov/11511175</ext-link>. These associations have been investigated primarily using na&#xEF;ve single-marker regressions and, more recently, with Bayesian linear regression models of various types [<xref ref-type="bibr" rid="B1">1</xref>-<xref ref-type="bibr" rid="B3">3</xref>] but that assume additive inheritance almost invariably, while typically ignoring interactions and non-linearity. Taking into account these phenomena may enhance the ability of predicting outcomes, and this is relevant in genome-assisted management of livestock and plants and in individualized medicine.</p>
      <p>There has been a growing interest in the use of non-parametric methods for prediction of quantitative traits based on reproducing kernel Hilbert spaces regressions on markers [<xref ref-type="bibr" rid="B2">2</xref>,<xref ref-type="bibr" rid="B4">4</xref>-<xref ref-type="bibr" rid="B7">7</xref>] and radial basis functions models [<xref ref-type="bibr" rid="B8">8</xref>] or related approaches [<xref ref-type="bibr" rid="B9">9</xref>]. Artificial neural networks (ANN) provide an interesting alternative because these learning machines can act as universal approximators of complex functions [<xref ref-type="bibr" rid="B10">10</xref>,<xref ref-type="bibr" rid="B11">11</xref>]. ANNs can capture non-linear relationships between predictors and responses and learn about functional forms in an adaptive manner, because a series of transformations called activation functions are driven by parameters. ANNs can be viewed as a computer based system composed of many processing elements (neurons) operating in parallel [<xref ref-type="bibr" rid="B12">12</xref>], and also as a schematic of Kolmogorov's theorem for representation of multivariate functions [<xref ref-type="bibr" rid="B13">13</xref>]. An ANN is determined by the network structure, represented by the number of layers and of neurons, by the strength of the connections (akin to non-parametric regression coefficients) between inputs, neurons and outputs, and by the type of processing performed at each neuron, represented by a linear or non-linear transformation: the activation function. Neural networks have the potential of accommodating complex relationships between input and response variables, as well as of difficult to model interactions among inputs. For these reasons, ANNs are interesting candidates for the analysis of complex traits affected by cryptic forms of gene X gene interaction, and many algorithms for training (fitting) such networks are now available [<xref ref-type="bibr" rid="B14">14</xref>].</p>
      <p>In this study we investigated the performance of several ANN architectures using Bayesian regularization (a method for coping with the "small <italic>n</italic>, large <italic>p</italic>" problem that arises in statistical models including a massive number of explanatory variables) when predicting milk production traits in a sample of Jersey cows or mean grain yield in hundreds of inbred wheat lines. The architectures considered differed in terms of number of neurons and activation functions used, and the input (predictor) variables were derived from pedigree and molecular marker information on the corresponding samples. The paper begins with a brief account of Bayesian regularized neural networks, of their connection with linear random regression models often used in quantitative genetics, and of how Bayesian regularization is made. Subsequently, it is shown how a neural network treatment of genomic data can enhance predictive ability over and above that using pedigree information (in Jerseys) or linear Bayesian regression on markers (in both cows and wheat), which is representative of a standard approach in quantitative genomics.</p>
    </sec>
    <sec sec-type="methods">
      <title>Methods</title>
      <p>For clarity of presentation the methodology is presented first, as the main objective of the paper was to cast neural networks in a quantitative genetics predictive context. Subsequently, a description of the two sets of data used to illustrate how the Bayesian neural networks were run is provided. As stated, the first data set consisted of milk, protein and fat yield in dairy cows. The second set represented 599 lines of wheat, with mean grain yield as target trait.</p>
      <sec>
        <title>Excursus: Feed-Forward Neural Networks</title>
        <p>To illustrate, consider a network with three layers, as shown in Figure <xref ref-type="fig" rid="F1">1</xref> for the Jersey cow data. In the left-most layer, there are input variables, 297 in Figure <xref ref-type="fig" rid="F1">1</xref>, or transformations thereof (called features) that enter into the network as predictors. In the middle ("hidden") layer there is a varying number of neurons; 5 are shown in Figure <xref ref-type="fig" rid="F1">1</xref>, but the number used is a model selection issue, with this addressed via an evaluation of predictive performance. In the right-most layer, there is a single ("output") node, at least for quantitative response variables. Each input (or feature) connects to each neuron with a strength represented by an unknown coefficient <italic>w</italic>. The collected input into a given neuron can be transformed (or not, in which case one speaks of an identity or linear activation function), and this activated net input is emitted to the output layer with a strength represented by another unknown coefficient. A similar process takes place for every neuron.</p>
        <fig id="F1" position="float">
          <label>Figure 1</label>
          <caption>
            <p><bold>Illustration of the neural networks used</bold>. In the Jersey data there were 297 elements of pedigree or genomic relationship matrices used as inputs (the <italic>p's</italic>) for each target trait. In the Figure, each <italic>p<sub>k </sub></italic><italic>(k = 1,2,...,297) </italic>is connected to 5 hidden neurons via coefficients <italic>w<sub>j,k </sub></italic>(<italic>j </italic>denotes neuron, <italic>k </italic>denotes input). Each hidden and output neuron has a bias parameter <inline-formula><mml:math id="M1" name="1471-2156-12-87-i53" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo class="MathClass-open">(</mml:mo><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mo class="MathClass-close">)</mml:mo></mml:mrow></mml:mrow></mml:msubsup></mml:math></inline-formula>, <italic>j </italic>denotes neuron, <italic>l </italic>denotes layer). The variable <inline-formula><mml:math id="M2" name="1471-2156-12-87-i54" overflow="scroll"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo class="MathClass-op">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> represents the trait predicted value for datum <italic>i</italic>.</p>
          </caption>
          <graphic xlink:href="1471-2156-12-87-1"/>
        </fig>
        <p>Algebraically, the process can be represented as follows. Let <italic>t<sub>i </sub></italic>(the target phenotype) be a quantitative trait measured in individual <italic>i </italic>(<italic>i = </italic>1,2,...,n) and let <italic>p<sub>i </sub></italic>= {<italic>p<sub>ij</sub></italic>} be a vector of inputs or explanatory variables, e.g., marker genotypes or any other covariate measured in each of such individuals, with allowance made for inclusion of a 1, corresponding to the indicator variable for an intercept in a regression model. Suppose there are <italic>S </italic>neurons in the hidden layer of the architecture. The input into neuron <italic>k </italic>(<italic>k </italic>= 1,2,...,<italic>S</italic>) prior to activation, as described subsequently, is the linear function <italic>w'<sub>k </sub>p<sub>i</sub></italic>, where <italic>w'<sub>k </sub></italic>={<italic>w<sub>kj </sub></italic>} is a vector of unknown connection strengths ("regressions") peculiar to neuron <italic>k</italic>, including an intercept (called "bias" in the machine learning literature) in <italic>w'<sub>k</sub></italic>. This input is transformed ("activated") using some linear or non-linear function <italic>f(.)</italic>, which can be neuron-specific or common to all neurons; this yields <italic>f<sub>k</sub></italic>(<italic>w'<sub>k </sub>p<sub>i</sub></italic>) (<italic>k </italic>= 1,2,...,S). Subsequently, the so activated emission from neuron <italic>k </italic>is sent to the output layer, with the collection of emissions over all neurons being <inline-formula><mml:math id="M3" name="1471-2156-12-87-i1" overflow="scroll"><mml:mi>b</mml:mi><mml:mo class="MathClass-bin">+</mml:mo><mml:mi>c</mml:mi><mml:mi>g</mml:mi><mml:mfenced open="[" close="]"><mml:mrow><mml:munderover accentunder="false" accent="false"><mml:mrow><mml:mo class="MathClass-op">&#x2211;</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo class="MathClass-rel">=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo class="MathClass-open">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:msup><mml:mrow><mml:mstyle class="text"><mml:mtext class="textsf" mathvariant="sans-serif">w</mml:mtext></mml:mstyle></mml:mrow><mml:mrow><mml:mi>&#x2032;</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mstyle class="text"><mml:mtext class="textsf" mathvariant="sans-serif">p</mml:mtext></mml:mstyle></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo class="MathClass-close">)</mml:mo></mml:mrow></mml:mrow></mml:mfenced></mml:math></inline-formula>, where <italic>b </italic>is an overall bias parameter, <italic>c </italic>is a regression on an activated emission, <italic>g(.) </italic>is another activation function, possibly non-linear, and <italic>w<sub>1</sub>,w<sub>2</sub>,...,w<sub>S </sub></italic>are regressions on each of the activated emissions <italic>f<sub>k</sub></italic>(w'<sub>k </sub>p<sub>i</sub>). The link between the response variable (phenotype) and the inputs is provided by the model</p>
        <p>
          <disp-formula id="bmcM1">
            <label>(1)</label>
            <mml:math id="M4" name="1471-2156-12-87-i2" overflow="scroll">
              <mml:mrow>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>t</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mstyle class="text">
                      <mml:mtext class="textsf" mathvariant="sans-serif">i</mml:mtext>
                    </mml:mstyle>
                  </mml:mrow>
                </mml:msub>
                <mml:mo class="MathClass-rel">=</mml:mo>
                <mml:mi>b</mml:mi>
                <mml:mo class="MathClass-bin">+</mml:mo>
                <mml:mi>c</mml:mi>
                <mml:mi>g</mml:mi>
                <mml:mfenced open="[" close="]">
                  <mml:mrow>
                    <mml:munderover accentunder="false" accent="false">
                      <mml:mrow>
                        <mml:mo mathsize="big">&#x2211;</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>k</mml:mi>
                        <mml:mo class="MathClass-rel">=</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>s</mml:mi>
                      </mml:mrow>
                    </mml:munderover>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>w</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mstyle class="text">
                          <mml:mtext class="textsf" mathvariant="sans-serif">k</mml:mtext>
                        </mml:mstyle>
                      </mml:mrow>
                    </mml:msub>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>f</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>k</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mrow>
                      <mml:mo class="MathClass-open">(</mml:mo>
                      <mml:mrow>
                        <mml:msubsup>
                          <mml:mrow>
                            <mml:mstyle class="text">
                              <mml:mtext class="textsf" mathvariant="sans-serif">w</mml:mtext>
                            </mml:mstyle>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mstyle class="text">
                              <mml:mtext class="textsf" mathvariant="sans-serif">k</mml:mtext>
                            </mml:mstyle>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>&#x2032;</mml:mi>
                          </mml:mrow>
                        </mml:msubsup>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mstyle class="text">
                              <mml:mtext class="textsf" mathvariant="sans-serif">p</mml:mtext>
                            </mml:mstyle>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mstyle class="text">
                              <mml:mtext class="textsf" mathvariant="sans-serif">i</mml:mtext>
                            </mml:mstyle>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mrow>
                      <mml:mo class="MathClass-close">)</mml:mo>
                    </mml:mrow>
                  </mml:mrow>
                </mml:mfenced>
                <mml:mo class="MathClass-bin">+</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>e</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo class="MathClass-punc">;</mml:mo>
                <mml:mspace width="1em" class="quad"/>
                <mml:mi>i</mml:mi>
                <mml:mo class="MathClass-rel">=</mml:mo>
                <mml:mn>1</mml:mn>
                <mml:mo class="MathClass-punc">,</mml:mo>
                <mml:mn>2</mml:mn>
                <mml:mo class="MathClass-punc">,</mml:mo>
                <mml:mo class="MathClass-op">&#x2026;</mml:mo>
                <mml:mo class="MathClass-punc">,</mml:mo>
                <mml:mi>n</mml:mi>
              </mml:mrow>
            </mml:math>
          </disp-formula>
        </p>
        <p>where <italic>e<sub>i </sub></italic>~ (0, <italic>&#x3C3;</italic><sup>2</sup>) and <italic>&#x3C3;</italic><sup>2 </sup>is a variance parameter. If <italic>g</italic>(.) is a linear or identity activation function, the model is a linear regression on the adaptive covariates <italic>f<sub>k</sub></italic>(<italic>w'<sub>k </sub>p<sub>i</sub></italic>); if, further, <italic>f<sub>k</sub></italic>(.), is also linear, the regression model is entirely linear. The term "adaptive" means that the covariates are functions of unknown parameters, the {<italic>w<sub>kj</sub></italic>} connection strengths, so the networks can "learn" the relationship between explanatory variables and phenotypes, as opposed to posing it arbitrarily, as it is the case in standard regression models. In this manner, this type of neural network can also be viewed as a regression model, but with the extent of non-linearity dictated by the type of activation functions used. Since the number of parameters increases linearly with the number of neurons, and the number of predictors given by the length of <italic>p </italic>(e.g., the number of markers) can amply exceed sample size, it is necessary to treat the connection strengths as random effects in which case the Bayesian connection is immediate [<xref ref-type="bibr" rid="B15">15</xref>,<xref ref-type="bibr" rid="B16">16</xref>]. This approach is called "Bayesian regularization".</p>
      </sec>
      <sec>
        <title>Fisher's infinitesimal model viewed as a neural network</title>
        <p>Let <italic>t </italic>represent an <italic>n </italic>&#xD7; 1 vector of phenotypic values and <bold>u </bold>~ (<bold>0</bold>, <bold>A</bold><italic>&#x3C3;</italic><sup>2</sup><italic>u </italic>) be a vector of infinitesimal additive genetic effects, where <italic>&#x3C3;</italic><sup>2</sup><italic>u </italic>is the additive genetic variance, <bold><italic>A = CC' </italic></bold>= {<italic>a<sub>ij</sub></italic>} is the numerator relationship matrix and <bold><italic>C </italic></bold>is its lower triangular Cholesky factor decomposition. Fisher's linear model on additive genetic effects (ignoring an overall mean and nuisance fixed effects, for simplicity) admits at least three representations:</p>
        <p>I) <bold>t </bold>= <bold>u </bold>+ <bold>e </bold>= <bold>Cz</bold><italic>&#x3C3;<sub>u </sub></italic>+ <bold>e </bold>= <bold>Cu</bold>* + <bold>e</bold>,</p>
        <p>where <bold>z </bold>is a vector of independent standard normal deviates, <bold>u</bold>* = <bold>z</bold><italic>&#x3C3;<sub>u </sub></italic>~ (<bold>0</bold>, <bold>I</bold><italic>&#x3C3;</italic><sup>2</sup><italic><sub>u</sub></italic>) and <bold>e </bold>~ (<bold>0</bold>, <bold>I</bold><italic>&#x3C3;</italic><sup>2</sup>) is a residual vector with <italic>&#x3C3;</italic><sup>2 </sup>interpretable as environmental variance.</p>
        <p>II) <bold>t </bold>= <bold>AA</bold><sup>-<bold>1</bold></sup><bold>u </bold>+ <bold>e = Au</bold>** + <bold>e</bold>,</p>
        <p>where <bold>u</bold>** = <bold>A</bold><sup>-<bold>1</bold></sup><bold>u </bold>~ (<bold>0, A</bold><sup>-1 </sup><italic>&#x3C3;</italic><sup>2</sup><italic><sub>u</sub></italic>), and</p>
        <p>III) <bold>t </bold>= <bold>A</bold><sup>-<bold>1 </bold></sup><bold>Au + e = A</bold><sup>-<bold>1</bold></sup><bold>u</bold>*** + <bold>e</bold>,</p>
        <p>where <bold>u</bold>*** = <bold>Au ~ </bold>(<bold>0</bold>, <bold>A</bold><sup>3</sup><italic>&#x3C3;</italic><sup>2</sup><italic>u</italic>).</p>
        <p>In each of these formulations Fisher's model can be viewed as a neural network with a single neuron in the middle layer, where <italic>g(.) </italic>is an identity or linear activation function. The respective representations for the three models given above are</p>
        <p>
          <disp-formula>
            <mml:math id="M5" name="1471-2156-12-87-i3" overflow="scroll">
              <mml:mrow>
                <mml:mtable class="gathered">
                  <mml:mtr>
                    <mml:mtd>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>t</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo class="MathClass-rel">=</mml:mo>
                      <mml:mi>b</mml:mi>
                      <mml:mo class="MathClass-bin">+</mml:mo>
                      <mml:mi>g</mml:mi>
                      <mml:mrow>
                        <mml:mo class="MathClass-open">(</mml:mo>
                        <mml:mrow>
                          <mml:msubsup>
                            <mml:mrow>
                              <mml:mo mathsize="big">&#x2211;</mml:mo>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>j</mml:mi>
                              <mml:mo class="MathClass-rel">=</mml:mo>
                              <mml:mn>1</mml:mn>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>n</mml:mi>
                            </mml:mrow>
                          </mml:msubsup>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>c</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>i</mml:mi>
                              <mml:mi>j</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                          <mml:msubsup>
                            <mml:mrow>
                              <mml:mi>u</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>j</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mo class="MathClass-bin">*</mml:mo>
                            </mml:mrow>
                          </mml:msubsup>
                        </mml:mrow>
                        <mml:mo class="MathClass-close">)</mml:mo>
                      </mml:mrow>
                      <mml:mo class="MathClass-bin">+</mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>e</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo class="MathClass-punc">,</mml:mo>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr>
                    <mml:mtd>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>t</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo class="MathClass-rel">=</mml:mo>
                      <mml:mi>b</mml:mi>
                      <mml:mo class="MathClass-bin">+</mml:mo>
                      <mml:mi>g</mml:mi>
                      <mml:mrow>
                        <mml:mo class="MathClass-open">(</mml:mo>
                        <mml:mrow>
                          <mml:msubsup>
                            <mml:mrow>
                              <mml:mo mathsize="big">&#x2211;</mml:mo>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>j</mml:mi>
                              <mml:mo class="MathClass-rel">=</mml:mo>
                              <mml:mn>1</mml:mn>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>n</mml:mi>
                            </mml:mrow>
                          </mml:msubsup>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>a</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>i</mml:mi>
                              <mml:mi>j</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                          <mml:msubsup>
                            <mml:mrow>
                              <mml:mi>u</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>j</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mo class="MathClass-bin">*</mml:mo>
                              <mml:mo class="MathClass-bin">*</mml:mo>
                            </mml:mrow>
                          </mml:msubsup>
                        </mml:mrow>
                        <mml:mo class="MathClass-close">)</mml:mo>
                      </mml:mrow>
                      <mml:mo class="MathClass-bin">+</mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>e</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo class="MathClass-punc">,</mml:mo>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr>
                    <mml:mtd/>
                  </mml:mtr>
                </mml:mtable>
              </mml:mrow>
            </mml:math>
          </disp-formula>
        </p>
        <p>and</p>
        <p>
          <disp-formula>
            <mml:math id="M6" name="1471-2156-12-87-i4" overflow="scroll">
              <mml:mrow>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>t</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo class="MathClass-rel">=</mml:mo>
                <mml:mi>b</mml:mi>
                <mml:mo class="MathClass-bin">+</mml:mo>
                <mml:mi>g</mml:mi>
                <mml:mrow>
                  <mml:mo class="MathClass-open">(</mml:mo>
                  <mml:mrow>
                    <mml:msubsup>
                      <mml:mrow>
                        <mml:mo mathsize="big">&#x2211;</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>j</mml:mi>
                        <mml:mo class="MathClass-rel">=</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>n</mml:mi>
                      </mml:mrow>
                    </mml:msubsup>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mi>a</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                        <mml:mi>j</mml:mi>
                      </mml:mrow>
                    </mml:msup>
                    <mml:msubsup>
                      <mml:mrow>
                        <mml:mi>u</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>j</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mo class="MathClass-bin">*</mml:mo>
                        <mml:mo class="MathClass-bin">*</mml:mo>
                        <mml:mo class="MathClass-bin">*</mml:mo>
                      </mml:mrow>
                    </mml:msubsup>
                  </mml:mrow>
                  <mml:mo class="MathClass-close">)</mml:mo>
                </mml:mrow>
                <mml:mo class="MathClass-bin">+</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>e</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo class="MathClass-punc">.</mml:mo>
              </mml:mrow>
            </mml:math>
          </disp-formula>
        </p>
        <p>Here, a bias parameter <italic>b </italic>is included for the sake of generality. Hence, the additive model can be viewed as a single-neuron network regression on either elements of the Cholesky decomposition of the numerator relationship matrix, on the relationships themselves or on the elements of the inverse of <bold>A</bold>, with the strengths of the connections represented by the corresponding entries of <bold>u</bold>*, <bold>u</bold>** and <bold>u</bold>***, respectively.</p>
        <p>Is it possible to exploit knowledge of relationships in a fuller manner? Since a neural network is a universal approximator, the predictive performance of the classical infinitesimal linear model can be enhanced, at least potentially, by taking a model on, say, <italic>S </italic>neurons, while effecting non-linear transformations simultaneously. The rationale is that Fisher's model holds under some assumptions which may be violated, such as linkage equilibrium, e.g., entries of the numerator relationship matrix are expected values in the absence of selection and under linkage equilibrium. For instance, using the second representation above one could write</p>
        <p>
          <disp-formula id="bmcM2">
            <label>(2)</label>
            <mml:math id="M7" name="1471-2156-12-87-i5" overflow="scroll">
              <mml:mrow>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>t</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mstyle class="text">
                      <mml:mtext class="textsf" mathvariant="sans-serif">i</mml:mtext>
                    </mml:mstyle>
                  </mml:mrow>
                </mml:msub>
                <mml:mo class="MathClass-rel">=</mml:mo>
                <mml:mi>b</mml:mi>
                <mml:mo class="MathClass-bin">+</mml:mo>
                <mml:mi>c</mml:mi>
                <mml:mi>g</mml:mi>
                <mml:mfenced open="[" close="]">
                  <mml:mrow>
                    <mml:munderover accentunder="false" accent="false">
                      <mml:mrow>
                        <mml:mo mathsize="big">&#x2211;</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>k</mml:mi>
                        <mml:mo class="MathClass-rel">=</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>s</mml:mi>
                      </mml:mrow>
                    </mml:munderover>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>w</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>k</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>g</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>k</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mrow>
                      <mml:mo class="MathClass-open">(</mml:mo>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>b</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>k</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo class="MathClass-bin">+</mml:mo>
                        <mml:msubsup>
                          <mml:mrow>
                            <mml:mo mathsize="big"> &#x2211;</mml:mo>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>j</mml:mi>
                            <mml:mo class="MathClass-rel">=</mml:mo>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>n</mml:mi>
                          </mml:mrow>
                        </mml:msubsup>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>a</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>i</mml:mi>
                            <mml:mi>j</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                        <mml:msubsup>
                          <mml:mrow>
                            <mml:mi>u</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>j</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mo class="MathClass-bin">*</mml:mo>
                            <mml:mo class="MathClass-bin">*</mml:mo>
                            <mml:mrow>
                              <mml:mo class="MathClass-open">[</mml:mo>
                              <mml:mrow>
                                <mml:mi>k</mml:mi>
                              </mml:mrow>
                              <mml:mo class="MathClass-close">]</mml:mo>
                            </mml:mrow>
                          </mml:mrow>
                        </mml:msubsup>
                      </mml:mrow>
                      <mml:mo class="MathClass-close">)</mml:mo>
                    </mml:mrow>
                  </mml:mrow>
                </mml:mfenced>
                <mml:mo class="MathClass-bin">+</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>e</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo class="MathClass-punc">;</mml:mo>
                <mml:mspace width="1em" class="quad"/>
                <mml:mi>i</mml:mi>
                <mml:mo class="MathClass-rel">=</mml:mo>
                <mml:mn>1</mml:mn>
                <mml:mo class="MathClass-punc">,</mml:mo>
                <mml:mn>2</mml:mn>
                <mml:mo class="MathClass-punc">,</mml:mo>
                <mml:mo class="MathClass-op">&#x2026;</mml:mo>
                <mml:mo class="MathClass-punc">,</mml:mo>
                <mml:mi>n</mml:mi>
                <mml:mo class="MathClass-punc">.</mml:mo>
              </mml:mrow>
            </mml:math>
          </disp-formula>
        </p>
        <p>Here, the inputs are entries <italic>a<sub>ij </sub></italic>of the relationship matrix, connecting individual <italic>i </italic>to all other individuals in the genealogy; the <inline-formula><mml:math id="M8" name="1471-2156-12-87-i6" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo class="MathClass-bin">*</mml:mo><mml:mo class="MathClass-bin">*</mml:mo><mml:mrow><mml:mo class="MathClass-open">[</mml:mo><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mo class="MathClass-close">]</mml:mo></mml:mrow></mml:mrow></mml:msubsup></mml:math></inline-formula> coefficient is the connection strength for input <italic>j </italic>in neuron <italic>k; b<sub>k </sub></italic>is the bias parameter associated with neuron <italic>k; g<sub>k </sub></italic>is an activation function peculiar to neuron <italic>k; w<sub>k </sub></italic>is the connection strength between the activated emission from neuron <italic>k </italic>and the output layer, <italic>b </italic>is the outer layer bias parameter and <italic>g(.) </italic>is the outer activation function, which may be linear or non-linear, although it is typically taken as linear for quantitative responses. The nonlinear transformations modify the connection strengths between additive relationships and phenotypes in an adaptive manner, underlining the potential for an improvement in predictive ability.</p>
        <p>Given the availability of dense markers in humans and animals, an alternative or complementary source of input that can be used in equation (2) consists of the elements of a marker-based relationship matrix, as in [<xref ref-type="bibr" rid="B17">17</xref>]; in this case the <italic>a<sub>ij </sub></italic>coefficients are replaced by <italic>g<sub>ij</sub></italic>, i.e., elements of some genome or marker-derived relationship matrix <bold>G</bold>. As noted by [<xref ref-type="bibr" rid="B2">2</xref>], when <bold>G </bold>is proportional to <bold>XX'</bold>, where <bold>X </bold>is the incidence matrix of a linear regression model on markers, this is equivalent to Bayesian ridge regression. Of course, nothing precludes using both pedigree-derived and marker-derived inputs in the construction of a neural network.</p>
      </sec>
      <sec>
        <title>Bayesian regularization</title>
        <p>The objective in ANNs is to arrive at some configuration that fits the training data well but that it also has a reasonable ability of predicting yet to be seen observations. This can be achieved by placing constraints on the size of the network connection strengths, e.g., via shrinkage, and the process is known as regularization. A natural way of attaining this compromise between goodness of fit and predictive ability is by means of Bayesian methods [<xref ref-type="bibr" rid="B2">2</xref>,<xref ref-type="bibr" rid="B11">11</xref>,<xref ref-type="bibr" rid="B15">15</xref>,<xref ref-type="bibr" rid="B18">18</xref>]. In this section, an approach used often for Bayesian regularization in neural networks [<xref ref-type="bibr" rid="B18">18</xref>,<xref ref-type="bibr" rid="B19">19</xref>] is presented along the lines of the hierarchical models employed by quantitative geneticists [<xref ref-type="bibr" rid="B15">15</xref>].</p>
        <p>Conditionally on <italic>m </italic>network parameters, the <italic>n </italic>phenotypes or outputs (represented as <italic>D </italic>for data) are assumed to be mutually independent, with density function (inputs p are omitted in the notation)</p>
        <p>
          <disp-formula id="bmcM3">
            <label>(3)</label>
            <mml:math id="M9" name="1471-2156-12-87-i7" overflow="scroll">
              <mml:mrow>
                <mml:mi>p</mml:mi>
                <mml:mrow>
                  <mml:mo class="MathClass-open">(</mml:mo>
                  <mml:mrow>
                    <mml:mi>D</mml:mi>
                    <mml:mo class="MathClass-rel">|</mml:mo>
                    <mml:mi>b</mml:mi>
                    <mml:mo class="MathClass-punc">,</mml:mo>
                    <mml:mstyle mathvariant="bold">
                      <mml:mi>w</mml:mi>
                    </mml:mstyle>
                    <mml:mo class="MathClass-punc">,</mml:mo>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mi>&#x3C3;</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mn>2</mml:mn>
                      </mml:mrow>
                    </mml:msup>
                    <mml:mo class="MathClass-punc">,</mml:mo>
                    <mml:mi>M</mml:mi>
                  </mml:mrow>
                  <mml:mo class="MathClass-close">)</mml:mo>
                </mml:mrow>
                <mml:mo class="MathClass-rel">=</mml:mo>
                <mml:munderover accentunder="false" accent="false">
                  <mml:mrow>
                    <mml:mo mathsize="big"> &#x220F;</mml:mo>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                    <mml:mo class="MathClass-rel">=</mml:mo>
                    <mml:mn>1</mml:mn>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>n</mml:mi>
                  </mml:mrow>
                </mml:munderover>
                <mml:mi>N</mml:mi>
                <mml:mfenced open="(" close=")">
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>t</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo class="MathClass-rel">|</mml:mo>
                    <mml:mi>b</mml:mi>
                    <mml:mo class="MathClass-punc">,</mml:mo>
                    <mml:mstyle mathvariant="bold">
                      <mml:mi>w</mml:mi>
                    </mml:mstyle>
                    <mml:mo class="MathClass-punc">,</mml:mo>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mi>&#x3C3;</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mn>2</mml:mn>
                      </mml:mrow>
                    </mml:msup>
                    <mml:mo class="MathClass-punc">,</mml:mo>
                    <mml:mi>M</mml:mi>
                  </mml:mrow>
                </mml:mfenced>
              </mml:mrow>
            </mml:math>
          </disp-formula>
        </p>
        <p>where <italic>N(.) </italic>denotes a normal density; <italic>b </italic>is the outer bias parameter; <bold>w </bold>denotes all connection strength coefficients (including all neuron-specific biases); <italic>&#x3C3;<sup>2 </sup></italic>is the residual variance and <italic>M </italic>represents a given neural network architecture (i.e., a choice of number of neurons and activation functions). The mean of this distribution is the conditional (given all regression coefficients) expectation function <inline-formula><mml:math id="M10" name="1471-2156-12-87-i8" overflow="scroll"><mml:mi>b</mml:mi><mml:mo class="MathClass-bin">+</mml:mo><mml:mi>c</mml:mi><mml:mi>g</mml:mi><mml:mfenced open="[" close="]"><mml:mrow><mml:munderover accentunder="false" accent="false"><mml:mrow><mml:mo class="MathClass-op">&#x2211;</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo class="MathClass-rel">=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo class="MathClass-open">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo class="MathClass-bin">+</mml:mo><mml:msubsup><mml:mrow><mml:mo class="MathClass-op"> &#x2211;</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo class="MathClass-rel">=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo class="MathClass-bin">*</mml:mo><mml:mo class="MathClass-bin">*</mml:mo><mml:mrow><mml:mo class="MathClass-open">[</mml:mo><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mo class="MathClass-close">]</mml:mo></mml:mrow></mml:mrow></mml:msubsup></mml:mrow><mml:mo class="MathClass-close">)</mml:mo></mml:mrow></mml:mrow></mml:mfenced></mml:math></inline-formula>, <italic>i </italic>= 1,2,...,<italic>n</italic>. The bias parameter <italic>b </italic>can be eliminated simply by taking deviations from the mean, or assigned a flat prior; for simplicity the first of the two options was employed in this study. The Bayesian approach used in regularized neural networks software (e.g., MATLAB) assigns the same normal prior distribution to each of the connection strengths, assumed independent a priori, such that <italic>p</italic>(<bold>w</bold>| <italic>&#x3C3;</italic><sup>2</sup><italic><sub>w</sub></italic>) = <italic>N</italic>(0, <bold>I</bold><italic>&#x3C3;</italic><sup>2</sup><italic><sub>w</sub></italic>), where <italic>&#x3C3;</italic><sup>2</sup><italic><sub>w </sub></italic>is the variance of connection strengths. More general specifications can be posed, but currently available software (public or commercially) lacks flexibility for doing so. Assuming that the two variance parameters are known, the posterior density of the connection strengths is</p>
        <p>
          <disp-formula id="bmcM4">
            <label>(4)</label>
            <mml:math id="M11" name="1471-2156-12-87-i9" overflow="scroll">
              <mml:mi>P</mml:mi>
              <mml:mrow>
                <mml:mo class="MathClass-open">(</mml:mo>
                <mml:mrow>
                  <mml:mstyle mathvariant="bold">
                    <mml:mi>w</mml:mi>
                  </mml:mstyle>
                  <mml:mo class="MathClass-rel">|</mml:mo>
                  <mml:mi>D</mml:mi>
                  <mml:mo class="MathClass-punc">,</mml:mo>
                  <mml:msup>
                    <mml:mrow>
                      <mml:mi>&#x3C3;</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mn>2</mml:mn>
                    </mml:mrow>
                  </mml:msup>
                  <mml:mo class="MathClass-punc">,</mml:mo>
                  <mml:msubsup>
                    <mml:mrow>
                      <mml:mi>&#x3C3;</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mstyle mathvariant="bold">
                        <mml:mi>w</mml:mi>
                      </mml:mstyle>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mn>2</mml:mn>
                    </mml:mrow>
                  </mml:msubsup>
                  <mml:mo class="MathClass-punc">,</mml:mo>
                  <mml:mi>M</mml:mi>
                </mml:mrow>
                <mml:mo class="MathClass-close">)</mml:mo>
              </mml:mrow>
              <mml:mo class="MathClass-rel">=</mml:mo>
              <mml:mfrac>
                <mml:mrow>
                  <mml:mi>P</mml:mi>
                  <mml:mrow>
                    <mml:mo class="MathClass-open">(</mml:mo>
                    <mml:mrow>
                      <mml:mi>D</mml:mi>
                      <mml:mo class="MathClass-rel">|</mml:mo>
                      <mml:mstyle mathvariant="bold">
                        <mml:mi>w</mml:mi>
                      </mml:mstyle>
                      <mml:mo class="MathClass-punc">,</mml:mo>
                      <mml:msup>
                        <mml:mrow>
                          <mml:mi>&#x3C3;</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mn>2</mml:mn>
                        </mml:mrow>
                      </mml:msup>
                      <mml:mo class="MathClass-punc">,</mml:mo>
                      <mml:mi>M</mml:mi>
                    </mml:mrow>
                    <mml:mo class="MathClass-close">)</mml:mo>
                  </mml:mrow>
                  <mml:mi>P</mml:mi>
                  <mml:mrow>
                    <mml:mo class="MathClass-open">(</mml:mo>
                    <mml:mrow>
                      <mml:mstyle mathvariant="bold">
                        <mml:mi>w</mml:mi>
                      </mml:mstyle>
                      <mml:mo class="MathClass-rel">|</mml:mo>
                      <mml:msubsup>
                        <mml:mrow>
                          <mml:mi>&#x3C3;</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mstyle mathvariant="bold">
                            <mml:mi>w</mml:mi>
                          </mml:mstyle>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mn>2</mml:mn>
                        </mml:mrow>
                      </mml:msubsup>
                      <mml:mo class="MathClass-punc">,</mml:mo>
                      <mml:mi>M</mml:mi>
                    </mml:mrow>
                    <mml:mo class="MathClass-close">)</mml:mo>
                  </mml:mrow>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>P</mml:mi>
                  <mml:mrow>
                    <mml:mo class="MathClass-open">(</mml:mo>
                    <mml:mrow>
                      <mml:mi>D</mml:mi>
                      <mml:mo class="MathClass-rel">|</mml:mo>
                      <mml:msup>
                        <mml:mrow>
                          <mml:mi>&#x3C3;</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mn>2</mml:mn>
                        </mml:mrow>
                      </mml:msup>
                      <mml:mo class="MathClass-punc">,</mml:mo>
                      <mml:msubsup>
                        <mml:mrow>
                          <mml:mi>&#x3C3;</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mstyle mathvariant="bold">
                            <mml:mi>w</mml:mi>
                          </mml:mstyle>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mn>2</mml:mn>
                        </mml:mrow>
                      </mml:msubsup>
                      <mml:mo class="MathClass-punc">,</mml:mo>
                      <mml:mi>M</mml:mi>
                    </mml:mrow>
                    <mml:mo class="MathClass-close">)</mml:mo>
                  </mml:mrow>
                </mml:mrow>
              </mml:mfrac>
              <mml:mo class="MathClass-punc">,</mml:mo>
            </mml:math>
          </disp-formula>
        </p>
        <p>where the denominator is the marginal density of the data, that is</p>
        <p>
          <disp-formula>
            <mml:math id="M12" name="1471-2156-12-87-i10" overflow="scroll">
              <mml:mrow>
                <mml:mi>P</mml:mi>
                <mml:mrow>
                  <mml:mo class="MathClass-open">(</mml:mo>
                  <mml:mrow>
                    <mml:mi>D</mml:mi>
                    <mml:mo class="MathClass-rel">|</mml:mo>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mi>&#x3C3;</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mn>2</mml:mn>
                      </mml:mrow>
                    </mml:msup>
                    <mml:mo class="MathClass-punc">,</mml:mo>
                    <mml:msubsup>
                      <mml:mrow>
                        <mml:mi>&#x3C3;</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>w</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mn>2</mml:mn>
                      </mml:mrow>
                    </mml:msubsup>
                    <mml:mo class="MathClass-punc">,</mml:mo>
                    <mml:mi>M</mml:mi>
                  </mml:mrow>
                  <mml:mo class="MathClass-close">)</mml:mo>
                </mml:mrow>
                <mml:mo class="MathClass-rel">=</mml:mo>
                <mml:mo class="MathClass-op"> &#x222B; </mml:mo>
                <mml:mi>P</mml:mi>
                <mml:mrow>
                  <mml:mo class="MathClass-open">(</mml:mo>
                  <mml:mrow>
                    <mml:mi>D</mml:mi>
                    <mml:mo class="MathClass-rel">|</mml:mo>
                    <mml:mstyle mathvariant="bold">
                      <mml:mi>w</mml:mi>
                    </mml:mstyle>
                    <mml:mo class="MathClass-punc">,</mml:mo>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mi>&#x3C3;</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mn>2</mml:mn>
                      </mml:mrow>
                    </mml:msup>
                    <mml:mo class="MathClass-punc">,</mml:mo>
                    <mml:mi>M</mml:mi>
                  </mml:mrow>
                  <mml:mo class="MathClass-close">)</mml:mo>
                </mml:mrow>
                <mml:mi>P</mml:mi>
                <mml:mrow>
                  <mml:mo class="MathClass-open">(</mml:mo>
                  <mml:mrow>
                    <mml:mstyle mathvariant="bold">
                      <mml:mi>w</mml:mi>
                    </mml:mstyle>
                    <mml:mo class="MathClass-rel">|</mml:mo>
                    <mml:msubsup>
                      <mml:mrow>
                        <mml:mi>&#x3C3;</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>w</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mn>2</mml:mn>
                      </mml:mrow>
                    </mml:msubsup>
                    <mml:mo class="MathClass-punc">,</mml:mo>
                    <mml:mi>M</mml:mi>
                  </mml:mrow>
                  <mml:mo class="MathClass-close">)</mml:mo>
                </mml:mrow>
                <mml:mi>d</mml:mi>
                <mml:mstyle mathvariant="bold">
                  <mml:mi>w</mml:mi>
                </mml:mstyle>
                <mml:mo class="MathClass-punc">.</mml:mo>
              </mml:mrow>
            </mml:math>
          </disp-formula>
        </p>
        <p>For a neural network with a least one non-linear activation function, the integral is expressible as</p>
        <p>
          <disp-formula id="bmcM5">
            <label>(5)</label>
            <mml:math id="M13" name="1471-2156-12-87-i11" overflow="scroll">
              <mml:mtable columnalign="left">
                <mml:mtr>
                  <mml:mtd>
                    <mml:mi>p</mml:mi>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mi>D</mml:mi>
                    <mml:mo>|</mml:mo>
                    <mml:msup>
                      <mml:mi>&#x3C3;</mml:mi>
                      <mml:mn>2</mml:mn>
                    </mml:msup>
                    <mml:mo>,</mml:mo>
                    <mml:msubsup>
                      <mml:mi>&#x3C3;</mml:mi>
                      <mml:mi>w</mml:mi>
                      <mml:mn>2</mml:mn>
                    </mml:msubsup>
                    <mml:mo>,</mml:mo>
                    <mml:mi>M</mml:mi>
                    <mml:mo stretchy="false">)</mml:mo>
                    <mml:mo>=</mml:mo>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mrow>
                          <mml:mfrac>
                            <mml:mn>1</mml:mn>
                            <mml:mrow>
                              <mml:mn>2</mml:mn>
                              <mml:mi>&#x3C0;</mml:mi>
                              <mml:msup>
                                <mml:mi>&#x3C3;</mml:mi>
                                <mml:mn>2</mml:mn>
                              </mml:msup>
                            </mml:mrow>
                          </mml:mfrac>
                        </mml:mrow>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mfrac>
                          <mml:mi>n</mml:mi>
                          <mml:mn>2</mml:mn>
                        </mml:mfrac>
                      </mml:mrow>
                    </mml:msup>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mrow>
                          <mml:mfrac>
                            <mml:mn>1</mml:mn>
                            <mml:mrow>
                              <mml:mn>2</mml:mn>
                              <mml:mi>&#x3C0;</mml:mi>
                              <mml:msub>
                                <mml:mi>&#x3C3;</mml:mi>
                                <mml:mi>w</mml:mi>
                              </mml:msub>
                              <mml:msup>
                                <mml:mrow/>
                                <mml:mn>2</mml:mn>
                              </mml:msup>
                            </mml:mrow>
                          </mml:mfrac>
                        </mml:mrow>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mfrac>
                          <mml:mi>m</mml:mi>
                          <mml:mn>2</mml:mn>
                        </mml:mfrac>
                      </mml:mrow>
                    </mml:msup>
                    <mml:mo>&#xD7;</mml:mo>
                  </mml:mtd>
                </mml:mtr>
                <mml:mtr>
                  <mml:mtd>
                    <mml:mstyle displaystyle="true">
                      <mml:mrow>
                        <mml:mo>&#x222B;</mml:mo>
                        <mml:mrow>
                          <mml:mtext>exp</mml:mtext>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:mstyle>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:mo>[</mml:mo>
                          <mml:mrow>
                            <mml:mo>&#x2212;</mml:mo>
                            <mml:mfrac>
                              <mml:mn>1</mml:mn>
                              <mml:mrow>
                                <mml:mn>2</mml:mn>
                                <mml:msup>
                                  <mml:mi>&#x3C3;</mml:mi>
                                  <mml:mn>2</mml:mn>
                                </mml:msup>
                              </mml:mrow>
                            </mml:mfrac>
                            <mml:mstyle displaystyle="true">
                              <mml:munderover>
                                <mml:mo>&#x2211;</mml:mo>
                                <mml:mrow>
                                  <mml:mi>i</mml:mi>
                                  <mml:mo>=</mml:mo>
                                  <mml:mn>1</mml:mn>
                                </mml:mrow>
                                <mml:mi>n</mml:mi>
                              </mml:munderover>
                              <mml:mrow>
                                <mml:mrow>
                                  <mml:mo>(</mml:mo>
                                  <mml:mrow>
                                    <mml:msub>
                                      <mml:mi>t</mml:mi>
                                      <mml:mi>i</mml:mi>
                                    </mml:msub>
                                    <mml:mo>&#x2212;</mml:mo>
                                    <mml:mi>b</mml:mi>
                                    <mml:mo>&#x2212;</mml:mo>
                                    <mml:mi>c</mml:mi>
                                    <mml:mi>g</mml:mi>
                                    <mml:mrow>
                                      <mml:mo>[</mml:mo>
                                      <mml:mrow>
                                        <mml:mstyle displaystyle="true">
                                          <mml:munderover>
                                            <mml:mo>&#x2211;</mml:mo>
                                            <mml:mrow>
                                              <mml:mi>k</mml:mi>
                                              <mml:mo>=</mml:mo>
                                              <mml:mn>1</mml:mn>
                                            </mml:mrow>
                                            <mml:mi>s</mml:mi>
                                          </mml:munderover>
                                          <mml:mrow>
                                            <mml:msub>
                                              <mml:mi>w</mml:mi>
                                              <mml:mi>k</mml:mi>
                                            </mml:msub>
                                          </mml:mrow>
                                        </mml:mstyle>
                                        <mml:msub>
                                          <mml:mi>g</mml:mi>
                                          <mml:mi>k</mml:mi>
                                        </mml:msub>
                                        <mml:mo stretchy="false">(</mml:mo>
                                        <mml:msub>
                                          <mml:mi>b</mml:mi>
                                          <mml:mi>k</mml:mi>
                                        </mml:msub>
                                        <mml:mo>+</mml:mo>
                                      </mml:mrow>
                                    </mml:mrow>
                                  </mml:mrow>
                                </mml:mrow>
                                <mml:mstyle displaystyle="true">
                                  <mml:msubsup>
                                    <mml:mo>&#x2211;</mml:mo>
                                    <mml:mrow>
                                      <mml:mi>j</mml:mi>
                                      <mml:mo>=</mml:mo>
                                      <mml:mn>1</mml:mn>
                                    </mml:mrow>
                                    <mml:mi>n</mml:mi>
                                  </mml:msubsup>
                                  <mml:mrow>
                                    <mml:msub>
                                      <mml:mi>a</mml:mi>
                                      <mml:mrow>
                                        <mml:mi>i</mml:mi>
                                        <mml:mi>j</mml:mi>
                                      </mml:mrow>
                                    </mml:msub>
                                    <mml:msubsup>
                                      <mml:mi>u</mml:mi>
                                      <mml:mi>j</mml:mi>
                                      <mml:mrow>
                                        <mml:mo>*</mml:mo>
                                        <mml:mo>*</mml:mo>
                                        <mml:mo stretchy="false">[</mml:mo>
                                        <mml:mi>k</mml:mi>
                                        <mml:mo stretchy="false">]</mml:mo>
                                      </mml:mrow>
                                    </mml:msubsup>
                                    <mml:mo stretchy="false">)</mml:mo>
                                  </mml:mrow>
                                </mml:mstyle>
                              </mml:mrow>
                            </mml:mstyle>
                          </mml:mrow>
                          <mml:mo>]</mml:mo>
                        </mml:mrow>
                      </mml:mrow>
                      <mml:mo>)</mml:mo>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mo>&#x2212;</mml:mo>
                        <mml:mfrac>
                          <mml:mn>1</mml:mn>
                          <mml:mrow>
                            <mml:mn>2</mml:mn>
                            <mml:msubsup>
                              <mml:mi>&#x3C3;</mml:mi>
                              <mml:mi>w</mml:mi>
                              <mml:mn>2</mml:mn>
                            </mml:msubsup>
                          </mml:mrow>
                        </mml:mfrac>
                        <mml:mi>w</mml:mi>
                        <mml:mstyle mathvariant="bold" mathsize="normal">
                          <mml:mo>'</mml:mo>
                        </mml:mstyle>
                        <mml:mi>w</mml:mi>
                      </mml:mrow>
                      <mml:mo>]</mml:mo>
                    </mml:mrow>
                    <mml:mi>d</mml:mi>
                    <mml:mi>w</mml:mi>
                  </mml:mtd>
                </mml:mtr>
              </mml:mtable>
            </mml:math>
          </disp-formula>
        </p>
        <p>which does not have closed form, because of non-linearity. Recall that <italic>b </italic>can be set to 0 provided the observations are suitably centered.</p>
        <p>Although a Bayesian neural network can be fitted using Markov chain Monte Carlo sampling, the computations are taxing because of the enormous non-linearities present coupled with the high-dimensionality of <bold>w</bold>, such as it is the case with genomic data. An alternative approach is based on computing conditional posterior modes of connection strengths, given some likelihood-based estimates of the variance parameters, i.e., as in best linear unbiased prediction (when viewed as a posterior mode) coupled with restricted maximum likelihood (where estimates of variances are the maximizers of a marginal likelihood). The conditional (given <italic>&#x3C3;</italic><sup>2 </sup>and <inline-formula><mml:math id="M14" name="1471-2156-12-87-i12" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>&#x3C3;</mml:mi></mml:mrow><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math></inline-formula>) log-posterior density of <bold>w </bold>is from equation (4)</p>
        <p>
          <disp-formula>
            <mml:math id="M15" name="1471-2156-12-87-i13" overflow="scroll">
              <mml:mi>L</mml:mi>
              <mml:mrow>
                <mml:mo class="MathClass-open">(</mml:mo>
                <mml:mrow>
                  <mml:mstyle mathvariant="bold">
                    <mml:mi>w</mml:mi>
                  </mml:mstyle>
                  <mml:mo class="MathClass-rel">|</mml:mo>
                  <mml:mi>D</mml:mi>
                  <mml:mo class="MathClass-punc">,</mml:mo>
                  <mml:msup>
                    <mml:mrow>
                      <mml:mi>&#x3C3;</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mn>2</mml:mn>
                    </mml:mrow>
                  </mml:msup>
                  <mml:mo class="MathClass-punc">,</mml:mo>
                  <mml:msubsup>
                    <mml:mrow>
                      <mml:mi>&#x3C3;</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>w</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mn>2</mml:mn>
                    </mml:mrow>
                  </mml:msubsup>
                  <mml:mo class="MathClass-punc">,</mml:mo>
                  <mml:mi>M</mml:mi>
                </mml:mrow>
                <mml:mo class="MathClass-close">)</mml:mo>
              </mml:mrow>
              <mml:mo class="MathClass-rel">=</mml:mo>
              <mml:mi>K</mml:mi>
              <mml:mo class="MathClass-bin">+</mml:mo>
              <mml:mo class="qopname"> log</mml:mo>
              <mml:mi>P</mml:mi>
              <mml:mrow>
                <mml:mo class="MathClass-open">(</mml:mo>
                <mml:mrow>
                  <mml:mi>D</mml:mi>
                  <mml:mo class="MathClass-rel">|</mml:mo>
                  <mml:mstyle mathvariant="bold">
                    <mml:mi>w</mml:mi>
                  </mml:mstyle>
                  <mml:mo class="MathClass-punc">,</mml:mo>
                  <mml:msup>
                    <mml:mrow>
                      <mml:mi>&#x3C3;</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mn>2</mml:mn>
                    </mml:mrow>
                  </mml:msup>
                  <mml:mo class="MathClass-punc">,</mml:mo>
                  <mml:mi>M</mml:mi>
                </mml:mrow>
                <mml:mo class="MathClass-close">)</mml:mo>
              </mml:mrow>
              <mml:mo class="MathClass-bin">+</mml:mo>
              <mml:mo class="qopname"> log</mml:mo>
              <mml:mi>P</mml:mi>
              <mml:mrow>
                <mml:mo class="MathClass-open">(</mml:mo>
                <mml:mrow>
                  <mml:mstyle mathvariant="bold">
                    <mml:mi>w</mml:mi>
                  </mml:mstyle>
                  <mml:mo class="MathClass-rel">|</mml:mo>
                  <mml:msubsup>
                    <mml:mrow>
                      <mml:mi>&#x3C3;</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>w</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mn>2</mml:mn>
                    </mml:mrow>
                  </mml:msubsup>
                  <mml:mo class="MathClass-punc">,</mml:mo>
                  <mml:mi>M</mml:mi>
                </mml:mrow>
                <mml:mo class="MathClass-close">)</mml:mo>
              </mml:mrow>
              <mml:mo class="MathClass-punc">.</mml:mo>
            </mml:math>
          </disp-formula>
        </p>
        <p>Let <inline-formula><mml:math id="M16" name="1471-2156-12-87-i14" overflow="scroll"><mml:mi>&#x3B2;</mml:mi><mml:mo class="MathClass-rel">=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mrow><mml:mi>&#x3C3;</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:math></inline-formula> and <inline-formula><mml:math id="M17" name="1471-2156-12-87-i15" overflow="scroll"><mml:mi>&#x3B1;</mml:mi><mml:mo class="MathClass-rel">=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msubsup><mml:mrow><mml:mi>&#x3C3;</mml:mi></mml:mrow><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac></mml:math></inline-formula> (a standard notation in neural networks literature), and</p>
        <p>
          <disp-formula id="bmcM6">
            <label>(6)</label>
            <mml:math id="M18" name="1471-2156-12-87-i16" overflow="scroll">
              <mml:mtable columnalign="left" class="align">
                <mml:mtr>
                  <mml:mtd columnalign="right" class="align-odd">
                    <mml:mi>F</mml:mi>
                    <mml:mrow>
                      <mml:mo class="MathClass-open">(</mml:mo>
                      <mml:mrow>
                        <mml:mi>&#x3B1;</mml:mi>
                        <mml:mo class="MathClass-punc">,</mml:mo>
                        <mml:mi>&#x3B2;</mml:mi>
                      </mml:mrow>
                      <mml:mo class="MathClass-close">)</mml:mo>
                    </mml:mrow>
                  </mml:mtd>
                  <mml:mtd class="align-even">
                    <mml:mo class="MathClass-rel">=</mml:mo>
                    <mml:mi>&#x3B2;</mml:mi>
                    <mml:munderover accentunder="false" accent="false">
                      <mml:mrow>
                        <mml:mo mathsize="big">&#x2211;</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                        <mml:mo class="MathClass-rel">=</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>n</mml:mi>
                      </mml:mrow>
                    </mml:munderover>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mfenced open="(" close=")">
                          <mml:mrow>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi>t</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>i</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                            <mml:mo class="MathClass-bin">-</mml:mo>
                            <mml:mi>b</mml:mi>
                            <mml:mo class="MathClass-bin">-</mml:mo>
                            <mml:mi>c</mml:mi>
                            <mml:mi>g</mml:mi>
                            <mml:mfenced open="[" close="]">
                              <mml:mrow>
                                <mml:munderover accentunder="false" accent="false">
                                  <mml:mrow>
                                    <mml:mo mathsize="big">&#x2211;</mml:mo>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mi>k</mml:mi>
                                    <mml:mo class="MathClass-rel">=</mml:mo>
                                    <mml:mn>1</mml:mn>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mi>s</mml:mi>
                                  </mml:mrow>
                                </mml:munderover>
                                <mml:msub>
                                  <mml:mrow>
                                    <mml:mi>w</mml:mi>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mi>k</mml:mi>
                                  </mml:mrow>
                                </mml:msub>
                                <mml:msub>
                                  <mml:mrow>
                                    <mml:mi>g</mml:mi>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mi>k</mml:mi>
                                  </mml:mrow>
                                </mml:msub>
                                <mml:mrow>
                                  <mml:mo class="MathClass-open">(</mml:mo>
                                  <mml:mrow>
                                    <mml:msub>
                                      <mml:mrow>
                                        <mml:mi>b</mml:mi>
                                      </mml:mrow>
                                      <mml:mrow>
                                        <mml:mi>k</mml:mi>
                                      </mml:mrow>
                                    </mml:msub>
                                    <mml:mo class="MathClass-bin">+</mml:mo>
                                    <mml:msubsup>
                                      <mml:mrow>
                                        <mml:mo mathsize="big"> &#x2211;</mml:mo>
                                      </mml:mrow>
                                      <mml:mrow>
                                        <mml:mi>j</mml:mi>
                                        <mml:mo class="MathClass-rel">=</mml:mo>
                                        <mml:mn>1</mml:mn>
                                      </mml:mrow>
                                      <mml:mrow>
                                        <mml:mi>n</mml:mi>
                                      </mml:mrow>
                                    </mml:msubsup>
                                    <mml:msub>
                                      <mml:mrow>
                                        <mml:mi>a</mml:mi>
                                      </mml:mrow>
                                      <mml:mrow>
                                        <mml:mi>i</mml:mi>
                                        <mml:mi>j</mml:mi>
                                      </mml:mrow>
                                    </mml:msub>
                                    <mml:msubsup>
                                      <mml:mrow>
                                        <mml:mi>u</mml:mi>
                                      </mml:mrow>
                                      <mml:mrow>
                                        <mml:mi>j</mml:mi>
                                      </mml:mrow>
                                      <mml:mrow>
                                        <mml:mo class="MathClass-bin">*</mml:mo>
                                        <mml:mo class="MathClass-bin">*</mml:mo>
                                        <mml:mrow>
                                          <mml:mo class="MathClass-open">[</mml:mo>
                                          <mml:mrow>
                                            <mml:mi>k</mml:mi>
                                          </mml:mrow>
                                          <mml:mo class="MathClass-close">]</mml:mo>
                                        </mml:mrow>
                                      </mml:mrow>
                                    </mml:msubsup>
                                  </mml:mrow>
                                  <mml:mo class="MathClass-close">)</mml:mo>
                                </mml:mrow>
                              </mml:mrow>
                            </mml:mfenced>
                          </mml:mrow>
                        </mml:mfenced>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mn>2</mml:mn>
                      </mml:mrow>
                    </mml:msup>
                    <mml:mo class="MathClass-bin">+</mml:mo>
                    <mml:mi>&#x3B1;</mml:mi>
                    <mml:mstyle mathvariant="bold">
                      <mml:msup>
                        <mml:mrow>
                          <mml:mi>w</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>&#x2032;</mml:mi>
                        </mml:mrow>
                      </mml:msup>
                      <mml:mi>w</mml:mi>
                    </mml:mstyle>
                    <mml:mo class="MathClass-punc">,</mml:mo>
                    <mml:mspace width="2em"/>
                  </mml:mtd>
                  <mml:mtd columnalign="right" class="align-label">
                    <mml:mstyle id="x1-2r1" class="label"/>
                    <mml:mstyle class="maketag">
                      <mml:mtext>(1)</mml:mtext>
                    </mml:mstyle>
                  </mml:mtd>
                </mml:mtr>
                <mml:mtr>
                  <mml:mtd columnalign="right" class="align-odd"/>
                  <mml:mtd class="align-even">
                    <mml:mo class="MathClass-rel">=</mml:mo>
                    <mml:mi>&#x3B2;</mml:mi>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>E</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>D</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo class="MathClass-bin">+</mml:mo>
                    <mml:mi>&#x3B1;</mml:mi>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>E</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>w</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mspace width="2em"/>
                  </mml:mtd>
                  <mml:mtd columnalign="right" class="align-label">
                    <mml:mstyle id="x1-3r2" class="label"/>
                    <mml:mstyle class="maketag">
                      <mml:mtext>(2)</mml:mtext>
                    </mml:mstyle>
                  </mml:mtd>
                </mml:mtr>
                <mml:mtr>
                  <mml:mtd columnalign="right" class="align-odd"/>
                  <mml:mtd class="align-even">
                    <mml:mspace width="2em"/>
                  </mml:mtd>
                  <mml:mtd columnalign="right" class="align-label">
                    <mml:mstyle id="x1-4r3" class="label"/>
                    <mml:mstyle class="maketag">
                      <mml:mtext>(3)</mml:mtext>
                    </mml:mstyle>
                  </mml:mtd>
                </mml:mtr>
              </mml:mtable>
            </mml:math>
          </disp-formula>
        </p>
        <p>where</p>
        <p>
          <disp-formula>
            <mml:math id="M19" name="1471-2156-12-87-i17" overflow="scroll">
              <mml:mrow>
                <mml:msub>
                  <mml:mi>E</mml:mi>
                  <mml:mi>D</mml:mi>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:msup>
                  <mml:mrow>
                    <mml:mstyle displaystyle="true">
                      <mml:munderover>
                        <mml:mo>&#x2211;</mml:mo>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                          <mml:mo>=</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                        <mml:mi>n</mml:mi>
                      </mml:munderover>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:mo>(</mml:mo>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mi>t</mml:mi>
                              <mml:mi>i</mml:mi>
                            </mml:msub>
                            <mml:mo>&#x2212;</mml:mo>
                            <mml:mi>b</mml:mi>
                            <mml:mo>&#x2212;</mml:mo>
                            <mml:mi>c</mml:mi>
                            <mml:mi>g</mml:mi>
                            <mml:mrow>
                              <mml:mo>[</mml:mo>
                              <mml:mrow>
                                <mml:mstyle displaystyle="true">
                                  <mml:munderover>
                                    <mml:mo>&#x2211;</mml:mo>
                                    <mml:mrow>
                                      <mml:mi>k</mml:mi>
                                      <mml:mo>=</mml:mo>
                                      <mml:mn>1</mml:mn>
                                    </mml:mrow>
                                    <mml:mi>s</mml:mi>
                                  </mml:munderover>
                                  <mml:mrow>
                                    <mml:msub>
                                      <mml:mi>w</mml:mi>
                                      <mml:mi>k</mml:mi>
                                    </mml:msub>
                                  </mml:mrow>
                                </mml:mstyle>
                                <mml:msub>
                                  <mml:mi>g</mml:mi>
                                  <mml:mi>k</mml:mi>
                                </mml:msub>
                                <mml:mo stretchy="false">(</mml:mo>
                                <mml:msub>
                                  <mml:mi>b</mml:mi>
                                  <mml:mi>k</mml:mi>
                                </mml:msub>
                                <mml:mo>+</mml:mo>
                                <mml:mstyle displaystyle="true">
                                  <mml:msubsup>
                                    <mml:mo>&#x2211;</mml:mo>
                                    <mml:mrow>
                                      <mml:mi>j</mml:mi>
                                      <mml:mo>=</mml:mo>
                                      <mml:mn>1</mml:mn>
                                    </mml:mrow>
                                    <mml:mi>n</mml:mi>
                                  </mml:msubsup>
                                  <mml:mrow>
                                    <mml:msub>
                                      <mml:mi>a</mml:mi>
                                      <mml:mrow>
                                        <mml:mi>i</mml:mi>
                                        <mml:mi>j</mml:mi>
                                      </mml:mrow>
                                    </mml:msub>
                                    <mml:msubsup>
                                      <mml:mi>u</mml:mi>
                                      <mml:mi>j</mml:mi>
                                      <mml:mrow>
                                        <mml:mo>*</mml:mo>
                                        <mml:mo>*</mml:mo>
                                        <mml:mo stretchy="false">[</mml:mo>
                                        <mml:mi>k</mml:mi>
                                        <mml:mo stretchy="false">]</mml:mo>
                                      </mml:mrow>
                                    </mml:msubsup>
                                  </mml:mrow>
                                </mml:mstyle>
                              </mml:mrow>
                              <mml:mo>]</mml:mo>
                            </mml:mrow>
                          </mml:mrow>
                          <mml:mo>)</mml:mo>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:mstyle>
                  </mml:mrow>
                  <mml:mn>2</mml:mn>
                </mml:msup>
                <mml:mo>,</mml:mo>
              </mml:mrow>
            </mml:math>
          </disp-formula>
        </p>
        <p>and <italic>E<sub>w </sub></italic>= <bold>w'w</bold>. It follows that maximizing <inline-formula><mml:math id="M20" name="1471-2156-12-87-i18" overflow="scroll"><mml:mi>L</mml:mi><mml:mrow><mml:mo class="MathClass-open">(</mml:mo><mml:mrow><mml:mstyle mathvariant="bold"><mml:mi>w</mml:mi></mml:mstyle><mml:mspace width="2.77695pt" class="tmspace"/><mml:mo class="MathClass-rel">|</mml:mo><mml:mi>D</mml:mi><mml:mo class="MathClass-punc">,</mml:mo><mml:msup><mml:mrow><mml:mi>&#x3C3;</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo class="MathClass-punc">,</mml:mo><mml:msubsup><mml:mrow><mml:mi>&#x3C3;</mml:mi></mml:mrow><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo class="MathClass-punc">,</mml:mo><mml:mi>M</mml:mi></mml:mrow><mml:mo class="MathClass-close">)</mml:mo></mml:mrow></mml:math></inline-formula> is equivalent to minimizing <italic>F</italic>(<italic>&#x3B1;</italic>, <italic>&#x3B2;</italic>). This function is often referred to as a "penalized" sum of squares, and it embeds a compromise between goodness of fit, given by the sum of squares of the residuals <italic>E<sub>D</sub></italic>, and the degree of model complexity, given by the sum of squares of the network weights <italic>E<sub>w</sub></italic>. The value w = w<sup>MAP </sup>that maximizes <inline-formula><mml:math id="M21" name="1471-2156-12-87-i19" overflow="scroll"><mml:mi>L</mml:mi><mml:mrow><mml:mo class="MathClass-open">(</mml:mo><mml:mrow><mml:mstyle class="text"><mml:mtext class="textsf" mathvariant="sans-serif">w</mml:mtext></mml:mstyle><mml:mspace width="2.77695pt" class="tmspace"/><mml:mo class="MathClass-rel">|</mml:mo><mml:mi>D</mml:mi><mml:mo class="MathClass-punc">,</mml:mo><mml:msup><mml:mrow><mml:mi>&#x3C3;</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo class="MathClass-punc">,</mml:mo><mml:msubsup><mml:mrow><mml:mi>&#x3C3;</mml:mi></mml:mrow><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo class="MathClass-punc">,</mml:mo><mml:mi>M</mml:mi></mml:mrow><mml:mo class="MathClass-close">)</mml:mo></mml:mrow></mml:math></inline-formula> is the mode of the conditional (given the variances) posterior density of the connection strengths; <bold>MAP </bold>stands for "<italic>maximum a </italic><italic>posteriori</italic>".</p>
        <p>If the additive infinitesimal model is represented as a neural network, the coefficient of heritability is given by <inline-formula><mml:math id="M22" name="1471-2156-12-87-i20" overflow="scroll"><mml:msup><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo class="MathClass-rel">=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>&#x3B1;</mml:mi></mml:mrow></mml:mfrac><mml:mo class="MathClass-bin">&#x2215;</mml:mo><mml:mfenced open="(" close=")"><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>&#x3B1;</mml:mi></mml:mrow></mml:mfrac><mml:mo class="MathClass-bin">+</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>&#x3B2;</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced><mml:mo class="MathClass-rel">=</mml:mo><mml:mfrac><mml:mrow><mml:mi>&#x3B2;</mml:mi></mml:mrow><mml:mrow><mml:mi>&#x3B1;</mml:mi><mml:mo class="MathClass-bin">+</mml:mo><mml:mi>&#x3B2;</mml:mi></mml:mrow></mml:mfrac></mml:math></inline-formula>. As it can be seen in equation (6), if &#x3B1;&lt;&lt;&#x3B2;, the fitting or training algorithm places more weight on goodness of fit. If &#x3B1;&gt;&gt;&#x3B2;, the algorithm emphasizes reduction in the values of <bold>w </bold>(shrinkage), which produces a less wiggly output function [<xref ref-type="bibr" rid="B20">20</xref>].</p>
        <p>Given &#x3B1; and &#x3B2;, the w = w<sup>MAP </sup>estimates can be found via any non-linear maximization algorithm as in, e.g., the threshold and survival analysis models of quantitative genetics [<xref ref-type="bibr" rid="B21">21</xref>].</p>
      </sec>
      <sec>
        <title>Tuning parameters &#x3B1; and &#x3B2;</title>
        <p>A standard procedure used in neural networks (and in the software employed here) infers &#x3B1; and &#x3B2; by maximizing the marginal likelihood of the data in equation (5); this corresponds to what is often known as empirical Bayes. Because (5) does not have a closed form (except in linear neural networks), the marginal likelihood is approximated using a Laplacian integration done in the vicinity of the current value w = w<sup>MAP</sup>, which depends in turn on the values of the tuning parameters at which the expansion is made. This type of approach for non-linear mixed models has been used in animal breeding for almost two decades [<xref ref-type="bibr" rid="B22">22</xref>].</p>
        <p>The Laplacian approximation to the marginal density in equation (5) leads to the representation</p>
        <p>
          <disp-formula id="bmcM7">
            <label>(7)</label>
            <mml:math id="M23" name="1471-2156-12-87-i21" overflow="scroll">
              <mml:mtable class="gathered">
                <mml:mtr>
                  <mml:mtd>
                    <mml:mo class="qopname">log</mml:mo>
                    <mml:mrow>
                      <mml:mo class="MathClass-open">[</mml:mo>
                      <mml:mrow>
                        <mml:mi>p</mml:mi>
                        <mml:mrow>
                          <mml:mo class="MathClass-open">(</mml:mo>
                          <mml:mrow>
                            <mml:mi>D</mml:mi>
                            <mml:mo class="MathClass-rel">|</mml:mo>
                            <mml:mi>&#x3B1;</mml:mi>
                            <mml:mo class="MathClass-punc">,</mml:mo>
                            <mml:mi>&#x3B2;</mml:mi>
                            <mml:mo class="MathClass-punc">,</mml:mo>
                            <mml:mi>M</mml:mi>
                          </mml:mrow>
                          <mml:mo class="MathClass-close">)</mml:mo>
                        </mml:mrow>
                      </mml:mrow>
                      <mml:mo class="MathClass-close">]</mml:mo>
                    </mml:mrow>
                    <mml:mo class="MathClass-rel">&#x2248;</mml:mo>
                    <mml:mi>K</mml:mi>
                    <mml:mo class="MathClass-bin">+</mml:mo>
                    <mml:mfrac>
                      <mml:mrow>
                        <mml:mi>n</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mn>2</mml:mn>
                      </mml:mrow>
                    </mml:mfrac>
                    <mml:mo class="qopname">log</mml:mo>
                    <mml:mrow>
                      <mml:mo class="MathClass-open">(</mml:mo>
                      <mml:mrow>
                        <mml:mi>&#x3B2;</mml:mi>
                      </mml:mrow>
                      <mml:mo class="MathClass-close">)</mml:mo>
                    </mml:mrow>
                    <mml:mo class="MathClass-bin">+</mml:mo>
                    <mml:mfrac>
                      <mml:mrow>
                        <mml:mi>m</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mn>2</mml:mn>
                      </mml:mrow>
                    </mml:mfrac>
                    <mml:mo class="qopname">log</mml:mo>
                    <mml:mrow>
                      <mml:mo class="MathClass-open">(</mml:mo>
                      <mml:mrow>
                        <mml:mi>&#x3B1;</mml:mi>
                      </mml:mrow>
                      <mml:mo class="MathClass-close">)</mml:mo>
                    </mml:mrow>
                  </mml:mtd>
                </mml:mtr>
                <mml:mtr>
                  <mml:mtd>
                    <mml:mspace width="1em" class="quad"/>
                    <mml:mspace width="1em" class="quad"/>
                    <mml:mspace width="1em" class="quad"/>
                    <mml:mspace width="1em" class="quad"/>
                    <mml:mspace width="1em" class="quad"/>
                    <mml:mspace width="1em" class="quad"/>
                    <mml:mspace width="1em" class="quad"/>
                    <mml:mspace width="1em" class="quad"/>
                    <mml:mspace width="1em" class="quad"/>
                    <mml:mspace width="1em" class="quad"/>
                    <mml:mspace width="1em" class="quad"/>
                    <mml:mspace width="1em" class="quad"/>
                    <mml:mspace width="1em" class="quad"/>
                    <mml:mspace width="1em" class="quad"/>
                    <mml:mspace width="1em" class="quad"/>
                    <mml:mo class="MathClass-bin">-</mml:mo>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mfenced open="|" close="|">
                          <mml:mrow>
                            <mml:mi>F</mml:mi>
                            <mml:mrow>
                              <mml:mo class="MathClass-open">(</mml:mo>
                              <mml:mrow>
                                <mml:mi>&#x3B1;</mml:mi>
                                <mml:mo class="MathClass-punc">,</mml:mo>
                                <mml:mi>&#x3B2;</mml:mi>
                              </mml:mrow>
                              <mml:mo class="MathClass-close">)</mml:mo>
                            </mml:mrow>
                          </mml:mrow>
                        </mml:mfenced>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>w</mml:mi>
                        <mml:mo class="MathClass-rel">=</mml:mo>
                        <mml:msubsup>
                          <mml:mrow>
                            <mml:mi>w</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mrow>
                              <mml:mo class="MathClass-open">(</mml:mo>
                              <mml:mrow>
                                <mml:mi>&#x3B1;</mml:mi>
                                <mml:mo class="MathClass-punc">,</mml:mo>
                                <mml:mi>&#x3B2;</mml:mi>
                              </mml:mrow>
                              <mml:mo class="MathClass-close">)</mml:mo>
                            </mml:mrow>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>M</mml:mi>
                            <mml:mi>A</mml:mi>
                            <mml:mi>P</mml:mi>
                          </mml:mrow>
                        </mml:msubsup>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo class="MathClass-bin">-</mml:mo>
                    <mml:mfrac>
                      <mml:mrow>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mn>2</mml:mn>
                      </mml:mrow>
                    </mml:mfrac>
                    <mml:mo class="qopname">log</mml:mo>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mfenced open="&#x2225;" close="&#x2225;">
                          <mml:mrow>
                            <mml:mstyle mathvariant="bold">
                              <mml:mi>H</mml:mi>
                            </mml:mstyle>
                          </mml:mrow>
                        </mml:mfenced>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>w</mml:mi>
                        <mml:mo class="MathClass-rel">=</mml:mo>
                        <mml:msubsup>
                          <mml:mrow>
                            <mml:mi>w</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mrow>
                              <mml:mo class="MathClass-open">(</mml:mo>
                              <mml:mrow>
                                <mml:mi>&#x3B1;</mml:mi>
                                <mml:mo class="MathClass-punc">,</mml:mo>
                                <mml:mi>&#x3B2;</mml:mi>
                              </mml:mrow>
                              <mml:mo class="MathClass-close">)</mml:mo>
                            </mml:mrow>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>M</mml:mi>
                            <mml:mi>A</mml:mi>
                            <mml:mi>P</mml:mi>
                          </mml:mrow>
                        </mml:msubsup>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mtd>
                </mml:mtr>
                <mml:mtr>
                  <mml:mtd/>
                </mml:mtr>
              </mml:mtable>
            </mml:math>
          </disp-formula>
        </p>
        <p>where <italic>K </italic>is a constant and <inline-formula><mml:math id="M24" name="1471-2156-12-87-i22" overflow="scroll"><mml:mstyle mathvariant="bold"><mml:mi>H</mml:mi></mml:mstyle><mml:mo class="MathClass-rel">=</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>&#x2202;</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>&#x2202;</mml:mi><mml:mstyle mathvariant="bold"><mml:mi>w</mml:mi></mml:mstyle><mml:mi>&#x2202;</mml:mi><mml:msup><mml:mrow><mml:mstyle mathvariant="bold"><mml:mi>w</mml:mi></mml:mstyle></mml:mrow><mml:mrow><mml:mi>&#x2032;</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mi>F</mml:mi><mml:mrow><mml:mo class="MathClass-open">(</mml:mo><mml:mrow><mml:mi>&#x3B1;</mml:mi><mml:mo class="MathClass-punc">,</mml:mo><mml:mi>&#x3B2;</mml:mi></mml:mrow><mml:mo class="MathClass-close">)</mml:mo></mml:mrow></mml:math></inline-formula> is the Hessian matrix. A grid search can be used to locate the &#x3B1;, &#x3B2; maximizers of the marginal likelihood in the training set. An alternative approach described by [<xref ref-type="bibr" rid="B18">18</xref>,<xref ref-type="bibr" rid="B23">23</xref>] involves the iteration (updating is from right to left, with <bold>w</bold><sup>MAP </sup>evaluated at the "old" values of the tuning parameters)</p>
        <p>
          <disp-formula>
            <mml:math id="M25" name="1471-2156-12-87-i23" overflow="scroll">
              <mml:mrow>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>&#x3B1;</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>n</mml:mi>
                    <mml:mi>e</mml:mi>
                    <mml:mi>w</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo class="MathClass-rel">=</mml:mo>
                <mml:mfrac>
                  <mml:mrow>
                    <mml:mi>m</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mn>2</mml:mn>
                    <mml:mrow>
                      <mml:mo class="MathClass-open">(</mml:mo>
                      <mml:mrow>
                        <mml:msup>
                          <mml:mrow>
                            <mml:msup>
                              <mml:mrow>
                                <mml:mstyle mathvariant="bold">
                                  <mml:mi>w</mml:mi>
                                </mml:mstyle>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>M</mml:mi>
                                <mml:mi>A</mml:mi>
                                <mml:mi>P</mml:mi>
                              </mml:mrow>
                            </mml:msup>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>&#x2032;</mml:mi>
                          </mml:mrow>
                        </mml:msup>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mstyle mathvariant="bold">
                              <mml:mi>w</mml:mi>
                            </mml:mstyle>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>M</mml:mi>
                            <mml:mi>A</mml:mi>
                            <mml:mi>P</mml:mi>
                          </mml:mrow>
                        </mml:msup>
                        <mml:mo class="MathClass-bin">+</mml:mo>
                        <mml:mi>t</mml:mi>
                        <mml:mi>r</mml:mi>
                        <mml:msubsup>
                          <mml:mrow>
                            <mml:mstyle mathvariant="bold">
                              <mml:mi>H</mml:mi>
                            </mml:mstyle>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>M</mml:mi>
                            <mml:mi>A</mml:mi>
                            <mml:mi>P</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mo class="MathClass-bin">-</mml:mo>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                        </mml:msubsup>
                      </mml:mrow>
                      <mml:mo class="MathClass-close">)</mml:mo>
                    </mml:mrow>
                  </mml:mrow>
                </mml:mfrac>
              </mml:mrow>
            </mml:math>
          </disp-formula>
        </p>
        <p>and</p>
        <p>
          <disp-formula>
            <mml:math id="M26" name="1471-2156-12-87-i24" overflow="scroll">
              <mml:mrow>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>&#x3B2;</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>n</mml:mi>
                    <mml:mi>e</mml:mi>
                    <mml:mi>w</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo class="MathClass-rel">=</mml:mo>
                <mml:mfrac>
                  <mml:mrow>
                    <mml:mi>n</mml:mi>
                    <mml:mo class="MathClass-bin">-</mml:mo>
                    <mml:mi>m</mml:mi>
                    <mml:mo class="MathClass-bin">+</mml:mo>
                    <mml:mn>2</mml:mn>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>&#x3B1;</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>M</mml:mi>
                        <mml:mi>A</mml:mi>
                        <mml:mi>P</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mi>t</mml:mi>
                    <mml:mi>r</mml:mi>
                    <mml:msubsup>
                      <mml:mrow>
                        <mml:mstyle mathvariant="bold">
                          <mml:mi>H</mml:mi>
                        </mml:mstyle>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>M</mml:mi>
                        <mml:mi>A</mml:mi>
                        <mml:mi>P</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mo class="MathClass-bin">-</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                    </mml:msubsup>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mn>2</mml:mn>
                    <mml:munderover accentunder="false" accent="false">
                      <mml:mrow>
                        <mml:mo mathsize="big">&#x2211;</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                        <mml:mo class="MathClass-rel">=</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>n</mml:mi>
                      </mml:mrow>
                    </mml:munderover>
                    <mml:msubsup>
                      <mml:mrow>
                        <mml:mfenced open="(" close=")">
                          <mml:mrow>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi>t</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>i</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                            <mml:mo class="MathClass-bin">-</mml:mo>
                            <mml:mi>b</mml:mi>
                            <mml:mo class="MathClass-bin">-</mml:mo>
                            <mml:munderover accentunder="false" accent="false">
                              <mml:mrow>
                                <mml:mo mathsize="big">&#x2211;</mml:mo>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>k</mml:mi>
                                <mml:mo class="MathClass-rel">=</mml:mo>
                                <mml:mn>1</mml:mn>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>s</mml:mi>
                              </mml:mrow>
                            </mml:munderover>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi>w</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>k</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi>g</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>k</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                            <mml:mrow>
                              <mml:mo class="MathClass-open">(</mml:mo>
                              <mml:mrow>
                                <mml:msub>
                                  <mml:mrow>
                                    <mml:mi>b</mml:mi>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mi>k</mml:mi>
                                  </mml:mrow>
                                </mml:msub>
                                <mml:mo class="MathClass-bin">+</mml:mo>
                                <mml:msubsup>
                                  <mml:mrow>
                                    <mml:mo mathsize="big"> &#x2211;</mml:mo>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mi>j</mml:mi>
                                    <mml:mo class="MathClass-rel">=</mml:mo>
                                    <mml:mn>1</mml:mn>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mi>n</mml:mi>
                                  </mml:mrow>
                                </mml:msubsup>
                                <mml:msub>
                                  <mml:mrow>
                                    <mml:mi>a</mml:mi>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mi>i</mml:mi>
                                    <mml:mi>j</mml:mi>
                                  </mml:mrow>
                                </mml:msub>
                                <mml:msubsup>
                                  <mml:mrow>
                                    <mml:mi>u</mml:mi>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mi>j</mml:mi>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mo class="MathClass-bin">*</mml:mo>
                                    <mml:mo class="MathClass-bin">*</mml:mo>
                                    <mml:mrow>
                                      <mml:mo class="MathClass-open">[</mml:mo>
                                      <mml:mrow>
                                        <mml:mi>k</mml:mi>
                                      </mml:mrow>
                                      <mml:mo class="MathClass-close">]</mml:mo>
                                    </mml:mrow>
                                  </mml:mrow>
                                </mml:msubsup>
                              </mml:mrow>
                              <mml:mo class="MathClass-close">)</mml:mo>
                            </mml:mrow>
                          </mml:mrow>
                        </mml:mfenced>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>w</mml:mi>
                        <mml:mo class="MathClass-rel">=</mml:mo>
                        <mml:msubsup>
                          <mml:mrow>
                            <mml:mi>w</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mrow>
                              <mml:mo class="MathClass-open">(</mml:mo>
                              <mml:mrow>
                                <mml:mi>&#x3B1;</mml:mi>
                                <mml:mo class="MathClass-punc">,</mml:mo>
                                <mml:mi>&#x3B2;</mml:mi>
                              </mml:mrow>
                              <mml:mo class="MathClass-close">)</mml:mo>
                            </mml:mrow>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>M</mml:mi>
                            <mml:mi>A</mml:mi>
                            <mml:mi>P</mml:mi>
                          </mml:mrow>
                        </mml:msubsup>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mn>2</mml:mn>
                      </mml:mrow>
                    </mml:msubsup>
                  </mml:mrow>
                </mml:mfrac>
              </mml:mrow>
            </mml:math>
          </disp-formula>
        </p>
        <p>These expressions, as well as (7), are similar to those that arise in maximum likelihood estimation of variance components [<xref ref-type="bibr" rid="B24">24</xref>-<xref ref-type="bibr" rid="B26">26</xref>], which vary depending on the algorithm used. Since &#x3B2; is a positive parameter, it must be that <inline-formula><mml:math id="M27" name="1471-2156-12-87-i25" overflow="scroll"><mml:mi>n</mml:mi><mml:mo class="MathClass-rel">&gt;</mml:mo><mml:mi>m</mml:mi><mml:mo class="MathClass-bin">-</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mrow><mml:mi>&#x3B1;</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mi>A</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:msubsup><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mi>A</mml:mi><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo class="MathClass-bin">-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:math></inline-formula>. The quantity <inline-formula><mml:math id="M28" name="1471-2156-12-87-i26" overflow="scroll"><mml:mi>&#x3B3;</mml:mi><mml:mo class="MathClass-rel">=</mml:mo><mml:mi>m</mml:mi><mml:mo class="MathClass-bin">-</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mrow><mml:mi>&#x3B1;</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mi>A</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:msubsup><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mi>A</mml:mi><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo class="MathClass-bin">-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:math></inline-formula> is called "effective number of parameters" in the network [<xref ref-type="bibr" rid="B20">20</xref>] and its value ranges from 0 (or 1, if an overall intercept <italic>b </italic>is fitted) to <italic>m</italic>, the total number of connection coefficients and bias parameters in the network. If &#x3B3; is close to <italic>n </italic>over-fitting results, leading to poor generalization. It follows that the computations are similar to those used in the linear and non-linear models employed by quantitative geneticists, the salient aspect being that a neural network can be strongly non-linear.</p>
        <p>More details on computing procedures for neural networks are in [<xref ref-type="bibr" rid="B12">12</xref>,<xref ref-type="bibr" rid="B14">14</xref>,<xref ref-type="bibr" rid="B18">18</xref>,<xref ref-type="bibr" rid="B23">23</xref>,<xref ref-type="bibr" rid="B27">27</xref>,<xref ref-type="bibr" rid="B28">28</xref>]. Typically, an algorithm proceeds as follows: 1) initialize <italic>&#x3B1;</italic>, <italic>&#x3B2; </italic>and all elements in w. 2) Take one step of the Levenberg-Marquardt algorithm to minimize the objective function <italic>F(&#x3B1;, &#x3B2;) </italic>and find the current value of <bold>w</bold>. 3) Compute <italic>&#x3B3;</italic>, the effective number of parameters, using the Gauss-Newton approximation to the Hessian matrix in the Levenberg-Marquardt training algorithm. 4) Compute updates <italic>&#x3B1;<sub>new </sub></italic>and <italic>&#x3B2;<sub>new</sub></italic>; and 5) iterate steps 2-4 until convergence.</p>
      </sec>
      <sec>
        <title>Neural Network Architectures Evaluated and Implementation</title>
        <p>A prototype of the networks considered is in Figure <xref ref-type="fig" rid="F1">1</xref>; as already noted, the architecture shown has five neurons in the hidden (middle) layer. The ANN examined had from 1 through 6 neurons in the hidden layer. In architectures with a single neuron, two variants were considered. In one, the activation functions were linear (identity) throughout. In this case, e.g., when additive relationships <italic>a<sub>ij </sub></italic>are used as inputs, the network becomes a random regression on such relationships. If regularization were based on <inline-formula><mml:math id="M29" name="1471-2156-12-87-i27" overflow="scroll"><mml:mstyle mathvariant="bold"><mml:mi>w</mml:mi></mml:mstyle><mml:mo class="MathClass-rel">~</mml:mo><mml:mi>N</mml:mi><mml:mrow><mml:mo class="MathClass-open">(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mstyle mathvariant="bold"><mml:mn>0</mml:mn><mml:mo class="MathClass-punc">,</mml:mo><mml:mi>A</mml:mi></mml:mstyle></mml:mrow><mml:mrow><mml:mo class="MathClass-bin">-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msubsup><mml:mrow><mml:mi>&#x3C3;</mml:mi></mml:mrow><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mo class="MathClass-close">)</mml:mo></mml:mrow></mml:math></inline-formula> as prior distribution, this would yield the standard additive ("animal") model of quantitative genetics; this was not the case here because the MATLAB software used (see below) bases regularization on <inline-formula><mml:math id="M30" name="1471-2156-12-87-i28" overflow="scroll"><mml:mstyle mathvariant="bold"><mml:mi>w</mml:mi></mml:mstyle><mml:mo class="MathClass-rel">~</mml:mo><mml:mi>N</mml:mi><mml:mrow><mml:mo class="MathClass-open">(</mml:mo><mml:mrow><mml:mstyle mathvariant="bold"><mml:mn>0</mml:mn><mml:mo class="MathClass-punc">,</mml:mo><mml:mi>I</mml:mi></mml:mstyle><mml:msubsup><mml:mrow><mml:mi>&#x3C3;</mml:mi></mml:mrow><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mo class="MathClass-close">)</mml:mo></mml:mrow></mml:math></inline-formula>. The second single-neuron architecture was based on equation (1) with a single outer bias parameter but with a non-linear activation <italic>g </italic>of the emission made by the sole neuron in the architecture. The algebraic representation of this network is</p>
        <p>
          <disp-formula>
            <mml:math id="M31" name="1471-2156-12-87-i29" overflow="scroll">
              <mml:msub>
                <mml:mrow>
                  <mml:mi>t</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mstyle class="text">
                    <mml:mtext class="textsf" mathvariant="sans-serif">i</mml:mtext>
                  </mml:mstyle>
                </mml:mrow>
              </mml:msub>
              <mml:mo class="MathClass-rel">=</mml:mo>
              <mml:mi>b</mml:mi>
              <mml:mo class="MathClass-bin">+</mml:mo>
              <mml:mi>c</mml:mi>
              <mml:mi>g</mml:mi>
              <mml:mrow>
                <mml:mo class="MathClass-open">(</mml:mo>
                <mml:mrow>
                  <mml:mi>b</mml:mi>
                  <mml:mo class="MathClass-bin">+</mml:mo>
                  <mml:msubsup>
                    <mml:mrow>
                      <mml:mo class="MathClass-op"> &#x2211;</mml:mo>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>j</mml:mi>
                      <mml:mo class="MathClass-rel">=</mml:mo>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>n</mml:mi>
                    </mml:mrow>
                  </mml:msubsup>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>p</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>i</mml:mi>
                      <mml:mi>j</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:msubsup>
                    <mml:mrow>
                      <mml:mi>u</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>j</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mo class="MathClass-bin">*</mml:mo>
                      <mml:mo class="MathClass-bin">*</mml:mo>
                    </mml:mrow>
                  </mml:msubsup>
                </mml:mrow>
                <mml:mo class="MathClass-close">)</mml:mo>
              </mml:mrow>
              <mml:mo class="MathClass-bin">+</mml:mo>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>e</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>i</mml:mi>
                </mml:mrow>
              </mml:msub>
              <mml:mo class="MathClass-punc">,</mml:mo>
              <mml:mspace width="1em" class="quad"/>
              <mml:mi>i</mml:mi>
              <mml:mo class="MathClass-rel">=</mml:mo>
              <mml:mn>1</mml:mn>
              <mml:mo class="MathClass-punc">,</mml:mo>
              <mml:mn>2</mml:mn>
              <mml:mo class="MathClass-punc">,</mml:mo>
              <mml:mo class="MathClass-op">&#x2026;</mml:mo>
              <mml:mo class="MathClass-punc">,</mml:mo>
              <mml:mi>n</mml:mi>
              <mml:mo class="MathClass-punc">,</mml:mo>
            </mml:math>
          </disp-formula>
        </p>
        <p>where <italic>c </italic>is the regression of <italic>t<sub>i </sub></italic>on the activated emission <inline-formula><mml:math id="M32" name="1471-2156-12-87-i30" overflow="scroll"><mml:mi>g</mml:mi><mml:mrow><mml:mo class="MathClass-open">(</mml:mo><mml:mrow><mml:mi>b</mml:mi><mml:mo class="MathClass-bin">+</mml:mo><mml:msubsup><mml:mrow><mml:mo class="MathClass-op"> &#x2211;</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo class="MathClass-rel">=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo class="MathClass-bin">*</mml:mo><mml:mo class="MathClass-bin">*</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo class="MathClass-close">)</mml:mo></mml:mrow></mml:math></inline-formula>. The objective here was to explore non-linearities between the inputs (additive or genomic relationships in the Jersey data, or markers genotypes in the wheat data) and the targets (phenotypes); the standard additive genetic model assumes that these relationships are linear. The activation function chosen was the hyperbolic tangent transformation <inline-formula><mml:math id="M33" name="1471-2156-12-87-i31" overflow="scroll"><mml:mi>g</mml:mi><mml:mrow><mml:mo class="MathClass-open">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo class="MathClass-close">)</mml:mo></mml:mrow><mml:mo class="MathClass-rel">=</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mo class="MathClass-bin">-</mml:mo><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo class="MathClass-bin">-</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mo class="MathClass-bin">+</mml:mo><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo class="MathClass-bin">-</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:math></inline-formula>, where <inline-formula><mml:math id="M34" name="1471-2156-12-87-i32" overflow="scroll"><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo class="MathClass-rel">=</mml:mo><mml:mi>b</mml:mi><mml:mo class="MathClass-bin">+</mml:mo><mml:msubsup><mml:mrow><mml:mo class="MathClass-op"> &#x2211;</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo class="MathClass-rel">=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo class="MathClass-bin">*</mml:mo><mml:mo class="MathClass-bin">*</mml:mo></mml:mrow></mml:msubsup></mml:math></inline-formula>; here, <italic>x </italic>can take any value in the real line and <italic>g(x<sub>i</sub>) </italic>is the neuron emission for cow or wheat line <italic>i</italic>, which takes values between -1 and 1. Given the inputs, the predicted phenotype or network output is</p>
        <p>
          <disp-formula>
            <mml:math id="M35" name="1471-2156-12-87-i33" overflow="scroll">
              <mml:mrow>
                <mml:msub>
                  <mml:mrow>
                    <mml:mover accent="true">
                      <mml:mrow>
                        <mml:mi>t</mml:mi>
                      </mml:mrow>
                      <mml:mo class="MathClass-op">^</mml:mo>
                    </mml:mover>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo class="MathClass-rel">=</mml:mo>
                <mml:mover accent="true">
                  <mml:mrow>
                    <mml:mi>b</mml:mi>
                  </mml:mrow>
                  <mml:mo class="MathClass-op">^</mml:mo>
                </mml:mover>
                <mml:mo class="MathClass-bin">+</mml:mo>
                <mml:mi>&#x109;</mml:mi>
                <mml:mfenced open="(" close=")">
                  <mml:mrow>
                    <mml:mfrac>
                      <mml:mrow>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mi>e</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mover accent="true">
                              <mml:mrow>
                                <mml:mi>b</mml:mi>
                              </mml:mrow>
                              <mml:mo class="MathClass-op">^</mml:mo>
                            </mml:mover>
                            <mml:mo class="MathClass-bin">+</mml:mo>
                            <mml:msubsup>
                              <mml:mrow>
                                <mml:mi>&#x3A3;</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>j</mml:mi>
                                <mml:mo class="MathClass-rel">=</mml:mo>
                                <mml:mn>1</mml:mn>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>n</mml:mi>
                              </mml:mrow>
                            </mml:msubsup>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi>p</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>i</mml:mi>
                                <mml:mi>j</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                            <mml:msubsup>
                              <mml:mrow>
                                <mml:mi>u</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>j</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mo class="MathClass-bin">*</mml:mo>
                                <mml:mo class="MathClass-bin">*</mml:mo>
                              </mml:mrow>
                            </mml:msubsup>
                          </mml:mrow>
                        </mml:msup>
                        <mml:mo class="MathClass-bin">-</mml:mo>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mi>e</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mo class="MathClass-bin">-</mml:mo>
                            <mml:mover accent="true">
                              <mml:mrow>
                                <mml:mi>b</mml:mi>
                              </mml:mrow>
                              <mml:mo class="MathClass-op">^</mml:mo>
                            </mml:mover>
                            <mml:mo class="MathClass-bin">-</mml:mo>
                            <mml:msubsup>
                              <mml:mrow>
                                <mml:mi>&#x3A3;</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>j</mml:mi>
                                <mml:mo class="MathClass-rel">=</mml:mo>
                                <mml:mn>1</mml:mn>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>n</mml:mi>
                              </mml:mrow>
                            </mml:msubsup>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi>p</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>i</mml:mi>
                                <mml:mi>j</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                            <mml:msubsup>
                              <mml:mrow>
                                <mml:mi>u</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>j</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mo class="MathClass-bin">*</mml:mo>
                                <mml:mo class="MathClass-bin">*</mml:mo>
                              </mml:mrow>
                            </mml:msubsup>
                          </mml:mrow>
                        </mml:msup>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mi>e</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mover accent="true">
                              <mml:mrow>
                                <mml:mi>b</mml:mi>
                              </mml:mrow>
                              <mml:mo class="MathClass-op">^</mml:mo>
                            </mml:mover>
                            <mml:mo class="MathClass-bin">+</mml:mo>
                            <mml:msubsup>
                              <mml:mrow>
                                <mml:mi>&#x3A3;</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>j</mml:mi>
                                <mml:mo class="MathClass-rel">=</mml:mo>
                                <mml:mn>1</mml:mn>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>n</mml:mi>
                              </mml:mrow>
                            </mml:msubsup>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi>p</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>i</mml:mi>
                                <mml:mi>j</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                            <mml:msubsup>
                              <mml:mrow>
                                <mml:mi>u</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>j</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mo class="MathClass-bin">*</mml:mo>
                                <mml:mo class="MathClass-bin">*</mml:mo>
                              </mml:mrow>
                            </mml:msubsup>
                          </mml:mrow>
                        </mml:msup>
                        <mml:mo class="MathClass-bin">+</mml:mo>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mi>e</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mo class="MathClass-bin">-</mml:mo>
                            <mml:mover accent="true">
                              <mml:mrow>
                                <mml:mi>b</mml:mi>
                              </mml:mrow>
                              <mml:mo class="MathClass-op">^</mml:mo>
                            </mml:mover>
                            <mml:mo class="MathClass-bin">-</mml:mo>
                            <mml:msubsup>
                              <mml:mrow>
                                <mml:mi>&#x3A3;</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>j</mml:mi>
                                <mml:mo class="MathClass-rel">=</mml:mo>
                                <mml:mn>1</mml:mn>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>n</mml:mi>
                              </mml:mrow>
                            </mml:msubsup>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi>p</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>i</mml:mi>
                                <mml:mi>j</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                            <mml:msubsup>
                              <mml:mrow>
                                <mml:mi>u</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>j</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mo class="MathClass-bin">*</mml:mo>
                                <mml:mo class="MathClass-bin">*</mml:mo>
                              </mml:mrow>
                            </mml:msubsup>
                          </mml:mrow>
                        </mml:msup>
                      </mml:mrow>
                    </mml:mfrac>
                  </mml:mrow>
                </mml:mfenced>
                <mml:mi>i</mml:mi>
                <mml:mo class="MathClass-rel">=</mml:mo>
                <mml:mn>1</mml:mn>
                <mml:mo class="MathClass-punc">,</mml:mo>
                <mml:mn>2</mml:mn>
                <mml:mo class="MathClass-punc">,</mml:mo>
                <mml:mo class="MathClass-op">&#x2026;</mml:mo>
                <mml:mo class="MathClass-punc">,</mml:mo>
                <mml:mi>n</mml:mi>
                <mml:mo class="MathClass-punc">.</mml:mo>
              </mml:mrow>
            </mml:math>
          </disp-formula>
        </p>
        <p>In models with 2-6 neurons the emissions were always assigned a hyperbolic tangent activation (the choice of function can be based on, e.g., cross-validation); these activations were summed and collected linearly as shown in Figure <xref ref-type="fig" rid="F1">1</xref>. For example, with 2 neurons the predictions are obtained as</p>
        <p>
          <disp-formula>
            <mml:math id="M36" name="1471-2156-12-87-i34" overflow="scroll">
              <mml:mrow>
                <mml:mtable class="gathered">
                  <mml:mtr>
                    <mml:mtd>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mover accent="true">
                            <mml:mrow>
                              <mml:mi>t</mml:mi>
                            </mml:mrow>
                            <mml:mo class="MathClass-op">^</mml:mo>
                          </mml:mover>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo class="MathClass-rel">=</mml:mo>
                      <mml:mover accent="true">
                        <mml:mrow>
                          <mml:mi>b</mml:mi>
                        </mml:mrow>
                        <mml:mo class="MathClass-op">^</mml:mo>
                      </mml:mover>
                      <mml:mo class="MathClass-bin">+</mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>&#x109;</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mfenced open="(" close=")">
                        <mml:mrow>
                          <mml:mfrac>
                            <mml:mrow>
                              <mml:msup>
                                <mml:mrow>
                                  <mml:mi>e</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:msub>
                                    <mml:mrow>
                                      <mml:mover accent="true">
                                        <mml:mrow>
                                          <mml:mi>b</mml:mi>
                                        </mml:mrow>
                                        <mml:mo class="MathClass-op">^</mml:mo>
                                      </mml:mover>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mn>1</mml:mn>
                                    </mml:mrow>
                                  </mml:msub>
                                  <mml:mo class="MathClass-bin">+</mml:mo>
                                  <mml:msubsup>
                                    <mml:mrow>
                                      <mml:mi>&#x3A3;</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mi>j</mml:mi>
                                      <mml:mo class="MathClass-rel">=</mml:mo>
                                      <mml:mn>1</mml:mn>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mi>n</mml:mi>
                                    </mml:mrow>
                                  </mml:msubsup>
                                  <mml:msub>
                                    <mml:mrow>
                                      <mml:mi>p</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mi>i</mml:mi>
                                      <mml:mi>j</mml:mi>
                                    </mml:mrow>
                                  </mml:msub>
                                  <mml:msubsup>
                                    <mml:mrow>
                                      <mml:mi>u</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mi>j</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mo class="MathClass-bin">*</mml:mo>
                                      <mml:mo class="MathClass-bin">*</mml:mo>
                                      <mml:mrow>
                                        <mml:mo class="MathClass-open">[</mml:mo>
                                        <mml:mrow>
                                          <mml:mn>1</mml:mn>
                                        </mml:mrow>
                                        <mml:mo class="MathClass-close">]</mml:mo>
                                      </mml:mrow>
                                    </mml:mrow>
                                  </mml:msubsup>
                                </mml:mrow>
                              </mml:msup>
                              <mml:mo class="MathClass-bin">-</mml:mo>
                              <mml:msup>
                                <mml:mrow>
                                  <mml:mi>e</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mo class="MathClass-bin">-</mml:mo>
                                  <mml:msub>
                                    <mml:mrow>
                                      <mml:mover accent="true">
                                        <mml:mrow>
                                          <mml:mi>b</mml:mi>
                                        </mml:mrow>
                                        <mml:mo class="MathClass-op">^</mml:mo>
                                      </mml:mover>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mn>1</mml:mn>
                                    </mml:mrow>
                                  </mml:msub>
                                  <mml:mo class="MathClass-bin">-</mml:mo>
                                  <mml:msubsup>
                                    <mml:mrow>
                                      <mml:mi>&#x3A3;</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mi>j</mml:mi>
                                      <mml:mo class="MathClass-rel">=</mml:mo>
                                      <mml:mn>1</mml:mn>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mi>n</mml:mi>
                                    </mml:mrow>
                                  </mml:msubsup>
                                  <mml:msub>
                                    <mml:mrow>
                                      <mml:mi>p</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mi>i</mml:mi>
                                      <mml:mi>j</mml:mi>
                                    </mml:mrow>
                                  </mml:msub>
                                  <mml:msubsup>
                                    <mml:mrow>
                                      <mml:mi>u</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mi>j</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mo class="MathClass-bin">*</mml:mo>
                                      <mml:mo class="MathClass-bin">*</mml:mo>
                                      <mml:mrow>
                                        <mml:mo class="MathClass-open">[</mml:mo>
                                        <mml:mrow>
                                          <mml:mn>1</mml:mn>
                                        </mml:mrow>
                                        <mml:mo class="MathClass-close">]</mml:mo>
                                      </mml:mrow>
                                    </mml:mrow>
                                  </mml:msubsup>
                                </mml:mrow>
                              </mml:msup>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:msup>
                                <mml:mrow>
                                  <mml:mi>e</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:msub>
                                    <mml:mrow>
                                      <mml:mover accent="true">
                                        <mml:mrow>
                                          <mml:mi>b</mml:mi>
                                        </mml:mrow>
                                        <mml:mo class="MathClass-op">^</mml:mo>
                                      </mml:mover>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mn>1</mml:mn>
                                    </mml:mrow>
                                  </mml:msub>
                                  <mml:mo class="MathClass-bin">+</mml:mo>
                                  <mml:msubsup>
                                    <mml:mrow>
                                      <mml:mi>&#x3A3;</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mi>j</mml:mi>
                                      <mml:mo class="MathClass-rel">=</mml:mo>
                                      <mml:mn>1</mml:mn>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mi>n</mml:mi>
                                    </mml:mrow>
                                  </mml:msubsup>
                                  <mml:msub>
                                    <mml:mrow>
                                      <mml:mi>p</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mi>i</mml:mi>
                                      <mml:mi>j</mml:mi>
                                    </mml:mrow>
                                  </mml:msub>
                                  <mml:msubsup>
                                    <mml:mrow>
                                      <mml:mi>u</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mi>j</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mo class="MathClass-bin">*</mml:mo>
                                      <mml:mo class="MathClass-bin">*</mml:mo>
                                      <mml:mrow>
                                        <mml:mo class="MathClass-open">[</mml:mo>
                                        <mml:mrow>
                                          <mml:mn>1</mml:mn>
                                        </mml:mrow>
                                        <mml:mo class="MathClass-close">]</mml:mo>
                                      </mml:mrow>
                                    </mml:mrow>
                                  </mml:msubsup>
                                </mml:mrow>
                              </mml:msup>
                              <mml:mo class="MathClass-bin">+</mml:mo>
                              <mml:msup>
                                <mml:mrow>
                                  <mml:mi>e</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mo class="MathClass-bin">-</mml:mo>
                                  <mml:msub>
                                    <mml:mrow>
                                      <mml:mover accent="true">
                                        <mml:mrow>
                                          <mml:mi>b</mml:mi>
                                        </mml:mrow>
                                        <mml:mo class="MathClass-op">^</mml:mo>
                                      </mml:mover>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mn>1</mml:mn>
                                    </mml:mrow>
                                  </mml:msub>
                                  <mml:mo class="MathClass-bin">-</mml:mo>
                                  <mml:munderover accentunder="false" accent="false">
                                    <mml:mrow>
                                      <mml:mo mathsize="big">&#x2211;</mml:mo>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mi>j</mml:mi>
                                      <mml:mo class="MathClass-rel">=</mml:mo>
                                      <mml:mn>1</mml:mn>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mi>n</mml:mi>
                                    </mml:mrow>
                                  </mml:munderover>
                                  <mml:msub>
                                    <mml:mrow>
                                      <mml:mi>p</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mi>i</mml:mi>
                                      <mml:mi>j</mml:mi>
                                    </mml:mrow>
                                  </mml:msub>
                                  <mml:msubsup>
                                    <mml:mrow>
                                      <mml:mi>u</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mi>j</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mo class="MathClass-bin">*</mml:mo>
                                      <mml:mo class="MathClass-bin">*</mml:mo>
                                      <mml:mrow>
                                        <mml:mo class="MathClass-open">[</mml:mo>
                                        <mml:mrow>
                                          <mml:mn>1</mml:mn>
                                        </mml:mrow>
                                        <mml:mo class="MathClass-close">]</mml:mo>
                                      </mml:mrow>
                                    </mml:mrow>
                                  </mml:msubsup>
                                </mml:mrow>
                              </mml:msup>
                            </mml:mrow>
                          </mml:mfrac>
                        </mml:mrow>
                      </mml:mfenced>
                      <mml:mo class="MathClass-bin">+</mml:mo>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mspace width="1em" class="quad"/>
                      <mml:mspace width="1em" class="quad"/>
                      <mml:mspace width="1em" class="quad"/>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>&#x109;</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mn>2</mml:mn>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mfenced open="(" close=")">
                        <mml:mrow>
                          <mml:mfrac>
                            <mml:mrow>
                              <mml:msup>
                                <mml:mrow>
                                  <mml:mi>e</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:msub>
                                    <mml:mrow>
                                      <mml:mover accent="true">
                                        <mml:mrow>
                                          <mml:mi>b</mml:mi>
                                        </mml:mrow>
                                        <mml:mo class="MathClass-op">^</mml:mo>
                                      </mml:mover>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mn>2</mml:mn>
                                    </mml:mrow>
                                  </mml:msub>
                                  <mml:mo class="MathClass-bin">+</mml:mo>
                                  <mml:msubsup>
                                    <mml:mrow>
                                      <mml:mi>&#x3A3;</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mi>j</mml:mi>
                                      <mml:mo class="MathClass-rel">=</mml:mo>
                                      <mml:mn>1</mml:mn>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mi>n</mml:mi>
                                    </mml:mrow>
                                  </mml:msubsup>
                                  <mml:msub>
                                    <mml:mrow>
                                      <mml:mi>p</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mi>i</mml:mi>
                                      <mml:mi>j</mml:mi>
                                    </mml:mrow>
                                  </mml:msub>
                                  <mml:msubsup>
                                    <mml:mrow>
                                      <mml:mi>u</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mi>j</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mo class="MathClass-bin">*</mml:mo>
                                      <mml:mo class="MathClass-bin">*</mml:mo>
                                      <mml:mrow>
                                        <mml:mo class="MathClass-open">[</mml:mo>
                                        <mml:mrow>
                                          <mml:mn>2</mml:mn>
                                        </mml:mrow>
                                        <mml:mo class="MathClass-close">]</mml:mo>
                                      </mml:mrow>
                                    </mml:mrow>
                                  </mml:msubsup>
                                </mml:mrow>
                              </mml:msup>
                              <mml:mo class="MathClass-bin">-</mml:mo>
                              <mml:msup>
                                <mml:mrow>
                                  <mml:mi>e</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:msub>
                                    <mml:mrow>
                                      <mml:mover accent="true">
                                        <mml:mrow>
                                          <mml:mi>b</mml:mi>
                                        </mml:mrow>
                                        <mml:mo class="MathClass-op">^</mml:mo>
                                      </mml:mover>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mn>2</mml:mn>
                                    </mml:mrow>
                                  </mml:msub>
                                  <mml:mo class="MathClass-bin">-</mml:mo>
                                  <mml:msubsup>
                                    <mml:mrow>
                                      <mml:mi>&#x3A3;</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mi>j</mml:mi>
                                      <mml:mo class="MathClass-rel">=</mml:mo>
                                      <mml:mn>1</mml:mn>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mi>n</mml:mi>
                                    </mml:mrow>
                                  </mml:msubsup>
                                  <mml:msub>
                                    <mml:mrow>
                                      <mml:mi>p</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mi>i</mml:mi>
                                      <mml:mi>j</mml:mi>
                                    </mml:mrow>
                                  </mml:msub>
                                  <mml:msubsup>
                                    <mml:mrow>
                                      <mml:mi>u</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mi>j</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mo class="MathClass-bin">*</mml:mo>
                                      <mml:mo class="MathClass-bin">*</mml:mo>
                                      <mml:mrow>
                                        <mml:mo class="MathClass-open">[</mml:mo>
                                        <mml:mrow>
                                          <mml:mn>2</mml:mn>
                                        </mml:mrow>
                                        <mml:mo class="MathClass-close">]</mml:mo>
                                      </mml:mrow>
                                    </mml:mrow>
                                  </mml:msubsup>
                                </mml:mrow>
                              </mml:msup>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:msup>
                                <mml:mrow>
                                  <mml:mi>e</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:msub>
                                    <mml:mrow>
                                      <mml:mover accent="true">
                                        <mml:mrow>
                                          <mml:mi>b</mml:mi>
                                        </mml:mrow>
                                        <mml:mo class="MathClass-op">^</mml:mo>
                                      </mml:mover>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mn>2</mml:mn>
                                    </mml:mrow>
                                  </mml:msub>
                                  <mml:mo class="MathClass-bin">+</mml:mo>
                                  <mml:msubsup>
                                    <mml:mrow>
                                      <mml:mi>&#x3A3;</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mi>j</mml:mi>
                                      <mml:mo class="MathClass-rel">=</mml:mo>
                                      <mml:mn>1</mml:mn>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mi>n</mml:mi>
                                    </mml:mrow>
                                  </mml:msubsup>
                                  <mml:msub>
                                    <mml:mrow>
                                      <mml:mi>p</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mi>i</mml:mi>
                                      <mml:mi>j</mml:mi>
                                    </mml:mrow>
                                  </mml:msub>
                                  <mml:msubsup>
                                    <mml:mrow>
                                      <mml:mi>u</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mi>j</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mo class="MathClass-bin">*</mml:mo>
                                      <mml:mo class="MathClass-bin">*</mml:mo>
                                      <mml:mrow>
                                        <mml:mo class="MathClass-open">[</mml:mo>
                                        <mml:mrow>
                                          <mml:mn>2</mml:mn>
                                        </mml:mrow>
                                        <mml:mo class="MathClass-close">]</mml:mo>
                                      </mml:mrow>
                                    </mml:mrow>
                                  </mml:msubsup>
                                </mml:mrow>
                              </mml:msup>
                              <mml:mo class="MathClass-bin">+</mml:mo>
                              <mml:msup>
                                <mml:mrow>
                                  <mml:mi>e</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:msub>
                                    <mml:mrow>
                                      <mml:mover accent="true">
                                        <mml:mrow>
                                          <mml:mi>b</mml:mi>
                                        </mml:mrow>
                                        <mml:mo class="MathClass-op">^</mml:mo>
                                      </mml:mover>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mn>2</mml:mn>
                                    </mml:mrow>
                                  </mml:msub>
                                  <mml:mo class="MathClass-bin">+</mml:mo>
                                  <mml:munderover accentunder="false" accent="false">
                                    <mml:mrow>
                                      <mml:mo mathsize="big">&#x2211;</mml:mo>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mi>j</mml:mi>
                                      <mml:mo class="MathClass-rel">=</mml:mo>
                                      <mml:mn>1</mml:mn>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mi>n</mml:mi>
                                    </mml:mrow>
                                  </mml:munderover>
                                  <mml:msub>
                                    <mml:mrow>
                                      <mml:mi>p</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mi>i</mml:mi>
                                      <mml:mi>j</mml:mi>
                                    </mml:mrow>
                                  </mml:msub>
                                  <mml:msubsup>
                                    <mml:mrow>
                                      <mml:mi>u</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mi>j</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mo class="MathClass-bin">*</mml:mo>
                                      <mml:mo class="MathClass-bin">*</mml:mo>
                                      <mml:mrow>
                                        <mml:mo class="MathClass-open">[</mml:mo>
                                        <mml:mrow>
                                          <mml:mn>2</mml:mn>
                                        </mml:mrow>
                                        <mml:mo class="MathClass-close">]</mml:mo>
                                      </mml:mrow>
                                    </mml:mrow>
                                  </mml:msubsup>
                                </mml:mrow>
                              </mml:msup>
                            </mml:mrow>
                          </mml:mfrac>
                        </mml:mrow>
                      </mml:mfenced>
                      <mml:mspace width="1em" class="quad"/>
                      <mml:mi>i</mml:mi>
                      <mml:mo class="MathClass-rel">=</mml:mo>
                      <mml:mn>1</mml:mn>
                      <mml:mo class="MathClass-punc">,</mml:mo>
                      <mml:mn>2</mml:mn>
                      <mml:mo class="MathClass-punc">,</mml:mo>
                      <mml:mo class="MathClass-op">&#x2026;</mml:mo>
                      <mml:mo class="MathClass-punc">,</mml:mo>
                      <mml:mi>n</mml:mi>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr>
                    <mml:mtd/>
                  </mml:mtr>
                </mml:mtable>
              </mml:mrow>
            </mml:math>
          </disp-formula>
        </p>
        <p>where the <inline-formula><inline-graphic xlink:href="1471-2156-12-87-i35.gif"/></inline-formula> coefficients are the estimated linear regressions of the traits on the activated emissions fired by each of the two neurons.</p>
        <p>MATLAB's neural networks toolbox [<xref ref-type="bibr" rid="B29">29</xref>] was used for fitting the architectures studied, using Bayesian regularization in all cases. As mentioned earlier, two combinations of activation functions were tried: 1) the hyperbolic tangent sigmoid function for activating emissions from each neuron in the hidden layer, plus a linear activation function from the hidden to the output layer, and 2) a linear activation throughout, this corresponding to a linear model with random regression coefficients. To avoid spurious effects caused by starting values in each iterative sequence, the networks were trained 20 times in the Jersey data and 50 times in the wheat data set, for each of the architectures. In Jerseys, each run randomly allocated 60% of the animals to a training set, 20% to a validation set and 20% to a testing set; results reported are the average of the 20 runs for each of the configurations. In wheat, the records were randomly partitioned into a training (480 lines) and a testing (119 lines) set. Each of the 50 random repeats matched exactly those of [<xref ref-type="bibr" rid="B28">28</xref>], to provide a comparison with the predictive ability of the Bayesian Lasso and of support vector regression models used with the wheat data set by [<xref ref-type="bibr" rid="B30">30</xref>].</p>
        <p>The neural networks were fitted to data in the training set, with the &#x3B1; and &#x3B2; parameters, connection strengths and biases modified iteratively. In the Jersey data, as parameters changed in the course of training, the predictive ability of the network was gauged in parallel in the validation set, which was expected to be similar in structure to the testing set, because they were randomly constructed. The same was done with the wheat data, except that there was no "intermediate" validation set. Once the mean squared error of prediction reached an optimal level, training stopped, and this led to the best estimates of the network coefficients. This estimated network was then used for predicting the testing set; predictive correlations (Pearson) and mean-squared errors were evaluated.</p>
        <p>Before processing, MATLAB rescales all input and output variables such that they reside in the [-1, +1] range, to enhance numerical stability; this is done automatically using the "mapminmax" function. To illustrate, consider the vector <bold>x</bold>' = [<xref ref-type="bibr" rid="B3">3</xref>,<xref ref-type="bibr" rid="B6">6</xref>,<xref ref-type="bibr" rid="B4">4</xref>] so that <italic>x</italic><sub>min </sub>= 3 and <italic>x</italic><sub>max </sub>= 6. If values are to range between <italic>A</italic><sub>min </sub>= -1 and <italic>A</italic><sub>max </sub>= +1, one sets temporarily <bold>x<sub>temp</sub></bold>' = [-1,1,4], so only <italic>x<sub>3 </sub>= </italic>4 needs to be rescaled. This is done via the formula</p>
        <p>
          <disp-formula>
            <mml:math id="M37" name="1471-2156-12-87-i36" overflow="scroll">
              <mml:mrow>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>x</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mn>3</mml:mn>
                    <mml:mo class="MathClass-punc">,</mml:mo>
                    <mml:mi>n</mml:mi>
                    <mml:mi>e</mml:mi>
                    <mml:mi>w</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo class="MathClass-rel">=</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>A</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mo class="qopname">min</mml:mo>
                  </mml:mrow>
                </mml:msub>
                <mml:mo class="MathClass-bin">+</mml:mo>
                <mml:mfrac>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>x</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mn>3</mml:mn>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo class="MathClass-bin">-</mml:mo>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>x</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mo class="qopname">min</mml:mo>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>x</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mo class="qopname">max</mml:mo>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo class="MathClass-bin">-</mml:mo>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>x</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mo class="qopname">min</mml:mo>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                </mml:mfrac>
                <mml:mrow>
                  <mml:mo class="MathClass-open">(</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>A</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mo class="qopname">max</mml:mo>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo class="MathClass-bin">-</mml:mo>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>A</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mo class="qopname">min</mml:mo>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo class="MathClass-close">)</mml:mo>
                </mml:mrow>
                <mml:mo class="MathClass-rel">=</mml:mo>
                <mml:mo class="MathClass-bin">-</mml:mo>
                <mml:mn>1</mml:mn>
                <mml:mo class="MathClass-bin">+</mml:mo>
                <mml:mfrac>
                  <mml:mrow>
                    <mml:mn>4</mml:mn>
                    <mml:mo class="MathClass-bin">-</mml:mo>
                    <mml:mn>3</mml:mn>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mn>6</mml:mn>
                    <mml:mo class="MathClass-bin">-</mml:mo>
                    <mml:mn>3</mml:mn>
                  </mml:mrow>
                </mml:mfrac>
                <mml:mn>2</mml:mn>
                <mml:mo class="MathClass-rel">=</mml:mo>
                <mml:mo class="MathClass-bin">-</mml:mo>
                <mml:mfrac>
                  <mml:mrow>
                    <mml:mn>1</mml:mn>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mn>3</mml:mn>
                  </mml:mrow>
                </mml:mfrac>
                <mml:mo class="MathClass-punc">.</mml:mo>
              </mml:mrow>
            </mml:math>
          </disp-formula>
        </p>
        <p>MATLAB uses the Levenberg-Marquardt algorithm (based on linearization) for computing the posterior modes in Bayesian regularization, and back-propagation is employed to minimize the penalized residual sum of squares. The maximum number of iterations (called epochs) in back-propagation was set to 1000, and iteration stopped earlier if the gradient of the objective function was below a suitable level or when there were obvious problems with the algorithm [<xref ref-type="bibr" rid="B28">28</xref>,<xref ref-type="bibr" rid="B29">29</xref>,<xref ref-type="bibr" rid="B31">31</xref>]. Each of these settings corresponds to the default values provided by MATLAB.</p>
        <sec>
          <title>Jersey cows data</title>
          <p>Because of the high-dimensionality of the genotypic data, the neural networks used either additive or genome-derived relationships among cows as inputs (instead of SNP genotype codes), to make computations feasible in MATLAB. The rationale for this is based on the representation of the infinitesimal model as a regression on a pedigree, or as a regression on a matrix that is proportional to genomic relationships, as argued by [<xref ref-type="bibr" rid="B2">2</xref>] in the context of reproducing kernel Hilbert spaces regression. The neural networks had the form</p>
          <p>
            <disp-formula id="bmcM8">
              <label>(8)</label>
              <mml:math id="M38" name="1471-2156-12-87-i37" overflow="scroll">
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>t</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mstyle class="text">
                        <mml:mtext class="textsf" mathvariant="sans-serif">i</mml:mtext>
                      </mml:mstyle>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo class="MathClass-rel">=</mml:mo>
                  <mml:mi>b</mml:mi>
                  <mml:mo class="MathClass-bin">+</mml:mo>
                  <mml:mi>c</mml:mi>
                  <mml:mi>g</mml:mi>
                  <mml:mrow>
                    <mml:mo class="MathClass-open">[</mml:mo>
                    <mml:mrow>
                      <mml:munderover accentunder="false" accent="false">
                        <mml:mrow>
                          <mml:mo mathsize="big">&#x2211;</mml:mo>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>k</mml:mi>
                          <mml:mo class="MathClass-rel">=</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>s</mml:mi>
                        </mml:mrow>
                      </mml:munderover>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>w</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>k</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>g</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>k</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mrow>
                        <mml:mo class="MathClass-open">(</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>b</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>k</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                          <mml:mo class="MathClass-bin">+</mml:mo>
                          <mml:msubsup>
                            <mml:mrow>
                              <mml:mo mathsize="big"> &#x2211;</mml:mo>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>j</mml:mi>
                              <mml:mo class="MathClass-rel">=</mml:mo>
                              <mml:mn>1</mml:mn>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>n</mml:mi>
                            </mml:mrow>
                          </mml:msubsup>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>p</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>i</mml:mi>
                              <mml:mi>j</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                          <mml:msubsup>
                            <mml:mrow>
                              <mml:mi>u</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>j</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mo class="MathClass-bin">*</mml:mo>
                              <mml:mo class="MathClass-bin">*</mml:mo>
                              <mml:mrow>
                                <mml:mo class="MathClass-open">[</mml:mo>
                                <mml:mrow>
                                  <mml:mi>k</mml:mi>
                                </mml:mrow>
                                <mml:mo class="MathClass-close">]</mml:mo>
                              </mml:mrow>
                            </mml:mrow>
                          </mml:msubsup>
                        </mml:mrow>
                        <mml:mo class="MathClass-close">)</mml:mo>
                      </mml:mrow>
                      <mml:mo class="MathClass-bin">+</mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>e</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo class="MathClass-punc">,</mml:mo>
                      <mml:mspace width="1em" class="quad"/>
                      <mml:mi>i</mml:mi>
                      <mml:mo class="MathClass-rel">=</mml:mo>
                      <mml:mn>1</mml:mn>
                      <mml:mo class="MathClass-punc">,</mml:mo>
                      <mml:mn>2</mml:mn>
                      <mml:mo class="MathClass-punc">,</mml:mo>
                      <mml:mo>&#x2026;</mml:mo>
                      <mml:mo class="MathClass-punc">,</mml:mo>
                      <mml:mi>n</mml:mi>
                    </mml:mrow>
                  </mml:mrow>
                </mml:mrow>
              </mml:math>
            </disp-formula>
          </p>
          <p>where <italic>p<sub>ij </sub>= a<sub>ij </sub></italic>(additive relationship between cows <italic>i </italic>and <italic>j</italic>) or <italic>g<sub>ij </sub></italic>(genome-derived relationships). Thus, for each cow the input vector <italic><bold>p</bold><sub>i </sub></italic>had order 297 &#xD7; 1.</p>
          <p>The expected additive genetic relationship matrix, <bold>A </bold>= {<italic>a<sub>ij</sub></italic>}, was developed from the pedigree information; this is a standard metric for degree of kinship used in quantitative genetics. A realized genomic relationship matrix, <bold>G </bold>= {<italic>g<sub>ij</sub></italic>}, was constructed from the marker data following [<xref ref-type="bibr" rid="B18">18</xref>], and calculated as follows: 1) estimate marker allelic frequencies and let <italic>&#x3BC;<sub>i </sub></italic>be the estimated frequency of allele "A" at locus <italic>i</italic>. 2) Construct a 297 &#xD7; 35,798 matrix of marker genotype codes <bold>M</bold>, with typical element <italic>m<sub>ij </sub></italic>corresponding to the genotype of individual <italic>i </italic>for marker <italic>j</italic>. 3) Calculate the expected frequency of <italic>m<sub>ij </sub></italic>under Hardy-Weiberg equilibrium from the estimates of the allelic frequencies, and form the 297 &#xD7; 35,798 matrix of expectations <bold>E</bold>. 4) Form the estimated genomic relationship matrix (assuming linkage equilibrium among markers) as</p>
          <p>
            <disp-formula>
              <mml:math id="M39" name="1471-2156-12-87-i38" overflow="scroll">
                <mml:mrow>
                  <mml:mstyle mathvariant="bold">
                    <mml:mi>G</mml:mi>
                  </mml:mstyle>
                  <mml:mo class="MathClass-rel">=</mml:mo>
                  <mml:mfrac>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mo class="MathClass-open">(</mml:mo>
                        <mml:mrow>
                          <mml:mstyle mathvariant="bold">
                            <mml:mi>M</mml:mi>
                          </mml:mstyle>
                          <mml:mo class="MathClass-bin">-</mml:mo>
                          <mml:mstyle mathvariant="bold">
                            <mml:mi>E</mml:mi>
                          </mml:mstyle>
                        </mml:mrow>
                        <mml:mo class="MathClass-close">)</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mo class="MathClass-open">(</mml:mo>
                        <mml:mrow>
                          <mml:mstyle mathvariant="bold">
                            <mml:mi>M</mml:mi>
                          </mml:mstyle>
                          <mml:mo class="MathClass-bin">-</mml:mo>
                          <mml:mstyle mathvariant="bold">
                            <mml:mi>E</mml:mi>
                          </mml:mstyle>
                        </mml:mrow>
                        <mml:mo class="MathClass-close">)</mml:mo>
                      </mml:mrow>
                      <mml:mstyle class="text">
                        <mml:mtext class="textsf" mathvariant="sans-serif">&#x2019;</mml:mtext>
                      </mml:mstyle>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mn>2</mml:mn>
                      <mml:munderover accentunder="false" accent="false">
                        <mml:mrow>
                          <mml:mo mathsize="big">&#x2211;</mml:mo>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>l</mml:mi>
                          <mml:mo class="MathClass-rel">=</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mn>35</mml:mn>
                          <mml:mo class="MathClass-punc">,</mml:mo>
                          <mml:mn>798</mml:mn>
                        </mml:mrow>
                      </mml:munderover>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>&#x3BC;</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mrow>
                        <mml:mo class="MathClass-open">(</mml:mo>
                        <mml:mrow>
                          <mml:mn>1</mml:mn>
                          <mml:mo class="MathClass-bin">-</mml:mo>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>&#x3BC;</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>i</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mo class="MathClass-close">)</mml:mo>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:mfrac>
                  <mml:mo class="MathClass-rel">=</mml:mo>
                  <mml:mrow>
                    <mml:mo class="MathClass-open">{</mml:mo>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>g</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                          <mml:mi>j</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                    </mml:mrow>
                    <mml:mo class="MathClass-close">}</mml:mo>
                  </mml:mrow>
                  <mml:mo class="MathClass-punc">.</mml:mo>
                </mml:mrow>
              </mml:math>
            </disp-formula>
          </p>
          <p>The matrix <bold>Z = M-E </bold>contains "centered" codes, such that the mean of the values in any of its columns is null; <bold>Z </bold>can be used as in incidence matrix in marker assisted regression models [<xref ref-type="bibr" rid="B17">17</xref>,<xref ref-type="bibr" rid="B32">32</xref>,<xref ref-type="bibr" rid="B33">33</xref>]. Then <inline-formula><mml:math id="M40" name="1471-2156-12-87-i39" overflow="scroll"><mml:mstyle mathvariant="bold"><mml:mi>Z</mml:mi><mml:msup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>&#x2032;</mml:mi></mml:mrow></mml:msup></mml:mstyle><mml:mo class="MathClass-rel">=</mml:mo><mml:mstyle mathvariant="bold"><mml:mi>G</mml:mi></mml:mstyle><mml:mo class="MathClass-bin">&#xD7;</mml:mo><mml:mn>2</mml:mn><mml:munderover accentunder="false" accent="false"><mml:mrow><mml:mo class="MathClass-op">&#x2211;</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo class="MathClass-rel">=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>35</mml:mn><mml:mo class="MathClass-punc">,</mml:mo><mml:mn>798</mml:mn></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>&#x3BC;</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo class="MathClass-open">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo class="MathClass-bin">-</mml:mo><mml:msub><mml:mrow><mml:mi>&#x3BC;</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo class="MathClass-close">)</mml:mo></mml:mrow></mml:math></inline-formula> is interpretable as a covariance matrix, analogous to <inline-formula><mml:math id="M41" name="1471-2156-12-87-i40" overflow="scroll"><mml:mstyle mathvariant="bold"><mml:mi>A</mml:mi></mml:mstyle><mml:msubsup><mml:mrow><mml:mi>&#x3C3;</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math></inline-formula> in the infinitesimal model. The term <inline-formula><mml:math id="M42" name="1471-2156-12-87-i41" overflow="scroll"><mml:mn>2</mml:mn><mml:munderover accentunder="false" accent="false"><mml:mrow><mml:mo class="MathClass-op">&#x2211;</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo class="MathClass-rel">=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>35</mml:mn><mml:mo class="MathClass-punc">,</mml:mo><mml:mn>798</mml:mn></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>&#x3BC;</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo class="MathClass-open">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo class="MathClass-bin">-</mml:mo><mml:msub><mml:mrow><mml:mi>&#x3BC;</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo class="MathClass-close">)</mml:mo></mml:mrow></mml:math></inline-formula> holds under linkage equilibrium only, and cannot be construed as additive genetic variance of marker effects in the classical sense of [<xref ref-type="bibr" rid="B33">33</xref>]; its relationship to additive genetic variance in a finite locus or infinitesimal model is tenuous [<xref ref-type="bibr" rid="B16">16</xref>,<xref ref-type="bibr" rid="B34">34</xref>].</p>
        </sec>
        <sec>
          <title>Wheat lines data</title>
          <p>There were 599 wheat lines, each genotyped with 1279 DArT markers (Diversity Array Technology) generated by Triticarte Pty. Ltd. (Canberra, Australia; <ext-link ext-link-type="uri" xlink:href="http://www.triticarte.com.au">http://www.triticarte.com.au</ext-link>). The DArT markers may take on two values, denoted by their presence or absence. In this data set, the overall mean frequency of the allele coded as "1" was 0.5607, with a minimum of 0.0083 and a maximum of 0.9866. Markers with a minor allele frequency lower than 0.05 were removed. Missing genotypes at locus <italic>j </italic>of line <italic>i </italic>were imputed using samples from the marginal distribution of marker genotypes, that is, <inline-formula><mml:math id="M43" name="1471-2156-12-87-i42" overflow="scroll"><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo class="MathClass-rel">~</mml:mo><mml:mi>B</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>n</mml:mi><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:mi>l</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mfenced open="(" close=")"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mo class="MathClass-op">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math></inline-formula>, where <inline-formula><mml:math id="M44" name="1471-2156-12-87-i43" overflow="scroll"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mo class="MathClass-op">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the estimated allele frequency computed from the non-missing genotypes [<xref ref-type="bibr" rid="B34">34</xref>]. The phenotype studied was average grain yield of each line. The data came from the International Maize and Wheat improvement Center, Mexico, and it can be downloaded from R package BLR <ext-link ext-link-type="uri" xlink:href="http://cran.r-project.org/web/packages/BLR/index.html">http://cran.r-project.org/web/packages/BLR/index.html</ext-link>; more information can be found in [<xref ref-type="bibr" rid="B30">30</xref>,<xref ref-type="bibr" rid="B35">35</xref>,<xref ref-type="bibr" rid="B36">36</xref>]. The wheat data was partitioned randomly into a training set (480 lines) and a test set (119 lines), exactly as in [<xref ref-type="bibr" rid="B30">30</xref>].</p>
        </sec>
      </sec>
    </sec>
    <sec sec-type="results">
      <title>Results</title>
      <sec>
        <title>Degree of complexity</title>
        <p>The effective number of parameters (&#x3B3;) associated with each of the networks examined in the Jersey data is presented in Table <xref ref-type="table" rid="T1">1</xref> and shown graphically in Figure <xref ref-type="fig" rid="F2">2</xref>, by trait and type of input considered, i.e., additive or genomic relationships. Clearly, use of genomic relationships resulted in a larger number of effective parameters than use of pedigree, for all traits and architectures. When using pedigree relationships, the average (over runs, but note the large standard errors) effective number of parameters ranged from 91 (fat yield, one-neuron model with non-linear activation), to 136 (protein yield, 6 neurons). This illustrates the impact of shrinkage, and of how regularized neural networks cope with the "curse of dimensionality. For example, a 6-neuron network has close to 1800 nominal parameters. Likewise, when using genomic relationships as inputs, the average effective number of parameters ranged from 127 to 166 (fat yield). Similar results were obtained in the wheat data (Table <xref ref-type="table" rid="T2">2</xref>). The effective number of parameters ranged from 220 (nonlinear ANN with 4 neurons) to 299 (linear ANN).</p>
        <table-wrap id="T1" position="float">
          <label>Table 1</label>
          <caption>
            <p>Effective number of parameters (&#xB1; standard errors), by trait, in Jerseys.<sup>1</sup></p>
          </caption>
          <table frame="hsides" rules="groups">
            <thead>
              <tr>
                <th align="center">Network</th>
                <th align="left">Fat yield<break/>(pedigree)</th>
                <th align="left">Fat yield<break/>(genomic)</th>
                <th align="left">Milk yield<break/>(pedigree)</th>
                <th align="left">Milk yield<break/>(genomic)</th>
                <th align="left">Protein yield<break/>(pedigree)</th>
                <th align="left">Protein yield<break/>(genomic)</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="center">Linear</td>
                <td align="left">123 &#xB1; 5.6</td>
                <td align="left">166 &#xB1; 2.0</td>
                <td align="left">124 &#xB1; 7.6</td>
                <td align="left">162 &#xB1; 2.9</td>
                <td align="left">118 &#xB1; 8.5</td>
                <td align="left">151 &#xB1; 4.5</td>
              </tr>
              <tr>
                <td align="center">1 neuron</td>
                <td align="left">91 &#xB1; 4.9</td>
                <td align="left">142 &#xB1; 2.0</td>
                <td align="left">93 &#xB1; 5.8</td>
                <td align="left">166 &#xB1; 2.0</td>
                <td align="left">91 &#xB1; 10.3</td>
                <td align="left">144 &#xB1; 2.5</td>
              </tr>
              <tr>
                <td align="center">2 neurons</td>
                <td align="left">104 &#xB1; 5.8</td>
                <td align="left">128 &#xB1; 7.6</td>
                <td align="left">122 &#xB1; 6.5</td>
                <td align="left">145 &#xB1; 7.8</td>
                <td align="left">114 &#xB1; 8.0</td>
                <td align="left">136 &#xB1; 8.0</td>
              </tr>
              <tr>
                <td align="center">3 neurons</td>
                <td align="left">107 &#xB1; 5.8</td>
                <td align="left">132 &#xB1; 5.7</td>
                <td align="left">123 &#xB1; 5.1</td>
                <td align="left">129 &#xB1; 6.0</td>
                <td align="left">126 &#xB1; 6.9</td>
                <td align="left">141 &#xB1; 4.9</td>
              </tr>
              <tr>
                <td align="center">4 neurons</td>
                <td align="left">108 &#xB1; 5.8</td>
                <td align="left">129 &#xB1; 4.7</td>
                <td align="left">112 &#xB1; 4.7</td>
                <td align="left">131 &#xB1; 5.8</td>
                <td align="left">129 &#xB1; 5.4</td>
                <td align="left">138 &#xB1; 6.0</td>
              </tr>
              <tr>
                <td align="center">5 neurons</td>
                <td align="left">106 &#xB1; 4.9</td>
                <td align="left">127 &#xB1; 4.9</td>
                <td align="left">118 &#xB1; 4.8</td>
                <td align="left">132 &#xB1; 5.4</td>
                <td align="left">131 &#xB1; 4.9</td>
                <td align="left">138 &#xB1; 5.6</td>
              </tr>
              <tr>
                <td align="center">6 neurons</td>
                <td align="left">114 &#xB1; 3.3</td>
                <td align="left">128 &#xB1; 7.5</td>
                <td align="left">122 &#xB1; 5.1</td>
                <td align="left">132 &#xB1; 5.6</td>
                <td align="left">136 &#xB1; 4.6</td>
                <td align="left">137 &#xB1; 5.0</td>
              </tr>
            </tbody>
          </table>
          <table-wrap-foot>
            <p><sup>1 </sup>Results are averages of 20 runs based on random partitions of the data</p>
          </table-wrap-foot>
        </table-wrap>
        <fig id="F2" position="float">
          <label>Figure 2</label>
          <caption>
            <p><bold>Effective number of parameters obtained from different network architectures in the Jersey data</bold>. Results shown are averages of 20 independent runs. "Linear" denotes a 1-neuron model with linear activation functions throughout.</p>
          </caption>
          <graphic xlink:href="1471-2156-12-87-2"/>
        </fig>
        <table-wrap id="T2" position="float">
          <label>Table 2</label>
          <caption>
            <p>Effective number of parameters, predictive correlations, and mean squared errors of prediction: wheat.<sup>1</sup></p>
          </caption>
          <table frame="hsides" rules="groups">
            <thead>
              <tr>
                <th align="left">ANN architectures</th>
                <th align="left">Linear</th>
                <th align="left">1 neuron</th>
                <th align="left">2 neurons</th>
                <th align="left">3 neurons</th>
                <th align="left">4 neurons</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left">Criterion</td>
                <td/>
                <td/>
                <td/>
                <td/>
                <td/>
              </tr>
              <tr>
                <td colspan="6">
                  <hr/>
                </td>
              </tr>
              <tr>
                <td align="left">Effective number of parameters</td>
                <td align="left">299 &#xB1; 5.5</td>
                <td align="left">260 &#xB1; 6.1</td>
                <td align="left">253 &#xB1; 5.9</td>
                <td align="left">238 &#xB1; 5.5</td>
                <td align="left">220 &#xB1; 2.8</td>
              </tr>
              <tr>
                <td align="left">Correlations in testing set</td>
                <td align="left">0.48 &#xB1; 0.03</td>
                <td align="left">0.54 &#xB1; 0.03</td>
                <td align="left">056 &#xB1; 0.02</td>
                <td align="left">0.57 &#xB1; 0.02</td>
                <td align="left">0.59 &#xB1; 0.02</td>
              </tr>
              <tr>
                <td align="left">Mean squared error in testing set</td>
                <td align="left">0.99 &#xB1; 0.04</td>
                <td align="left">0.77 &#xB1; 0.03</td>
                <td align="left">0.74 &#xB1; 0.03</td>
                <td align="left">0.71 &#xB1; 0.02</td>
                <td align="left">0.72 &#xB1; 0.02</td>
              </tr>
            </tbody>
          </table>
          <table-wrap-foot>
            <p><sup>1 </sup>The training-test partitions for this data were random and repeated 50 times; standard errors in parentheses</p>
          </table-wrap-foot>
        </table-wrap>
        <p>The effective number of parameters behaved differentially with respect to model architecture and this depended on the input variables used. When using pedigrees in the Jersey data, the hyperbolic tangent activation function in the 1-neuron model reduced &#x3B3; drastically, relative to the linear model (1 neuron with linear activation throughout). Then, an increment in number of neurons from 2 to 6 increased model complexity relative to that of the 1 neuron model with non-linear activation, but not beyond that attained with the linear model, save for protein yield. For this trait, &#x3B3; was 118 for the linear model, and ranged from 126 to 136 in models with 3 through 6 neurons. When genomic relationships were used as inputs, &#x3B3; was largest for the linear model for fat and protein yield, and for the 1-neuron model with a non-linear activation function in the case of milk yield. In wheat, the effective number of parameters decreased as architectures became more complex. There was large variation among runs in effective number of parameters for both data sets, but there was not a clear pattern in the variability.</p>
      </sec>
      <sec>
        <title>Predictive performance</title>
        <p>Results pertaining to predictive ability evaluated in the testing sets are shown in Table <xref ref-type="table" rid="T2">2</xref> for wheat and Tables <xref ref-type="table" rid="T3">3</xref> and <xref ref-type="table" rid="T4">4</xref> for the Jersey data. Figures <xref ref-type="fig" rid="F3">3</xref> and <xref ref-type="fig" rid="F4">4</xref> depict mean of squared errors of prediction and correlations coefficients in the Jersey cows.</p>
        <table-wrap id="T3" position="float">
          <label>Table 3</label>
          <caption>
            <p>Prediction mean squared errors (&#xB1; standard errors) by trait: Jerseys.<sup>1</sup></p>
          </caption>
          <table frame="hsides" rules="groups">
            <thead>
              <tr>
                <th align="left">Network</th>
                <th align="left">Fat yield (pedigree)</th>
                <th align="left">Fat yield (genomic)</th>
                <th align="left">Milk yield (pedigree)</th>
                <th align="left">Milk yield (genomic)</th>
                <th align="left">Protein yield (pedigree)</th>
                <th align="left">Protein yield (genomic)</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left">Linear</td>
                <td align="left">1.19 &#xB1; 0.07</td>
                <td align="left">0.86 &#xB1; 0.05</td>
                <td align="left">1.09 &#xB1; 0.05</td>
                <td align="left">0.88 &#xB1; 0.04</td>
                <td align="left">1.00 &#xB1; 0.04</td>
                <td align="left">0.75 &#xB1; 0.07</td>
              </tr>
              <tr>
                <td align="left">1 neuron</td>
                <td align="left">1.01 &#xB1; 0.04</td>
                <td align="left">0.74 &#xB1; 0.03</td>
                <td align="left">0.99 &#xB1; 0.04</td>
                <td align="left">0.81 &#xB1; 0.03</td>
                <td align="left">0.97 &#xB1; 0.04</td>
                <td align="left">0.71 &#xB1; 0.04</td>
              </tr>
              <tr>
                <td align="left">2 neurons</td>
                <td align="left">0.93 &#xB1; 0.05</td>
                <td align="left">0.70 &#xB1; 0.03</td>
                <td align="left">0.96 &#xB1; 0.05</td>
                <td align="left">0.76 &#xB1; 0.04</td>
                <td align="left">1.02 &#xB1; 0.04</td>
                <td align="left">0.72 &#xB1; 0.04</td>
              </tr>
              <tr>
                <td align="left">3 neurons</td>
                <td align="left">0.92 &#xB1; 0.04</td>
                <td align="left">0.71 &#xB1; 0.03</td>
                <td align="left">0.98 &#xB1; 0.02</td>
                <td align="left">0.78 &#xB1; 0.04</td>
                <td align="left">0.96 &#xB1; 0.06</td>
                <td align="left">0.80 &#xB1; 0.04</td>
              </tr>
              <tr>
                <td align="left">4 neurons</td>
                <td align="left">0.99 &#xB1; 0.04</td>
                <td align="left">0.84 &#xB1; 0.04</td>
                <td align="left">0.98 &#xB1; 0.04</td>
                <td align="left">0.72 &#xB1; 0.04</td>
                <td align="left">0.90 &#xB1; 0.06</td>
                <td align="left">0.70 &#xB1; 0.03</td>
              </tr>
              <tr>
                <td align="left">5 neurons</td>
                <td align="left">0.99 &#xB1; 0.04</td>
                <td align="left">0.86 &#xB1; 0.04</td>
                <td align="left">1.00 &#xB1; 0.05</td>
                <td align="left">0.80 &#xB1; 0.04</td>
                <td align="left">0.93 &#xB1; 0.04</td>
                <td align="left">0.77 &#xB1; 0.04</td>
              </tr>
              <tr>
                <td align="left">6 neurons</td>
                <td align="left">0.95 &#xB1; 0.03</td>
                <td align="left">0.77 &#xB1; 0.04</td>
                <td align="left">1.02 &#xB1; 0.05</td>
                <td align="left">0.79 &#xB1; 0.03</td>
                <td align="left">0.95 &#xB1; 0.03</td>
                <td align="left">0.76 &#xB1; 0.05</td>
              </tr>
            </tbody>
          </table>
          <table-wrap-foot>
            <p><sup>1</sup>Results are the average of 20 runs based on random partitions on the data</p>
          </table-wrap-foot>
        </table-wrap>
        <table-wrap id="T4" position="float">
          <label>Table 4</label>
          <caption>
            <p>Correlation coefficients (&#xB1; standard errors) in the Jersey testing data set, by trait.<sup>1</sup></p>
          </caption>
          <table frame="hsides" rules="groups">
            <thead>
              <tr>
                <th/>
                <th align="center" colspan="3">Pedigree relationships</th>
                <th align="center" colspan="3">Genomic relationships</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left">
                  <bold>Network</bold>
                </td>
                <td align="left">
                  <bold>Fat yield</bold>
                </td>
                <td align="left">
                  <bold>Milk yield</bold>
                </td>
                <td align="left">
                  <bold>Protein yield</bold>
                </td>
                <td align="left">
                  <bold>Fat yield</bold>
                </td>
                <td align="left">
                  <bold>Milk yield</bold>
                </td>
                <td align="left">
                  <bold>Protein yield</bold>
                </td>
              </tr>
              <tr>
                <td colspan="7">
                  <hr/>
                </td>
              </tr>
              <tr>
                <td align="left">Linear</td>
                <td align="left">0.11 &#xB1; 0.04</td>
                <td align="left">0.07 &#xB1; 0.03</td>
                <td align="left">0.02 &#xB1; 0.02</td>
                <td align="left">0.43 &#xB1; 0.02</td>
                <td align="left">0.42 &#xB1; 0.03</td>
                <td align="left">0.44 &#xB1; 0.02</td>
              </tr>
              <tr>
                <td align="left">1 neuron</td>
                <td align="left">0.23 &#xB1; 0.03</td>
                <td align="left">0.10 &#xB1; 0.03</td>
                <td align="left">0.09 &#xB1; 0.02</td>
                <td align="left">0.51 &#xB1; 0.02</td>
                <td align="left">0.45 &#xB1; 0.02</td>
                <td align="left">0.44 &#xB1; 0.02</td>
              </tr>
              <tr>
                <td align="left">2 neurons</td>
                <td align="left">0.22 &#xB1; 0.03</td>
                <td align="left">0.08 &#xB1; 0.01</td>
                <td align="left">0.08 &#xB1; 0.03</td>
                <td align="left">0.49 &#xB1; 0.02</td>
                <td align="left">0.46 &#xB1; 0.03</td>
                <td align="left">0.51 &#xB1; 0.02</td>
              </tr>
              <tr>
                <td align="left">3 neurons</td>
                <td align="left">0.22 &#xB1; 0.02</td>
                <td align="left">0.13 &#xB1; 0.02</td>
                <td align="left">0.10 &#xB1; 0.03</td>
                <td align="left">0.53 &#xB1; 0.02</td>
                <td align="left">0.52 &#xB1; 0.02</td>
                <td align="left">0.47 &#xB1; 0.02</td>
              </tr>
              <tr>
                <td align="left">4 neurons</td>
                <td align="left">0.20 &#xB1; 0.02</td>
                <td align="left">0.09 &#xB1; 0.02</td>
                <td align="left">0.14 &#xB1; 0.02</td>
                <td align="left">0.45 &#xB1; 0.03</td>
                <td align="left">0.52 &#xB1; 0.02</td>
                <td align="left">0.47 &#xB1; 0.03</td>
              </tr>
              <tr>
                <td align="left">5 neurons</td>
                <td align="left">0.23 &#xB1; 0.02</td>
                <td align="left">0.13 &#xB1; 0.02</td>
                <td align="left">0.15 &#xB1; 0.02</td>
                <td align="left">0.42 &#xB1; 0.03</td>
                <td align="left">0.50 &#xB1; 0.02</td>
                <td align="left">0.47 &#xB1; 0.02</td>
              </tr>
              <tr>
                <td align="left">6 neurons</td>
                <td align="left">0.27 &#xB1; 0.02</td>
                <td align="left">0.10 &#xB1; 0.03</td>
                <td align="left">0.11 &#xB1; 0.02</td>
                <td align="left">0.48 &#xB1; 0.04</td>
                <td align="left">0.54 &#xB1; 0.02</td>
                <td align="left">0.50 &#xB1; 0.03</td>
              </tr>
            </tbody>
          </table>
          <table-wrap-foot>
            <p><sup>1</sup>Results are the average of 20 runs based on random partitions on the data</p>
          </table-wrap-foot>
        </table-wrap>
        <fig id="F3" position="float">
          <label>Figure 3</label>
          <caption>
            <p><bold>Prediction mean squared errors in the Jersey testing set (vertical axis) by network</bold>. Results are averages of 20 independent runs. "Linear" denotes a 1-neuron model with linear activation functions throughout.</p>
          </caption>
          <graphic xlink:href="1471-2156-12-87-3"/>
        </fig>
        <fig id="F4" position="float">
          <label>Figure 4</label>
          <caption>
            <p><bold>Correlations between predictions and observations in the Jersey testing data set for the network considered</bold>. Results shown are averages of 20 independent runs. "Linear" denotes a 1-neuron model with linear activation functions throughout.</p>
          </caption>
          <graphic xlink:href="1471-2156-12-87-4"/>
        </fig>
        <p>The predictive correlations in wheat (Table <xref ref-type="table" rid="T2">2</xref>) ranged from 0.48 with the linear ANN (equivalent to Bayesian ridge regression) to 0.59 for the nonlinear ANN with 4 neurons. Clear and significant differences between linear and nonlinear architectures were observed. The improvements over the linear ANN were 11.2, 14.3, 15.8 and 18.6% in predictive correlation for 1, 2, 3 and 4 neurons in the hidden layer, respectively. Mean squared errors were also 23-29% smaller than in the linear ANN.</p>
        <p>In the Jerseys, the large variability in mean squared error among runs (Table <xref ref-type="table" rid="T3">3</xref>) precludes making strong statements about differences among architectures. However, predictive correlations (Table <xref ref-type="table" rid="T4">4</xref>) were clearly larger for the non-linear ANN. For fat yield, the results with pedigrees employed as input suggest that a non-linear, adaptive use of additive relationships (as done in all networks with the hyperbolic tangent activation function) can improve predictive performance beyond that of the infinitesimal model. Further, use of genomic relationships led to more reliable prediction of phenotypes than use of pedigree information as measured by the predictive correlations in Table <xref ref-type="table" rid="T4">4</xref>. The relative increase in strength of association, as measured by the correlation, is much larger than the ones that have been reported, e.g., in dairy cattle [<xref ref-type="bibr" rid="B32">32</xref>,<xref ref-type="bibr" rid="B37">37</xref>], when prediction of breeding values of bulls was made from genomic information, as opposed to from pedigrees. Our result is encouraging and suggests that genomic data may also play an important role in prediction of individual outcomes (as opposed to breeding value), an issue of relevance in medicine [<xref ref-type="bibr" rid="B4">4</xref>].</p>
      </sec>
      <sec>
        <title>Shrinkage</title>
        <p>The distribution of connection strengths in a network gives an indication of the extent of regularization attained. Typically, weight values decrease with model complexity, in the same manner that estimates of marker effects become smaller in Bayesian regression models when <italic>p </italic>increases and training sample size is kept constant. Further, the distribution of weights is often linked to predictive ability; small values tend to lead to better generalization. Figure <xref ref-type="fig" rid="F5">5</xref> depicts the distributions of weights for the linear models and for the nonlinear regularized networks that produced the largest predictive correlations for pedigree and genomic relationships in the Jersey data. The weights for the linear model were larger and more variable than for the nonlinear networks, where distributions were patently leptokurtic, indicating strong shrinkage towards 0. For example, the average (over runs) sum of squares of weights for the linear model and for the non-linear network with 6 neurons when using genomic relationships as predictors of milk yield were 7.5 and 8.5, respectively; however, the 7.5 for the linear model was the sum of squares of 297 weights whereas the 8.5 for the nonlinear model with 6 neurons was the sum of squares of 1782 weights (6 &#xD7; 297). The same picture was observed in the wheat data (results are not reported).</p>
        <fig id="F5" position="float">
          <label>Figure 5</label>
          <caption>
            <p><bold>Distribution of connection strengths(<italic>w<sub>kj</sub></italic>) in the linear and selected networks fitted to the Jersey data</bold>. The linear model has single neuron architecture with linear activation functions. a) Fat yield using pedigree relationships: linear model (above) and 6 neurons (below). b) Milk yield using pedigree relationships: linear model (above) and 6 neurons (below). c) Protein yield using pedigree relationships: linear model (above) and 5 neurons (below). d) Fat yield using genomic relationships: linear model (above) and 3 neurons (below), e) Milk yield using genomic relationships: linear model (above) and (below) and 6 neurons (below). f) Protein yield using genomic relationships: linear model (above) and 2 neurons (below).</p>
          </caption>
          <graphic xlink:href="1471-2156-12-87-5"/>
        </fig>
      </sec>
    </sec>
    <sec sec-type="discussion">
      <title>Discussion</title>
      <p>Models for prediction of fat, milk and protein yield in cows using pedigree and genomic relationship information as inputs, and wheat yield using molecular markers as predictor variables were studied. This was done using Bayesian regularized neural networks, and predictions were benchmarked against those from a linear neural network, which is a Bayesian ridge regression model. In the wheat data, the comparison was supplemented with results obtained by our group using RKHS or support vector methods. Different network architectures were explored by varying the number of neurons, and using a hyperbolic tangent sigmoid activation function in the hidden layer plus a linear activation function in the output layer. This combination has been shown to work well when extrapolating beyond the range of the training data [<xref ref-type="bibr" rid="B36">36</xref>]. The choice of number of neurons can be based on cross-validation, as in the present data, or on standard Bayesian metrics for model comparison [<xref ref-type="bibr" rid="B11">11</xref>,<xref ref-type="bibr" rid="B15">15</xref>].</p>
      <p>The Levenberg-Marquardt algorithm, as implemented in MATLAB, was adopted to optimize weights and biases, as this procedure has been effective elsewhere [<xref ref-type="bibr" rid="B38">38</xref>]. Bayesian regularization was adopted to avoid over-fitting and to improve generalization, and cross-validation was used to assess predictive ability, as in [<xref ref-type="bibr" rid="B28">28</xref>,<xref ref-type="bibr" rid="B39">39</xref>].</p>
      <p>Because Bayesian neural networks reduce the effective number of weights relative to what would be obtained without regularization, this helps to prevent over-fitting [<xref ref-type="bibr" rid="B40">40</xref>]. For the networks we examined, even though the total number of parameters, e.g., in Jerseys, ranged from 300 to 1795, the effective number of parameters varied from only 91 to 136 when pedigree relationships were used, and from 127 to 166 when genomic relationships were used as inputs, illustrating the extent of regularization. There were differences in predictive abilities of different architectures but the small sample used dictates a cautious interpretation. Nevertheless, the results seem to support networks with at least 2 neurons, which has been observed in several studies [<xref ref-type="bibr" rid="B20">20</xref>,<xref ref-type="bibr" rid="B28">28</xref>,<xref ref-type="bibr" rid="B41">41</xref>-<xref ref-type="bibr" rid="B43">43</xref>]. This suggests that linear models based on pedigree or on genomic relationships may not provide an adequate approximation to genetic signals resulting from complex genetic systems. Because highly parameterized models are penalized in the Bayesian approach, we were able to explore complex architectures. However, there was evidence of over-fitting in the Jersey training set, where correlations between observed and predicted data in the training set were always larger than 0.90, sometimes exceeding 0.95. This explains why correlations were much lower in the testing set, which is consistent with what was observed in other studies with neural networks [<xref ref-type="bibr" rid="B42">42</xref>]. Although more parameters in a model can lead to smaller error in the training data, it cannot be overemphasized that this is not representative of prediction error in an independent data set, as shown by [<xref ref-type="bibr" rid="B43">43</xref>] working with human stature.</p>
      <p>Our results with ANN for wheat are at least as good as those obtained with the same data in two other studies. Crossa et al. [<xref ref-type="bibr" rid="B35">35</xref>] found cross-validation correlations with the following values when various methods were used: pedigree information (BLUP), 0.45; pedigree-based reproducing kernel Hilbert spaces regression (RKHS), 0.60; RKHS with both pedigree and markers, 0.61; Bayesian Lasso with markers, 0.46; Bayesian Lasso with markers and pedigree, 0.54, and Bayesian ridge regression on markers, 0.49. Long et al., [<xref ref-type="bibr" rid="B30">30</xref>] compared the Bayesian Lasso with four support-vector regression models consisting of the combination of two kernels and two loss functions. The predictive correlation for wheat yield (average of 50 random repeats of the cross-validation exercise) was 0.52 for the Bayesian Lasso, and ranged between 0.50 and 0.58 for the support vector implementations. Hence, it seems clear, at least for wheat yield in this data set, that the non-parametric methods can outperform a strong learner, the Bayesian Lasso, and that the neural networks are competitive with the highly regarded support vector methods [<xref ref-type="bibr" rid="B11">11</xref>].</p>
      <p>A question of importance in animal and plant breeding is how an estimated "breeding value", i.e., an estimate of the total additive genetic effect of an individual, can be arrived at from an ANN output. There are at least two ways in which this can be done. One is by posing architectures with a neuron in which the inputs enter in a strictly linear manner, followed by a linear activation function on this neuron; the remaining neurons in the architecture, receiving the same inputs, would be treated non-linearly. A second one, is obtained by observing that the infinitesimal model can be written as y<italic>i </italic>= <bold><italic>z</italic></bold>'<italic><sub>i</sub></italic><bold>u </bold>+ <bold>e</bold>, for some incidence row vector <bold><italic>z</italic></bold>'<italic><sub>i </sub></italic>peculiar to individual <italic>i</italic>. Here, the breeding value of the <italic>i<sup>th </sup></italic>individual can be written as <inline-formula><mml:math id="M45" name="1471-2156-12-87-i44" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo class="MathClass-rel">=</mml:mo><mml:msubsup><mml:mrow><mml:mstyle mathvariant="bold"><mml:mstyle mathvariant="italic"><mml:mi>z</mml:mi></mml:mstyle></mml:mstyle></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>&#x2032;</mml:mi></mml:mrow></mml:msubsup><mml:mfrac><mml:mrow><mml:mi>&#x2202;</mml:mi></mml:mrow><mml:mrow><mml:mi>&#x2202;</mml:mi><mml:msub><mml:mrow><mml:mstyle mathvariant="bold"><mml:mstyle mathvariant="italic"><mml:mi>z</mml:mi></mml:mstyle></mml:mstyle></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mrow><mml:mo class="MathClass-open">(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>&#x2032;</mml:mi></mml:mrow></mml:msubsup><mml:mstyle mathvariant="bold"><mml:mi>u</mml:mi></mml:mstyle></mml:mrow><mml:mo class="MathClass-close">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. Likewise, consider a linear regression model for <italic>p </italic>markers, <inline-formula><mml:math id="M46" name="1471-2156-12-87-i45" overflow="scroll"><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo class="MathClass-rel">=</mml:mo><mml:msubsup><mml:mrow><mml:mo class="MathClass-op"> &#x2211;</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo class="MathClass-rel">=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>&#x3B2;</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo class="MathClass-bin">+</mml:mo><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo class="MathClass-rel">=</mml:mo><mml:msubsup><mml:mrow><mml:mstyle mathvariant="bold"><mml:mstyle mathvariant="italic"><mml:mi>x</mml:mi></mml:mstyle></mml:mstyle></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>&#x2032;</mml:mi></mml:mrow></mml:msubsup><mml:mi>&#x3B2;</mml:mi><mml:mo class="MathClass-bin">+</mml:mo><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, where <italic>&#x3B2;<sub>j </sub></italic>is the substitution effect at marker locus <italic>j</italic>; <italic>x<sub>ij </sub></italic>= 0,1,2 is the observed number of copies of a given allele at locus <italic>j </italic>on individual <italic>I</italic>, and <inline-formula><mml:math id="M47" name="1471-2156-12-87-i46" overflow="scroll"><mml:msubsup><mml:mrow><mml:mstyle mathvariant="bold"><mml:mstyle mathvariant="italic"><mml:mi>x</mml:mi></mml:mstyle></mml:mstyle></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>&#x2032;</mml:mi></mml:mrow></mml:msubsup><mml:mo class="MathClass-rel">=</mml:mo><mml:mrow><mml:mo class="MathClass-open">{</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo class="MathClass-close">}</mml:mo></mml:mrow></mml:math></inline-formula> and <bold><italic>&#x3B2; </italic></bold>= {<italic>&#x3B2;<sub>j</sub></italic>} are row and column vectors, respectively, each with <italic>p </italic>elements. Here, the "marked breeding value" of individual <italic>i </italic>would be <inline-formula><mml:math id="M48" name="1471-2156-12-87-i47" overflow="scroll"><mml:msubsup><mml:mrow><mml:mstyle mathvariant="bold"><mml:mstyle mathvariant="italic"><mml:mi>x</mml:mi></mml:mstyle></mml:mstyle></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>&#x2032;</mml:mi></mml:mrow></mml:msubsup><mml:mfrac><mml:mrow><mml:mi>&#x2202;</mml:mi></mml:mrow><mml:mrow><mml:mi>&#x2202;</mml:mi><mml:msub><mml:mrow><mml:mstyle mathvariant="bold"><mml:mstyle mathvariant="italic"><mml:mi>x</mml:mi></mml:mstyle></mml:mstyle></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mrow><mml:mo class="MathClass-open">(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mstyle mathvariant="bold"><mml:mstyle mathvariant="italic"><mml:mi>x</mml:mi></mml:mstyle></mml:mstyle></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>&#x2032;</mml:mi></mml:mrow></mml:msubsup><mml:mi>&#x3B2;</mml:mi></mml:mrow><mml:mo class="MathClass-close">)</mml:mo></mml:mrow><mml:mo class="MathClass-rel">=</mml:mo><mml:msubsup><mml:mrow><mml:mstyle mathvariant="bold"><mml:mstyle mathvariant="italic"><mml:mi>x</mml:mi></mml:mstyle></mml:mstyle></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>&#x2032;</mml:mi></mml:mrow></mml:msubsup><mml:mi>&#x3B2;</mml:mi></mml:math></inline-formula>. Consider next a neural network with a hyperbolic tangent activation function throughout, that is</p>
      <p>
        <disp-formula>
          <mml:math id="M49" name="1471-2156-12-87-i48" overflow="scroll">
            <mml:msub>
              <mml:mrow>
                <mml:mi>t</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mstyle class="text">
                  <mml:mtext class="textsf" mathvariant="sans-serif">i</mml:mtext>
                </mml:mstyle>
              </mml:mrow>
            </mml:msub>
            <mml:mo class="MathClass-rel">=</mml:mo>
            <mml:mi>b</mml:mi>
            <mml:mo class="MathClass-bin">+</mml:mo>
            <mml:mi>c</mml:mi>
            <mml:mi>g</mml:mi>
            <mml:mfenced open="[" close="]">
              <mml:mrow>
                <mml:munderover accentunder="false" accent="false">
                  <mml:mrow>
                    <mml:mo class="MathClass-op">&#x2211;</mml:mo>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>k</mml:mi>
                    <mml:mo class="MathClass-rel">=</mml:mo>
                    <mml:mn>1</mml:mn>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>s</mml:mi>
                  </mml:mrow>
                </mml:munderover>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>w</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>k</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>g</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>k</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mrow>
                  <mml:mo class="MathClass-open">(</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>b</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>k</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo class="MathClass-bin">+</mml:mo>
                    <mml:msubsup>
                      <mml:mrow>
                        <mml:mo class="MathClass-op"> &#x2211;</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>j</mml:mi>
                        <mml:mo class="MathClass-rel">=</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>n</mml:mi>
                      </mml:mrow>
                    </mml:msubsup>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>p</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                        <mml:mi>j</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:msubsup>
                      <mml:mrow>
                        <mml:mi>u</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>j</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mo class="MathClass-bin">*</mml:mo>
                        <mml:mo class="MathClass-bin">*</mml:mo>
                        <mml:mrow>
                          <mml:mo class="MathClass-open">[</mml:mo>
                          <mml:mrow>
                            <mml:mi>k</mml:mi>
                          </mml:mrow>
                          <mml:mo class="MathClass-close">]</mml:mo>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:msubsup>
                  </mml:mrow>
                  <mml:mo class="MathClass-close">)</mml:mo>
                </mml:mrow>
              </mml:mrow>
            </mml:mfenced>
            <mml:mo class="MathClass-bin">+</mml:mo>
            <mml:msub>
              <mml:mrow>
                <mml:mi>e</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>i</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo class="MathClass-punc">,</mml:mo>
            <mml:mo class="MathClass-punc">.</mml:mo>
          </mml:math>
        </disp-formula>
      </p>
      <p>Let <italic><bold>p</bold><sub>i </sub></italic>= {<italic>p<sub>ij</sub></italic>} be the vector of input covariates (e.g., genomic or additive relationships, marker genotype codes) observed on <italic>i</italic>. Adapting the preceding definitions to the ANN specification, one would have as breeding value (BV) of individual <italic>i</italic></p>
      <p>
        <disp-formula>
          <mml:math id="M50" name="1471-2156-12-87-i49" overflow="scroll">
            <mml:mrow>
              <mml:mtable class="gathered">
                <mml:mtr>
                  <mml:mtd>
                    <mml:mi>B</mml:mi>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>V</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo class="MathClass-rel">=</mml:mo>
                    <mml:msub>
                      <mml:mrow>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mstyle mathvariant="bold">
                              <mml:mstyle mathvariant="italic">
                                <mml:mi>p</mml:mi>
                              </mml:mstyle>
                            </mml:mstyle>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>&#x2032;</mml:mi>
                          </mml:mrow>
                        </mml:msup>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mfrac>
                      <mml:mrow>
                        <mml:mi>&#x2202;</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>&#x2202;</mml:mi>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mstyle mathvariant="bold">
                              <mml:mstyle mathvariant="italic">
                                <mml:mi>p</mml:mi>
                              </mml:mstyle>
                            </mml:mstyle>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>i</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mrow>
                    </mml:mfrac>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>t</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo class="MathClass-rel">=</mml:mo>
                  </mml:mtd>
                </mml:mtr>
                <mml:mtr>
                  <mml:mtd>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>C</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mi>g</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>&#x2032;</mml:mi>
                          </mml:mrow>
                        </mml:msup>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mfenced open="[" close="]">
                      <mml:mrow>
                        <mml:munderover accentunder="false" accent="false">
                          <mml:mrow>
                            <mml:mo mathsize="big">&#x2211;</mml:mo>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>k</mml:mi>
                            <mml:mo class="MathClass-rel">=</mml:mo>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>s</mml:mi>
                          </mml:mrow>
                        </mml:munderover>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>w</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>k</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>g</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>k</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mrow>
                          <mml:mo class="MathClass-open">(</mml:mo>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi>b</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>k</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                            <mml:mo class="MathClass-bin">+</mml:mo>
                            <mml:msubsup>
                              <mml:mrow>
                                <mml:mo mathsize="big"> &#x2211;</mml:mo>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>j</mml:mi>
                                <mml:mo class="MathClass-rel">=</mml:mo>
                                <mml:mn>1</mml:mn>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>n</mml:mi>
                              </mml:mrow>
                            </mml:msubsup>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi>p</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>i</mml:mi>
                                <mml:mi>j</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                            <mml:msubsup>
                              <mml:mrow>
                                <mml:mi>u</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>j</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mo class="MathClass-bin">*</mml:mo>
                                <mml:mo class="MathClass-bin">*</mml:mo>
                                <mml:mrow>
                                  <mml:mo class="MathClass-open">[</mml:mo>
                                  <mml:mrow>
                                    <mml:mi>k</mml:mi>
                                  </mml:mrow>
                                  <mml:mo class="MathClass-close">]</mml:mo>
                                </mml:mrow>
                              </mml:mrow>
                            </mml:msubsup>
                          </mml:mrow>
                          <mml:mo class="MathClass-close">)</mml:mo>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:mfenced>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mstyle mathvariant="bold">
                          <mml:msup>
                            <mml:mrow>
                              <mml:mi>p</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>&#x2032;</mml:mi>
                            </mml:mrow>
                          </mml:msup>
                        </mml:mstyle>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mstyle class="text">
                          <mml:mtext class="textsf" mathvariant="sans-serif">i</mml:mtext>
                        </mml:mstyle>
                      </mml:mrow>
                    </mml:msub>
                    <mml:munderover accentunder="false" accent="false">
                      <mml:mrow>
                        <mml:mo mathsize="big">&#x2211;</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>k</mml:mi>
                        <mml:mo class="MathClass-rel">=</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>s</mml:mi>
                      </mml:mrow>
                    </mml:munderover>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>w</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>k</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:msub>
                      <mml:mrow>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mi>g</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>&#x2032;</mml:mi>
                          </mml:mrow>
                        </mml:msup>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>k</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mrow>
                      <mml:mo class="MathClass-open">(</mml:mo>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>b</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>k</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo class="MathClass-bin">+</mml:mo>
                        <mml:msubsup>
                          <mml:mrow>
                            <mml:mo mathsize="big"> &#x2211;</mml:mo>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>j</mml:mi>
                            <mml:mo class="MathClass-rel">=</mml:mo>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>n</mml:mi>
                          </mml:mrow>
                        </mml:msubsup>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>p</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>i</mml:mi>
                            <mml:mi>j</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                        <mml:msubsup>
                          <mml:mrow>
                            <mml:mi>u</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>j</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mo class="MathClass-bin">*</mml:mo>
                            <mml:mo class="MathClass-bin">*</mml:mo>
                            <mml:mrow>
                              <mml:mo class="MathClass-open">[</mml:mo>
                              <mml:mrow>
                                <mml:mi>k</mml:mi>
                              </mml:mrow>
                              <mml:mo class="MathClass-close">]</mml:mo>
                            </mml:mrow>
                          </mml:mrow>
                        </mml:msubsup>
                      </mml:mrow>
                      <mml:mo class="MathClass-close">)</mml:mo>
                    </mml:mrow>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mstyle mathvariant="bold">
                          <mml:mi>u</mml:mi>
                        </mml:mstyle>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mo class="MathClass-bin">*</mml:mo>
                        <mml:mo class="MathClass-bin">*</mml:mo>
                        <mml:mrow>
                          <mml:mo class="MathClass-open">[</mml:mo>
                          <mml:mrow>
                            <mml:mi>k</mml:mi>
                          </mml:mrow>
                          <mml:mo class="MathClass-close">]</mml:mo>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:msup>
                    <mml:mo class="MathClass-punc">,</mml:mo>
                  </mml:mtd>
                </mml:mtr>
                <mml:mtr>
                  <mml:mtd/>
                </mml:mtr>
              </mml:mtable>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
      <p>where:</p>
      <p>
        <disp-formula>
          <mml:math id="M51" name="1471-2156-12-87-i50" overflow="scroll">
            <mml:mrow>
              <mml:mtable class="gathered">
                <mml:mtr>
                  <mml:mtd>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mi>g</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>&#x2032;</mml:mi>
                      </mml:mrow>
                    </mml:msup>
                    <mml:mfenced open="[" close="]">
                      <mml:mrow>
                        <mml:munderover accentunder="false" accent="false">
                          <mml:mrow>
                            <mml:mo mathsize="big">&#x2211;</mml:mo>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>k</mml:mi>
                            <mml:mo class="MathClass-rel">=</mml:mo>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>s</mml:mi>
                          </mml:mrow>
                        </mml:munderover>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>w</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>k</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>g</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>k</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mrow>
                          <mml:mo class="MathClass-open">(</mml:mo>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi>b</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>k</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                            <mml:mo class="MathClass-bin">+</mml:mo>
                            <mml:msubsup>
                              <mml:mrow>
                                <mml:mo mathsize="big"> &#x2211;</mml:mo>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>j</mml:mi>
                                <mml:mo class="MathClass-rel">=</mml:mo>
                                <mml:mn>1</mml:mn>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>n</mml:mi>
                              </mml:mrow>
                            </mml:msubsup>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi>p</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>i</mml:mi>
                                <mml:mi>j</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                            <mml:msubsup>
                              <mml:mrow>
                                <mml:mi>u</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>j</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mo class="MathClass-bin">*</mml:mo>
                                <mml:mo class="MathClass-bin">*</mml:mo>
                                <mml:mrow>
                                  <mml:mo class="MathClass-open">[</mml:mo>
                                  <mml:mrow>
                                    <mml:mi>k</mml:mi>
                                  </mml:mrow>
                                  <mml:mo class="MathClass-close">]</mml:mo>
                                </mml:mrow>
                              </mml:mrow>
                            </mml:msubsup>
                          </mml:mrow>
                          <mml:mo class="MathClass-close">)</mml:mo>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:mfenced>
                    <mml:mo class="MathClass-rel">=</mml:mo>
                    <mml:mn>4</mml:mn>
                    <mml:mi>P</mml:mi>
                    <mml:mrow>
                      <mml:mo class="MathClass-open">(</mml:mo>
                      <mml:mrow>
                        <mml:mn>1</mml:mn>
                        <mml:mo class="MathClass-bin">-</mml:mo>
                        <mml:mi>P</mml:mi>
                      </mml:mrow>
                      <mml:mo class="MathClass-close">)</mml:mo>
                    </mml:mrow>
                    <mml:mo class="MathClass-punc">,</mml:mo>
                  </mml:mtd>
                </mml:mtr>
                <mml:mtr>
                  <mml:mtd>
                    <mml:mi>P</mml:mi>
                    <mml:mo class="MathClass-rel">=</mml:mo>
                    <mml:mfrac>
                      <mml:mrow>
                        <mml:mo class="qopname">exp</mml:mo>
                        <mml:mfenced open="[" close="]">
                          <mml:mrow>
                            <mml:mo class="MathClass-bin">-</mml:mo>
                            <mml:mn>2</mml:mn>
                            <mml:munderover accentunder="false" accent="false">
                              <mml:mrow>
                                <mml:mo mathsize="big">&#x2211;</mml:mo>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>k</mml:mi>
                                <mml:mo class="MathClass-rel">=</mml:mo>
                                <mml:mn>1</mml:mn>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>s</mml:mi>
                              </mml:mrow>
                            </mml:munderover>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi>w</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>k</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi>g</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>k</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                            <mml:mrow>
                              <mml:mo class="MathClass-open">(</mml:mo>
                              <mml:mrow>
                                <mml:msub>
                                  <mml:mrow>
                                    <mml:mi>b</mml:mi>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mi>k</mml:mi>
                                  </mml:mrow>
                                </mml:msub>
                                <mml:mo class="MathClass-bin">+</mml:mo>
                                <mml:msubsup>
                                  <mml:mrow>
                                    <mml:mo mathsize="big"> &#x2211;</mml:mo>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mi>j</mml:mi>
                                    <mml:mo class="MathClass-rel">=</mml:mo>
                                    <mml:mn>1</mml:mn>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mi>n</mml:mi>
                                  </mml:mrow>
                                </mml:msubsup>
                                <mml:msub>
                                  <mml:mrow>
                                    <mml:mi>p</mml:mi>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mi>i</mml:mi>
                                    <mml:mi>j</mml:mi>
                                  </mml:mrow>
                                </mml:msub>
                                <mml:msubsup>
                                  <mml:mrow>
                                    <mml:mi>u</mml:mi>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mi>j</mml:mi>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mo class="MathClass-bin">*</mml:mo>
                                    <mml:mo class="MathClass-bin">*</mml:mo>
                                    <mml:mrow>
                                      <mml:mo class="MathClass-open">[</mml:mo>
                                      <mml:mrow>
                                        <mml:mi>k</mml:mi>
                                      </mml:mrow>
                                      <mml:mo class="MathClass-close">]</mml:mo>
                                    </mml:mrow>
                                  </mml:mrow>
                                </mml:msubsup>
                              </mml:mrow>
                              <mml:mo class="MathClass-close">)</mml:mo>
                            </mml:mrow>
                          </mml:mrow>
                        </mml:mfenced>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mn>1</mml:mn>
                        <mml:mo class="MathClass-bin">+</mml:mo>
                        <mml:mo class="qopname"> exp</mml:mo>
                        <mml:mfenced open="[" close="]">
                          <mml:mrow>
                            <mml:mo class="MathClass-bin">-</mml:mo>
                            <mml:mn>2</mml:mn>
                            <mml:munderover accentunder="false" accent="false">
                              <mml:mrow>
                                <mml:mo mathsize="big">&#x2211;</mml:mo>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>k</mml:mi>
                                <mml:mo class="MathClass-rel">=</mml:mo>
                                <mml:mn>1</mml:mn>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>s</mml:mi>
                              </mml:mrow>
                            </mml:munderover>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi>w</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>k</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi>g</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>k</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                            <mml:mrow>
                              <mml:mo class="MathClass-open">(</mml:mo>
                              <mml:mrow>
                                <mml:msub>
                                  <mml:mrow>
                                    <mml:mi>b</mml:mi>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mi>k</mml:mi>
                                  </mml:mrow>
                                </mml:msub>
                                <mml:mo class="MathClass-bin">+</mml:mo>
                                <mml:msubsup>
                                  <mml:mrow>
                                    <mml:mo mathsize="big"> &#x2211;</mml:mo>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mi>j</mml:mi>
                                    <mml:mo class="MathClass-rel">=</mml:mo>
                                    <mml:mn>1</mml:mn>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mi>n</mml:mi>
                                  </mml:mrow>
                                </mml:msubsup>
                                <mml:msub>
                                  <mml:mrow>
                                    <mml:mi>p</mml:mi>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mi>i</mml:mi>
                                    <mml:mi>j</mml:mi>
                                  </mml:mrow>
                                </mml:msub>
                                <mml:msubsup>
                                  <mml:mrow>
                                    <mml:mi>u</mml:mi>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mi>j</mml:mi>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mo class="MathClass-bin">*</mml:mo>
                                    <mml:mo class="MathClass-bin">*</mml:mo>
                                    <mml:mrow>
                                      <mml:mo class="MathClass-open">[</mml:mo>
                                      <mml:mrow>
                                        <mml:mi>k</mml:mi>
                                      </mml:mrow>
                                      <mml:mo class="MathClass-close">]</mml:mo>
                                    </mml:mrow>
                                  </mml:mrow>
                                </mml:msubsup>
                              </mml:mrow>
                              <mml:mo class="MathClass-close">)</mml:mo>
                            </mml:mrow>
                          </mml:mrow>
                        </mml:mfenced>
                      </mml:mrow>
                    </mml:mfrac>
                    <mml:mo class="MathClass-punc">,</mml:mo>
                  </mml:mtd>
                </mml:mtr>
                <mml:mtr>
                  <mml:mtd>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mstyle mathvariant="bold">
                          <mml:mi>u</mml:mi>
                        </mml:mstyle>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mo class="MathClass-bin">*</mml:mo>
                        <mml:mo class="MathClass-bin">*</mml:mo>
                        <mml:mrow>
                          <mml:mo class="MathClass-open">[</mml:mo>
                          <mml:mrow>
                            <mml:mi>k</mml:mi>
                          </mml:mrow>
                          <mml:mo class="MathClass-close">]</mml:mo>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:msup>
                    <mml:mo class="MathClass-rel">=</mml:mo>
                    <mml:mfenced open="{" close="}">
                      <mml:mrow>
                        <mml:msubsup>
                          <mml:mrow>
                            <mml:mi>u</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>j</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mo class="MathClass-bin">*</mml:mo>
                            <mml:mo class="MathClass-bin">*</mml:mo>
                            <mml:mrow>
                              <mml:mo class="MathClass-open">[</mml:mo>
                              <mml:mrow>
                                <mml:mi>k</mml:mi>
                              </mml:mrow>
                              <mml:mo class="MathClass-close">]</mml:mo>
                            </mml:mrow>
                          </mml:mrow>
                        </mml:msubsup>
                      </mml:mrow>
                    </mml:mfenced>
                    <mml:mo class="MathClass-punc">,</mml:mo>
                  </mml:mtd>
                </mml:mtr>
                <mml:mtr>
                  <mml:mtd/>
                </mml:mtr>
              </mml:mtable>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
      <p>and</p>
      <p>
        <disp-formula>
          <mml:math id="M52" name="1471-2156-12-87-i51" overflow="scroll">
            <mml:mrow>
              <mml:msup>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>g</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>k</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>&#x2032;</mml:mi>
                </mml:mrow>
              </mml:msup>
              <mml:mrow>
                <mml:mo class="MathClass-open">(</mml:mo>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>b</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>k</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo class="MathClass-bin">+</mml:mo>
                  <mml:msubsup>
                    <mml:mrow>
                      <mml:mo mathsize="big"> &#x2211;</mml:mo>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>j</mml:mi>
                      <mml:mo class="MathClass-rel">=</mml:mo>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>n</mml:mi>
                    </mml:mrow>
                  </mml:msubsup>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>p</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>i</mml:mi>
                      <mml:mi>j</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:msubsup>
                    <mml:mrow>
                      <mml:mi>u</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>j</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mo class="MathClass-bin">*</mml:mo>
                      <mml:mo class="MathClass-bin">*</mml:mo>
                      <mml:mrow>
                        <mml:mo class="MathClass-open">[</mml:mo>
                        <mml:mrow>
                          <mml:mi>k</mml:mi>
                        </mml:mrow>
                        <mml:mo class="MathClass-close">]</mml:mo>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:msubsup>
                </mml:mrow>
                <mml:mo class="MathClass-close">)</mml:mo>
              </mml:mrow>
              <mml:msup>
                <mml:mrow>
                  <mml:msup>
                    <mml:mrow>
                      <mml:mstyle mathvariant="bold">
                        <mml:mi>u</mml:mi>
                      </mml:mstyle>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mo class="MathClass-bin">*</mml:mo>
                      <mml:mo class="MathClass-bin">*</mml:mo>
                    </mml:mrow>
                  </mml:msup>
                </mml:mrow>
                <mml:mrow>
                  <mml:mrow>
                    <mml:mo class="MathClass-open">[</mml:mo>
                    <mml:mrow>
                      <mml:mi>k</mml:mi>
                    </mml:mrow>
                    <mml:mo class="MathClass-close">]</mml:mo>
                  </mml:mrow>
                </mml:mrow>
              </mml:msup>
              <mml:mo class="MathClass-rel">=</mml:mo>
              <mml:mn>4</mml:mn>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>P</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>k</mml:mi>
                </mml:mrow>
              </mml:msub>
              <mml:mrow>
                <mml:mo class="MathClass-open">(</mml:mo>
                <mml:mrow>
                  <mml:mn>1</mml:mn>
                  <mml:mo class="MathClass-bin">-</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>P</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>k</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                </mml:mrow>
                <mml:mo class="MathClass-close">)</mml:mo>
              </mml:mrow>
              <mml:mo class="MathClass-punc">,</mml:mo>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
      <p>with</p>
      <p>
        <disp-formula>
          <mml:math id="M53" name="1471-2156-12-87-i52" overflow="scroll">
            <mml:mrow>
              <mml:msub>
                <mml:mi>P</mml:mi>
                <mml:mi>k</mml:mi>
              </mml:msub>
              <mml:mo>=</mml:mo>
              <mml:mfrac>
                <mml:mrow>
                  <mml:mi>exp</mml:mi>
                  <mml:mrow>
                    <mml:mo>[</mml:mo>
                    <mml:mrow>
                      <mml:mo>&#x2212;</mml:mo>
                      <mml:mn>2</mml:mn>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:msub>
                        <mml:mi>b</mml:mi>
                        <mml:mi>k</mml:mi>
                      </mml:msub>
                      <mml:mo>+</mml:mo>
                      <mml:mstyle displaystyle="true">
                        <mml:msubsup>
                          <mml:mo>&#x2211;</mml:mo>
                          <mml:mrow>
                            <mml:mi>j</mml:mi>
                            <mml:mo>=</mml:mo>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                          <mml:mi>n</mml:mi>
                        </mml:msubsup>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mi>p</mml:mi>
                            <mml:mrow>
                              <mml:mi>i</mml:mi>
                              <mml:mi>j</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                          <mml:msubsup>
                            <mml:mi>u</mml:mi>
                            <mml:mi>j</mml:mi>
                            <mml:mrow>
                              <mml:mo>*</mml:mo>
                              <mml:mo>*</mml:mo>
                              <mml:mo stretchy="false">[</mml:mo>
                              <mml:mi>k</mml:mi>
                              <mml:mo stretchy="false">]</mml:mo>
                            </mml:mrow>
                          </mml:msubsup>
                        </mml:mrow>
                      </mml:mstyle>
                    </mml:mrow>
                    <mml:mo>]</mml:mo>
                  </mml:mrow>
                </mml:mrow>
                <mml:mrow>
                  <mml:mn>1</mml:mn>
                  <mml:mo>+</mml:mo>
                  <mml:mi>exp</mml:mi>
                  <mml:mrow>
                    <mml:mo>[</mml:mo>
                    <mml:mrow>
                      <mml:mo>&#x2212;</mml:mo>
                      <mml:mn>2</mml:mn>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:msub>
                        <mml:mi>b</mml:mi>
                        <mml:mi>k</mml:mi>
                      </mml:msub>
                      <mml:mo>+</mml:mo>
                      <mml:mstyle displaystyle="true">
                        <mml:msubsup>
                          <mml:mo>&#x2211;</mml:mo>
                          <mml:mrow>
                            <mml:mi>j</mml:mi>
                            <mml:mo>=</mml:mo>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                          <mml:mi>n</mml:mi>
                        </mml:msubsup>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mi>p</mml:mi>
                            <mml:mrow>
                              <mml:mi>i</mml:mi>
                              <mml:mi>j</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                          <mml:msubsup>
                            <mml:mi>u</mml:mi>
                            <mml:mi>j</mml:mi>
                            <mml:mrow>
                              <mml:mo>*</mml:mo>
                              <mml:mo>*</mml:mo>
                              <mml:mo stretchy="false">[</mml:mo>
                              <mml:mi>k</mml:mi>
                              <mml:mo stretchy="false">]</mml:mo>
                            </mml:mrow>
                          </mml:msubsup>
                          <mml:mo stretchy="false">)</mml:mo>
                        </mml:mrow>
                      </mml:mstyle>
                    </mml:mrow>
                    <mml:mo>]</mml:mo>
                  </mml:mrow>
                </mml:mrow>
              </mml:mfrac>
              <mml:mo>.</mml:mo>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
      <p>Thus, the so defined breeding value of individual <italic>i </italic>depends on the values of the input covariates observed on this individual, on all connection strengths and bias parameters from inputs to neurons in the middle layer (the <italic>u's </italic>and the <italic>b's</italic>), and on all connection strengths from the middle layer to the output layer (the <italic>w's</italic>). In order to obtain an estimate of breeding value the unknown quantities would replaced by the corresponding maximum a posteriori (MAP) estimates or, say, by the estimate of their posterior expectation if a Markov chain Monte Carlo scheme is applied [<xref ref-type="bibr" rid="B44">44</xref>].</p>
      <p>Another issue is that of assessing the importance of an input relative to that of others. For example, in a linear regression model on markers, one could use a point estimate of the substitution effect or its "studentized" value (i.e., the point estimate divided by the corresponding posterior standard deviation), or some measure that involves estimates of substitution effects and of allelic frequencies. A discussion of some measures of relative importance of inputs in an ANN is in [<xref ref-type="bibr" rid="B28">28</xref>,<xref ref-type="bibr" rid="B43">43</xref>], for example, the ratio between the absolute value of the estimate of a given connection strength, and the sum of the absolute values of all coefficients in the network.</p>
    </sec>
    <sec sec-type="conclusions">
      <title>Conclusion</title>
      <p>Non-linear neural networks tended to outperform benchmark linear models in predictive ability, and clearly so in the wheat data. Bayesian regularization allowed estimation of all connection strengths even when <italic>n&lt;&lt;p</italic>, and the effective number of parameters was much smaller than the corresponding nominal number. Although the study was based on small samples, and the differences found may be reflective of random variation, especially in the Jersey data, our results suggest that the neural networks may be useful for predicting complex traits using high-dimensional genomic information, a situation where the number of coefficients that need to be estimated exceeds sample size. Neural networks have the ability of capturing nonlinearities, and do so adaptively, which may be useful in the study of quantitative traits under complex gene action, and particularly when prediction of outcomes is crucial, such as in personalized medicine.</p>
      <p>In summary, predictive ability seemed to be enhanced by use of Bayesian neural networks. Due to small sample sizes no claim is made about superiority of any specific non-linear architecture. As it has been observed in many studies, the superiority of one predictive model over another depends on the species, trait and environment, and the same will surely hold for ANNs.</p>
    </sec>
    <sec>
      <title>Abbreviations</title>
      <p>ANN: artificial neural network; BR: Bayesian regularization; BRANN: Bayesian regularization artificial neural network; LASSO: Least absolute shrinkage and selection operator; MAP: Maximum a posterior; NN: Neural network; RKHS: Reproducing kernel Hilbert spaces regression; SNP: Single nucleotide polymorphism; SSE: Sum of squared error.</p>
    </sec>
    <sec>
      <title>Competing interests</title>
      <p>The authors declare that they have no competing interests.</p>
    </sec>
    <sec>
      <title>Authors' contributions</title>
      <p>DG conceived, drafted and wrote the manuscript; HO conceived, carried out the study, performed computations and wrote a part of the manuscript; KAW and GJMR helped to conceive and coordinate the study, provided critical insights and revised the manuscript. All authors read and approved the final manuscript.</p>
    </sec>
  </body>
  <back>
    <sec>
      <title>Acknowledgements</title>
      <p>Research was supported by the Wisconsin Agriculture Experiment Station and by grants from Aviagen, Ltd., Newbridge, Scotland, and Igenity/Merial, Duluth, Georgia, USA.</p>
    </sec>
    <ref-list>
      <ref id="B1">
        <mixed-citation publication-type="journal">
          <name>
            <surname>Meuwissen</surname>
            <given-names>THE</given-names>
          </name>
          <name>
            <surname>Hayes</surname>
            <given-names>BJ</given-names>
          </name>
          <name>
            <surname>Goddard</surname>
            <given-names>ME</given-names>
          </name>
          <article-title>Prediction of total genetic value using genome-wide dense marker maps</article-title>
          <source>Genetics</source>
          <year>2001</year>
          <volume>157</volume>
          <fpage>1819</fpage>
          <lpage>1829</lpage>
          <pub-id pub-id-type="pmid">11290733</pub-id>
        </mixed-citation>
      </ref>
      <ref id="B2">
        <mixed-citation publication-type="journal">
          <name>
            <surname>de los Campos</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Gianola</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Rosa</surname>
            <given-names>GJM</given-names>
          </name>
          <article-title>Reproducing kernel Hilbert spaces regression: A general framework for genetic evaluation</article-title>
          <source>Journal of Animal Science</source>
          <year>2009</year>
          <volume>87</volume>
          <fpage>1883</fpage>
          <lpage>1887</lpage>
          <pub-id pub-id-type="doi">10.2527/jas.2008-1259</pub-id>
          <pub-id pub-id-type="pmid">19213705</pub-id>
        </mixed-citation>
      </ref>
      <ref id="B3">
        <mixed-citation publication-type="journal">
          <name>
            <surname>de los Campos</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Gianola</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Allison</surname>
            <given-names>DB</given-names>
          </name>
          <article-title>Predicting genetic predisposition in humans: the promise of whole genome markers</article-title>
          <source>Nature Reviews Genetics</source>
          <year>2010</year>
          <volume>11</volume>
          <fpage>880</fpage>
          <lpage>886</lpage>
          <pub-id pub-id-type="doi">10.1038/nrg2898</pub-id>
        </mixed-citation>
      </ref>
      <ref id="B4">
        <mixed-citation publication-type="journal">
          <name>
            <surname>de los Campos</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Gianola</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Rosa</surname>
            <given-names>GJM</given-names>
          </name>
          <name>
            <surname>Weigel</surname>
            <given-names>KA</given-names>
          </name>
          <name>
            <surname>Crossa</surname>
            <given-names>J</given-names>
          </name>
          <article-title>Semi-parametric genomic-enabled prediction of genetic values using reproducing kernel Hilbert spaces methods</article-title>
          <source>Genetics Research</source>
          <year>2010</year>
          <volume>92</volume>
          <fpage>295</fpage>
          <lpage>308</lpage>
          <pub-id pub-id-type="doi">10.1017/S0016672310000285</pub-id>
          <pub-id pub-id-type="pmid">20943010</pub-id>
        </mixed-citation>
      </ref>
      <ref id="B5">
        <mixed-citation publication-type="journal">
          <name>
            <surname>Gianola</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Fernando</surname>
            <given-names>RL</given-names>
          </name>
          <name>
            <surname>Stella</surname>
            <given-names>A</given-names>
          </name>
          <article-title>Genomic assisted prediction of genetic value with semi-parametric procedures</article-title>
          <source>Genetics</source>
          <year>2006</year>
          <volume>173</volume>
          <fpage>1761</fpage>
          <lpage>1776</lpage>
          <pub-id pub-id-type="doi">10.1534/genetics.105.049510</pub-id>
          <pub-id pub-id-type="pmid">16648593</pub-id>
        </mixed-citation>
      </ref>
      <ref id="B6">
        <mixed-citation publication-type="journal">
          <name>
            <surname>Gianola</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>van Kaam</surname>
            <given-names>JBCHM</given-names>
          </name>
          <article-title>Reproducing kernel hilbert spaces regression methods for genomic assisted prediction of quantitative traits</article-title>
          <source>Genetics</source>
          <year>2008</year>
          <volume>178</volume>
          <fpage>2289</fpage>
          <lpage>2303</lpage>
          <pub-id pub-id-type="doi">10.1534/genetics.107.084285</pub-id>
          <pub-id pub-id-type="pmid">18430950</pub-id>
        </mixed-citation>
      </ref>
      <ref id="B7">
        <mixed-citation publication-type="journal">
          <name>
            <surname>Gianola</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>de los Campos</surname>
            <given-names>G</given-names>
          </name>
          <article-title>Inferring genetic values for quantitative traits non-parametrically</article-title>
          <source>Genetics Research</source>
          <year>2008</year>
          <volume>90</volume>
          <fpage>525</fpage>
          <lpage>540</lpage>
          <pub-id pub-id-type="doi">10.1017/S0016672308009890</pub-id>
          <pub-id pub-id-type="pmid">19123970</pub-id>
        </mixed-citation>
      </ref>
      <ref id="B8">
        <mixed-citation publication-type="journal">
          <name>
            <surname>Long</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Gianola</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Rosa</surname>
            <given-names>GMJ</given-names>
          </name>
          <name>
            <surname>Weigel</surname>
            <given-names>KA</given-names>
          </name>
          <name>
            <surname>Kranis</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Gonz&#xE1;lez-Recio</surname>
            <given-names>O</given-names>
          </name>
          <article-title>Radial basis function regression methods for predicting quantitative traits using SNP markers</article-title>
          <source>Genetics Research</source>
          <year>2010</year>
          <volume>92</volume>
          <issue>3</issue>
          <fpage>209</fpage>
          <lpage>25</lpage>
          <pub-id pub-id-type="doi">10.1017/S0016672310000157</pub-id>
          <pub-id pub-id-type="pmid">20667165</pub-id>
        </mixed-citation>
      </ref>
      <ref id="B9">
        <mixed-citation publication-type="journal">
          <name>
            <surname>Ober</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Erbe</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Long</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Porcu</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Schlather</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Simianer</surname>
            <given-names>H</given-names>
          </name>
          <article-title>Predicting genetic values: a kernel-based best linear unbiased prediction with genomic data</article-title>
          <source>Genetics</source>
          <year>2011</year>
          <volume>188</volume>
          <issue>3</issue>
          <fpage>695</fpage>
          <lpage>708</lpage>
          <pub-id pub-id-type="doi">10.1534/genetics.111.128694</pub-id>
          <pub-id pub-id-type="pmid">21515573</pub-id>
        </mixed-citation>
      </ref>
      <ref id="B10">
        <mixed-citation publication-type="journal">
          <name>
            <surname>Alados</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Mellado</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Ramos</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Alados-Arboledas</surname>
            <given-names>L</given-names>
          </name>
          <article-title>Estimating UV Erythema1 irradiance by means of neural networks</article-title>
          <source>Photochemistry and Photobiology</source>
          <year>2004</year>
          <volume>80</volume>
          <fpage>351</fpage>
          <lpage>358</lpage>
          <pub-id pub-id-type="doi">10.1562/2004-03-12-RA-111.1</pub-id>
          <pub-id pub-id-type="pmid">15362949</pub-id>
        </mixed-citation>
      </ref>
      <ref id="B11">
        <mixed-citation publication-type="book">
          <name>
            <surname>Bishop</surname>
            <given-names>CM</given-names>
          </name>
          <source><italic>Pattern </italic>Recognition and Machine Learning</source>
          <year>2006</year>
          <publisher-name>Singapore: Springer</publisher-name>
        </mixed-citation>
      </ref>
      <ref id="B12">
        <mixed-citation publication-type="book">
          <name>
            <surname>Lamontagne</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Marchand</surname>
            <given-names>M</given-names>
          </name>
          <source>Advances in Artificial Intelligence</source>
          <year>2006</year>
          <publisher-name>Berlin: Springer</publisher-name>
        </mixed-citation>
      </ref>
      <ref id="B13">
        <mixed-citation publication-type="other">
          <name>
            <surname>Pereira</surname>
            <given-names>BDB</given-names>
          </name>
          <name>
            <surname>Rao</surname>
            <given-names>CR</given-names>
          </name>
          <article-title>Data Mining using Neural Networks: A Guide for Statisticians</article-title>
          <year>2009</year>
          <ext-link ext-link-type="uri" xlink:href="http://www.po.ufrj.br/basilio/publicacoes/livros/2009_datamining_using_neural_networks.pdf">http://www.po.ufrj.br/basilio/publicacoes/livros/2009_datamining_using_neural_networks.pdf</ext-link>
        </mixed-citation>
      </ref>
      <ref id="B14">
        <mixed-citation publication-type="journal">
          <name>
            <surname>Lampinen</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Vehtari</surname>
            <given-names>A</given-names>
          </name>
          <article-title>Bayesian approach for neural networks review and case studies</article-title>
          <source>Neural Networks</source>
          <year>2001</year>
          <volume>14</volume>
          <fpage>257</fpage>
          <lpage>274</lpage>
          <pub-id pub-id-type="doi">10.1016/S0893-6080(00)00098-8</pub-id>
          <pub-id pub-id-type="pmid">11341565</pub-id>
        </mixed-citation>
      </ref>
      <ref id="B15">
        <mixed-citation publication-type="book">
          <name>
            <surname>Sorensen</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Gianola</surname>
            <given-names>D</given-names>
          </name>
          <source>Likelihood, Bayesian and MCMC methods in quantitative genetics</source>
          <year>2002</year>
          <publisher-name>New York: Springer</publisher-name>
        </mixed-citation>
      </ref>
      <ref id="B16">
        <mixed-citation publication-type="journal">
          <name>
            <surname>Gianola</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>de los Campos</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Hill</surname>
            <given-names>WG</given-names>
          </name>
          <name>
            <surname>Manfredi</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Fernando</surname>
            <given-names>R</given-names>
          </name>
          <article-title>Additive genetic variability and the Bayesian alphabet</article-title>
          <source>Genetics</source>
          <year>2009</year>
          <volume>183</volume>
          <fpage>347</fpage>
          <lpage>363</lpage>
          <pub-id pub-id-type="doi">10.1534/genetics.109.103952</pub-id>
          <pub-id pub-id-type="pmid">19620397</pub-id>
        </mixed-citation>
      </ref>
      <ref id="B17">
        <mixed-citation publication-type="journal">
          <name>
            <surname>Van Raden</surname>
            <given-names>PM</given-names>
          </name>
          <article-title>Efficient methods to compute genomic predictions</article-title>
          <source>J Dairy Sci</source>
          <year>2008</year>
          <volume>91</volume>
          <fpage>4414</fpage>
          <lpage>4423</lpage>
          <pub-id pub-id-type="doi">10.3168/jds.2007-0980</pub-id>
          <pub-id pub-id-type="pmid">18946147</pub-id>
        </mixed-citation>
      </ref>
      <ref id="B18">
        <mixed-citation publication-type="journal">
          <name>
            <surname>MacKay</surname>
            <given-names>DJC</given-names>
          </name>
          <article-title>Baysian interpolation</article-title>
          <source>Neural Computation</source>
          <year>1992</year>
          <volume>4</volume>
          <fpage>415</fpage>
          <lpage>447</lpage>
          <pub-id pub-id-type="doi">10.1162/neco.1992.4.3.415</pub-id>
        </mixed-citation>
      </ref>
      <ref id="B19">
        <mixed-citation publication-type="journal">
          <name>
            <surname>Titterington</surname>
            <given-names>DM</given-names>
          </name>
          <article-title>Bayesian methods for neural networks and related models</article-title>
          <source>Statistical Science</source>
          <year>2004</year>
          <volume>19</volume>
          <fpage>128</fpage>
          <lpage>139</lpage>
          <pub-id pub-id-type="doi">10.1214/088342304000000099</pub-id>
        </mixed-citation>
      </ref>
      <ref id="B20">
        <mixed-citation publication-type="other">
          <name>
            <surname>Foresee</surname>
            <given-names>FD</given-names>
          </name>
          <name>
            <surname>Hagan</surname>
            <given-names>MT</given-names>
          </name>
          <article-title>Gauss-Newton approximation to Bayesian learning</article-title>
          <source>Proc IEEE Int Conf Neural Networks</source>
          <year>1997</year>
          <fpage>1930</fpage>
          <lpage>1935</lpage>
        </mixed-citation>
      </ref>
      <ref id="B21">
        <mixed-citation publication-type="book">
          <name>
            <surname>Gianola</surname>
            <given-names>D</given-names>
          </name>
          <person-group person-group-type="editor">Balding DJ, Bishop M, Cannings C</person-group>
          <article-title>Inferences from mixed models in quantitative genetics</article-title>
          <source>Handbook of Statistical Genetics</source>
          <year>2007</year>
          <edition>Third</edition>
          <publisher-name>West Sussex UK: John Wiley &amp; Sons</publisher-name>
        </mixed-citation>
      </ref>
      <ref id="B22">
        <mixed-citation publication-type="journal">
          <name>
            <surname>Tempelman</surname>
            <given-names>RJ</given-names>
          </name>
          <name>
            <surname>Gianola</surname>
            <given-names>D</given-names>
          </name>
          <article-title>Marginal maximum likelihood estimation of variance components in Poisson mixed models using Laplace integration</article-title>
          <source>Genetics, Selection, Evolution</source>
          <year>1993</year>
          <volume>25</volume>
          <fpage>305</fpage>
          <lpage>319</lpage>
          <pub-id pub-id-type="doi">10.1186/1297-9686-25-4-305</pub-id>
        </mixed-citation>
      </ref>
      <ref id="B23">
        <mixed-citation publication-type="journal">
          <name>
            <surname>Xu</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Zengi</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Jiang</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>W</given-names>
          </name>
          <article-title>Application of Bayesian regularized BP neural network model for trend analysis, acidity and chemical composition of precipitation in North</article-title>
          <source>Water, Air, and Soil Pollution</source>
          <year>2006</year>
          <volume>172</volume>
          <fpage>167</fpage>
          <lpage>184</lpage>
          <pub-id pub-id-type="doi">10.1007/s11270-005-9068-8</pub-id>
        </mixed-citation>
      </ref>
      <ref id="B24">
        <mixed-citation publication-type="journal">
          <name>
            <surname>Smith</surname>
            <given-names>SP</given-names>
          </name>
          <name>
            <surname>Graser</surname>
            <given-names>HU</given-names>
          </name>
          <article-title>Estimating variance components in a class of mixed models by restricted maximum likelihood</article-title>
          <source>J Dairy Sci</source>
          <year>1986</year>
          <volume>69</volume>
          <fpage>1165</fpage>
        </mixed-citation>
      </ref>
      <ref id="B25">
        <mixed-citation publication-type="journal">
          <name>
            <surname>Graser</surname>
            <given-names>HU</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>SP</given-names>
          </name>
          <name>
            <surname>Tier</surname>
            <given-names>B</given-names>
          </name>
          <article-title>A derivative-free approach for estimating variance components in animal models by restricted maximum likelihood</article-title>
          <source>J Anim Sci</source>
          <year>1987</year>
          <volume>64</volume>
          <fpage>1362</fpage>
        </mixed-citation>
      </ref>
      <ref id="B26">
        <mixed-citation publication-type="journal">
          <name>
            <surname>Hassami</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Anctil</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Viau</surname>
            <given-names>AA</given-names>
          </name>
          <article-title>Selection of an artificial neural network model for the post-calibration of weather radar rainfall estimation</article-title>
          <source>Journal of Data Science</source>
          <year>2004</year>
          <volume>220</volume>
          <fpage>107</fpage>
          <lpage>124</lpage>
        </mixed-citation>
      </ref>
      <ref id="B27">
        <mixed-citation publication-type="book">
          <name>
            <surname>MacKay</surname>
            <given-names>JCD</given-names>
          </name>
          <source>Information Theory, Inference and Learning Algorithms</source>
          <year>2008</year>
          <publisher-name>Cambridge; Cambridge University Press</publisher-name>
        </mixed-citation>
      </ref>
      <ref id="B28">
        <mixed-citation publication-type="journal">
          <name>
            <surname>Okut</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Gianola</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Rosa</surname>
            <given-names>GJM</given-names>
          </name>
          <name>
            <surname>Weigel</surname>
            <given-names>KA</given-names>
          </name>
          <article-title>Prediction of body mass index in mice using dense molecular markers and a regularized neural network</article-title>
          <source>Genetics Research</source>
          <year>2011</year>
          <volume>93</volume>
          <fpage>189</fpage>
          <lpage>201</lpage>
          <pub-id pub-id-type="doi">10.1017/S0016672310000662</pub-id>
        </mixed-citation>
      </ref>
      <ref id="B29">
        <mixed-citation publication-type="book">
          <name>
            <surname>Beal</surname>
            <given-names>MH</given-names>
          </name>
          <name>
            <surname>Hagan</surname>
            <given-names>MT</given-names>
          </name>
          <name>
            <surname>Demuth</surname>
            <given-names>HB</given-names>
          </name>
          <source>Neural Network Toolbox' 6 User's Guide</source>
          <year>2010</year>
          <publisher-name>The MathWorks, Inc</publisher-name>
        </mixed-citation>
      </ref>
      <ref id="B30">
        <mixed-citation publication-type="other">
          <name>
            <surname>Long</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Gianola</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Rosa</surname>
            <given-names>GJM</given-names>
          </name>
          <name>
            <surname>Weigel</surname>
            <given-names>KA</given-names>
          </name>
          <article-title>Application of support vector regressions to genome-assisted prediction of quantitative traits</article-title>
          <source>Theoretical and Applied Genetics</source>
          <year>2011</year>
          <comment>(under review)</comment>
        </mixed-citation>
      </ref>
      <ref id="B31">
        <mixed-citation publication-type="book">
          <name>
            <surname>Haykin</surname>
            <given-names>S</given-names>
          </name>
          <source>Neural Networks: Comprehensive Foundation</source>
          <year>2008</year>
          <publisher-name>New York USA: Prentice-Hall</publisher-name>
        </mixed-citation>
      </ref>
      <ref id="B32">
        <mixed-citation publication-type="journal">
          <name>
            <surname>Habier</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Fernando</surname>
            <given-names>RL</given-names>
          </name>
          <name>
            <surname>Dekkers</surname>
            <given-names>JCM</given-names>
          </name>
          <article-title>The impact of genetic relationship information on genome-assisted breeding values</article-title>
          <source>Genetics</source>
          <year>2007</year>
          <volume>177</volume>
          <issue>4</issue>
          <fpage>2389</fpage>
          <lpage>2397</lpage>
          <pub-id pub-id-type="pmid">18073436</pub-id>
        </mixed-citation>
      </ref>
      <ref id="B33">
        <mixed-citation publication-type="journal">
          <name>
            <surname>Van Raden</surname>
            <given-names>PM</given-names>
          </name>
          <name>
            <surname>Tooker</surname>
            <given-names>ME</given-names>
          </name>
          <name>
            <surname>Cole</surname>
            <given-names>JB</given-names>
          </name>
          <article-title>Can you believe those genomic evaluations for young bulls?</article-title>
          <source>Journal of Dairy Science</source>
          <year>2009</year>
          <volume>92</volume>
          <issue>E-Suppl 1</issue>
          <fpage>314</fpage>
        </mixed-citation>
      </ref>
      <ref id="B34">
        <mixed-citation publication-type="book">
          <name>
            <surname>Falconer</surname>
            <given-names>DS</given-names>
          </name>
          <name>
            <surname>McKay</surname>
            <given-names>TFC</given-names>
          </name>
          <source>Introduction to Quantitative Genetics</source>
          <year>1996</year>
          <publisher-name>Malaysia: Longmans Green</publisher-name>
        </mixed-citation>
      </ref>
      <ref id="B35">
        <mixed-citation publication-type="journal">
          <name>
            <surname>Crossa</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>de los Campos</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Perez</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Gianola</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Dreisigacker</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Burgue&#xF1;o</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Araus</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Makumb</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Yan</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Singh</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Arief</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Banzinger</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Braun</surname>
            <given-names>HJ</given-names>
          </name>
          <article-title>Prediction of genetic values for quantitative traits in plant breeding using pedigree and molecular markers</article-title>
          <source>Genetics</source>
          <year>2010</year>
          <volume>186</volume>
          <fpage>713</fpage>
          <lpage>724</lpage>
          <pub-id pub-id-type="doi">10.1534/genetics.110.118521</pub-id>
          <pub-id pub-id-type="pmid">20813882</pub-id>
        </mixed-citation>
      </ref>
      <ref id="B36">
        <mixed-citation publication-type="journal">
          <name>
            <surname>Perez</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>de los Campos</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Crossa</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Gianola</surname>
            <given-names>D</given-names>
          </name>
          <article-title>Genomic-enabled prediction based on molecular markers and pedigree using the Bayesian Linear Regression package in R</article-title>
          <source>The Plant Genome</source>
          <year>2010</year>
          <volume>3</volume>
          <fpage>106</fpage>
          <lpage>116</lpage>
          <pub-id pub-id-type="doi">10.3835/plantgenome2010.04.0005</pub-id>
          <pub-id pub-id-type="pmid">21566722</pub-id>
        </mixed-citation>
      </ref>
      <ref id="B37">
        <mixed-citation publication-type="journal">
          <name>
            <surname>Hayes</surname>
            <given-names>BJ</given-names>
          </name>
          <name>
            <surname>Bowman</surname>
            <given-names>BJ</given-names>
          </name>
          <name>
            <surname>Chamberlain</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Goddard</surname>
            <given-names>ME</given-names>
          </name>
          <article-title>Invited review: Genomic selection in dairy cattle: Progress and challenges</article-title>
          <source>J Dairy Sci</source>
          <year>2009</year>
          <volume>92</volume>
          <fpage>433</fpage>
          <lpage>443</lpage>
          <pub-id pub-id-type="doi">10.3168/jds.2008-1646</pub-id>
          <pub-id pub-id-type="pmid">19164653</pub-id>
        </mixed-citation>
      </ref>
      <ref id="B38">
        <mixed-citation publication-type="journal">
          <name>
            <surname>Maier</surname>
            <given-names>HR</given-names>
          </name>
          <name>
            <surname>Dandy</surname>
            <given-names>CG</given-names>
          </name>
          <article-title>Neural networks for the prediction and forecasting of water resources variables: a review of modelling issues and applications</article-title>
          <source>Environmental Modelling &amp; Software</source>
          <year>2000</year>
          <volume>15</volume>
          <fpage>101</fpage>
          <lpage>124</lpage>
          <pub-id pub-id-type="doi">10.1016/S1364-8152(99)00007-9</pub-id>
        </mixed-citation>
      </ref>
      <ref id="B39">
        <mixed-citation publication-type="book">
          <name>
            <surname>Demuth</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Beale</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hagan</surname>
            <given-names>M</given-names>
          </name>
          <source>Neural Network Toolbox&#x2122; 6 User's Guide</source>
          <year>2009</year>
          <publisher-name>The MathWorks, Inc</publisher-name>
        </mixed-citation>
      </ref>
      <ref id="B40">
        <mixed-citation publication-type="journal">
          <name>
            <surname>Fernandez</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Caballero</surname>
            <given-names>J</given-names>
          </name>
          <article-title>Ensembles of Bayesian-regularized genetic neural networks for modeling of acetylcholinesterase inhibition by huprines</article-title>
          <source>Chem Biol Drug Des</source>
          <year>2006</year>
          <volume>68</volume>
          <fpage>201</fpage>
          <lpage>212</lpage>
          <pub-id pub-id-type="doi">10.1111/j.1747-0285.2006.00435.x</pub-id>
          <pub-id pub-id-type="pmid">17105484</pub-id>
        </mixed-citation>
      </ref>
      <ref id="B41">
        <mixed-citation publication-type="journal">
          <name>
            <surname>Winkler</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Burden</surname>
            <given-names>FR</given-names>
          </name>
          <article-title>Modelling blood-brain barrier partitioning using Bayesian neural nets</article-title>
          <source>Journal of Molecular Graphics and Modelling</source>
          <year>2004</year>
          <volume>22</volume>
          <fpage>499</fpage>
          <lpage>505</lpage>
          <pub-id pub-id-type="doi">10.1016/j.jmgm.2004.03.010</pub-id>
          <pub-id pub-id-type="pmid">15182809</pub-id>
        </mixed-citation>
      </ref>
      <ref id="B42">
        <mixed-citation publication-type="journal">
          <name>
            <surname>Joseph</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>WL</given-names>
          </name>
          <name>
            <surname>Dickman</surname>
            <given-names>M</given-names>
          </name>
          <article-title>Neural network modelling of coastal algal blooms</article-title>
          <source>Ecol Model</source>
          <year>2003</year>
          <volume>159</volume>
          <fpage>179</fpage>
          <lpage>201</lpage>
          <pub-id pub-id-type="doi">10.1016/S0304-3800(02)00281-8</pub-id>
        </mixed-citation>
      </ref>
      <ref id="B43">
        <mixed-citation publication-type="journal">
          <name>
            <surname>Sorich</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Miners</surname>
            <given-names>JO</given-names>
          </name>
          <name>
            <surname>Ross</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Winker</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Burden</surname>
            <given-names>FR</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>PA</given-names>
          </name>
          <article-title>Comparison of linear and nonlinear classification algorithms for the prediction of drug and chemical metabolism by human UDP-Glucuronosyltransferase isoforms</article-title>
          <source>J Chem Inf Comput Sci</source>
          <year>2003</year>
          <volume>43</volume>
          <fpage>2019</fpage>
          <lpage>2024</lpage>
          <pub-id pub-id-type="doi">10.1021/ci034108k</pub-id>
          <pub-id pub-id-type="pmid">14632453</pub-id>
        </mixed-citation>
      </ref>
      <ref id="B44">
        <mixed-citation publication-type="journal">
          <name>
            <surname>Makowski</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Pajewski</surname>
            <given-names>NM</given-names>
          </name>
          <name>
            <surname>Klimentidis</surname>
            <given-names>YC</given-names>
          </name>
          <name>
            <surname>Vazquez</surname>
            <given-names>AI</given-names>
          </name>
          <name>
            <surname>Duarte</surname>
            <given-names>CW</given-names>
          </name>
          <name>
            <surname>Allison</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>de los Campos</surname>
            <given-names>G</given-names>
          </name>
          <article-title>Beyond missing heritability: prediction of complex traits</article-title>
          <source>PLOS Genetics</source>
          <year>2011</year>
          <volume>7</volume>
          <fpage>1</fpage>
          <lpage>9</lpage>
        </mixed-citation>
      </ref>
    </ref-list>
  </back>
</article>
